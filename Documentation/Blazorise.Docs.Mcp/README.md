# Blazorise Docs MCP Server

Provides MCP access to Blazorise documentation pages and examples. The server reads from a generated docs index and exposes targeted tools for docs lookup, search, and example retrieval.

## Data Source

- `docs-index.json` is generated by `Documentation/Blazorise.Docs.Compiler` from `Documentation/Blazorise.Docs`.
- `docs-api-index.json` is generated by `Documentation/Blazorise.Docs.Compiler` from Blazorise source components and extensions.
- Example titles and descriptions are extracted from `DocsPageSectionHeader` blocks and stored alongside each example.
- These files are generated; do not edit them manually.
- The server loads `docs-index.json` and `docs-api-index.json` from the app output folder or from `Documentation/Blazorise.Docs/Resources` when running in the repo.

## Transports and Endpoints

HTTP transport (default):
- `GET /mcp/sse` opens the SSE stream and returns a session handshake.
- `POST /mcp/message` accepts JSON-RPC messages; include `mcp-session-id` header.

Stdio transport (optional):
- Controlled by configuration key `Mcp:EnableStdio`.
- Set `Mcp__EnableStdio=false` for IIS deployments.

## MCP Tools

- `list_docs_pages(startsWith = "/docs")`
- `get_docs_page(route)`
- `get_example_code(code)`
- `get_component_api(typeName)`
- `get_docs_page_api(route)`
- `search_docs(query, maxResults = 20)`

`get_docs_page` returns `exampleDetails` with `code`, `title`, `description`, `kind`, and `sourcePath`.

## Client Configuration (HTTP)

Example MCP client entry:
```json
{
  "servers": {
    "blazorise-docs": {
      "type": "http",
      "url": "https://mcp.blazorise.com/mcp/sse"
    }
  }
}
```

## Running Locally

LaunchSettings default URLs:
- `https://localhost:12790`
- `http://localhost:12791`

Ensure `docs-index.json` and `docs-api-index.json` are present in the output folder or available under `Documentation/Blazorise.Docs/Resources`.

## Testing Script

Script: `Documentation/Blazorise.Docs.Mcp/Test-Mcp.ps1`

Fetch a single example:
```powershell
powershell -File .\Test-Mcp.ps1 -BaseUrl "http://localhost:12791" -ExampleCode "ButtonExample"
```

Fetch from the hosted server:
```powershell
powershell -File .\Test-Mcp.ps1 -BaseUrl "https://mcp.blazorise.com" -ExampleCode "ButtonExample"
```

List only button docs pages:
```powershell
powershell -File .\Test-Mcp.ps1 -BaseUrl "https://mcp.blazorise.com" -ListDocsPages -RoutePrefix "/docs/components/button"
```

The script reads SSE responses and also handles JSON-RPC responses returned in HTTP bodies for streamable HTTP servers.

## API Testing Script

Script: `Documentation/Blazorise.Docs.Mcp/Test-Mcp-Api.ps1`

Fetch API docs for a component:
```powershell
powershell -File .\Test-Mcp-Api.ps1 -BaseUrl "http://localhost:12791" -ComponentTypeName "Button"
```

Fetch API docs for a docs page route:
```powershell
powershell -File .\Test-Mcp-Api.ps1 -BaseUrl "https://mcp.blazorise.com" -DocsRoute "/docs/components/button"
```

## Hosting on IIS

- Publish as a folder deployment (single-file is not supported by IIS).
- Ensure `docs-index.json` is deployed alongside the app.
- Expose `/mcp/sse` and `/mcp/message` on the site.
- Disable stdio in production: set `Mcp__EnableStdio=false`.

## Token Usage Guidance

The MCP server does not push the full docs index to clients. Clients only see the tool responses they request. Use `list_docs_pages` with a narrow `startsWith` prefix and fetch specific examples with `get_example_code` to keep responses small.
