var roosterjs;(()=>{var e={8168:(e,t,n)=>{var r=n(8874),o={};for(var i in r)r.hasOwnProperty(i)&&(o[r[i]]=i);var a=e.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var l in a)if(a.hasOwnProperty(l)){if(!("channels"in a[l]))throw new Error("missing channels property: "+l);if(!("labels"in a[l]))throw new Error("missing channel labels property: "+l);if(a[l].labels.length!==a[l].channels)throw new Error("channel and label counts mismatch: "+l);var s=a[l].channels,u=a[l].labels;delete a[l].channels,delete a[l].labels,Object.defineProperty(a[l],"channels",{value:s}),Object.defineProperty(a[l],"labels",{value:u})}a.rgb.hsl=function(e){var t,n,r=e[0]/255,o=e[1]/255,i=e[2]/255,a=Math.min(r,o,i),l=Math.max(r,o,i),s=l-a;return l===a?t=0:r===l?t=(o-i)/s:o===l?t=2+(i-r)/s:i===l&&(t=4+(r-o)/s),(t=Math.min(60*t,360))<0&&(t+=360),n=(a+l)/2,[t,100*(l===a?0:n<=.5?s/(l+a):s/(2-l-a)),100*n]},a.rgb.hsv=function(e){var t,n,r,o,i,a=e[0]/255,l=e[1]/255,s=e[2]/255,u=Math.max(a,l,s),d=u-Math.min(a,l,s),c=function(e){return(u-e)/6/d+.5};return 0===d?o=i=0:(i=d/u,t=c(a),n=c(l),r=c(s),a===u?o=r-n:l===u?o=1/3+t-r:s===u&&(o=2/3+n-t),o<0?o+=1:o>1&&(o-=1)),[360*o,100*i,100*u]},a.rgb.hwb=function(e){var t=e[0],n=e[1],r=e[2];return[a.rgb.hsl(e)[0],1/255*Math.min(t,Math.min(n,r))*100,100*(r=1-1/255*Math.max(t,Math.max(n,r)))]},a.rgb.cmyk=function(e){var t,n=e[0]/255,r=e[1]/255,o=e[2]/255;return[100*((1-n-(t=Math.min(1-n,1-r,1-o)))/(1-t)||0),100*((1-r-t)/(1-t)||0),100*((1-o-t)/(1-t)||0),100*t]},a.rgb.keyword=function(e){var t=o[e];if(t)return t;var n,i,a,l=1/0;for(var s in r)if(r.hasOwnProperty(s)){var u=(i=e,a=r[s],Math.pow(i[0]-a[0],2)+Math.pow(i[1]-a[1],2)+Math.pow(i[2]-a[2],2));u<l&&(l=u,n=s)}return n},a.keyword.rgb=function(e){return r[e]},a.rgb.xyz=function(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255;return[100*(.4124*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3576*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.1805*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)),100*(.2126*t+.7152*n+.0722*r),100*(.0193*t+.1192*n+.9505*r)]},a.rgb.lab=function(e){var t=a.rgb.xyz(e),n=t[0],r=t[1],o=t[2];return r/=100,o/=108.883,n=(n/=95.047)>.008856?Math.pow(n,1/3):7.787*n+16/116,[116*(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116)-16,500*(n-r),200*(r-(o=o>.008856?Math.pow(o,1/3):7.787*o+16/116))]},a.hsl.rgb=function(e){var t,n,r,o,i,a=e[0]/360,l=e[1]/100,s=e[2]/100;if(0===l)return[i=255*s,i,i];t=2*s-(n=s<.5?s*(1+l):s+l-s*l),o=[0,0,0];for(var u=0;u<3;u++)(r=a+1/3*-(u-1))<0&&r++,r>1&&r--,i=6*r<1?t+6*(n-t)*r:2*r<1?n:3*r<2?t+(n-t)*(2/3-r)*6:t,o[u]=255*i;return o},a.hsl.hsv=function(e){var t=e[0],n=e[1]/100,r=e[2]/100,o=n,i=Math.max(r,.01);return n*=(r*=2)<=1?r:2-r,o*=i<=1?i:2-i,[t,100*(0===r?2*o/(i+o):2*n/(r+n)),(r+n)/2*100]},a.hsv.rgb=function(e){var t=e[0]/60,n=e[1]/100,r=e[2]/100,o=Math.floor(t)%6,i=t-Math.floor(t),a=255*r*(1-n),l=255*r*(1-n*i),s=255*r*(1-n*(1-i));switch(r*=255,o){case 0:return[r,s,a];case 1:return[l,r,a];case 2:return[a,r,s];case 3:return[a,l,r];case 4:return[s,a,r];case 5:return[r,a,l]}},a.hsv.hsl=function(e){var t,n,r,o=e[0],i=e[1]/100,a=e[2]/100,l=Math.max(a,.01);return r=(2-i)*a,n=i*l,[o,100*(n=(n/=(t=(2-i)*l)<=1?t:2-t)||0),100*(r/=2)]},a.hwb.rgb=function(e){var t,n,r,o,i,a,l,s=e[0]/360,u=e[1]/100,d=e[2]/100,c=u+d;switch(c>1&&(u/=c,d/=c),r=6*s-(t=Math.floor(6*s)),0!=(1&t)&&(r=1-r),o=u+r*((n=1-d)-u),t){default:case 6:case 0:i=n,a=o,l=u;break;case 1:i=o,a=n,l=u;break;case 2:i=u,a=n,l=o;break;case 3:i=u,a=o,l=n;break;case 4:i=o,a=u,l=n;break;case 5:i=n,a=u,l=o}return[255*i,255*a,255*l]},a.cmyk.rgb=function(e){var t=e[0]/100,n=e[1]/100,r=e[2]/100,o=e[3]/100;return[255*(1-Math.min(1,t*(1-o)+o)),255*(1-Math.min(1,n*(1-o)+o)),255*(1-Math.min(1,r*(1-o)+o))]},a.xyz.rgb=function(e){var t,n,r,o=e[0]/100,i=e[1]/100,a=e[2]/100;return n=-.9689*o+1.8758*i+.0415*a,r=.0557*o+-.204*i+1.057*a,t=(t=3.2406*o+-1.5372*i+-.4986*a)>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:12.92*r,[255*(t=Math.min(Math.max(0,t),1)),255*(n=Math.min(Math.max(0,n),1)),255*(r=Math.min(Math.max(0,r),1))]},a.xyz.lab=function(e){var t=e[0],n=e[1],r=e[2];return n/=100,r/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116)-16,500*(t-n),200*(n-(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116))]},a.lab.xyz=function(e){var t,n,r,o=e[0];t=e[1]/500+(n=(o+16)/116),r=n-e[2]/200;var i=Math.pow(n,3),a=Math.pow(t,3),l=Math.pow(r,3);return n=i>.008856?i:(n-16/116)/7.787,t=a>.008856?a:(t-16/116)/7.787,r=l>.008856?l:(r-16/116)/7.787,[t*=95.047,n*=100,r*=108.883]},a.lab.lch=function(e){var t,n=e[0],r=e[1],o=e[2];return(t=360*Math.atan2(o,r)/2/Math.PI)<0&&(t+=360),[n,Math.sqrt(r*r+o*o),t]},a.lch.lab=function(e){var t,n=e[0],r=e[1];return t=e[2]/360*2*Math.PI,[n,r*Math.cos(t),r*Math.sin(t)]},a.rgb.ansi16=function(e){var t=e[0],n=e[1],r=e[2],o=1 in arguments?arguments[1]:a.rgb.hsv(e)[2];if(0===(o=Math.round(o/50)))return 30;var i=30+(Math.round(r/255)<<2|Math.round(n/255)<<1|Math.round(t/255));return 2===o&&(i+=60),i},a.hsv.ansi16=function(e){return a.rgb.ansi16(a.hsv.rgb(e),e[2])},a.rgb.ansi256=function(e){var t=e[0],n=e[1],r=e[2];return t===n&&n===r?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(n/255*5)+Math.round(r/255*5)},a.ansi16.rgb=function(e){var t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),[t=t/10.5*255,t,t];var n=.5*(1+~~(e>50));return[(1&t)*n*255,(t>>1&1)*n*255,(t>>2&1)*n*255]},a.ansi256.rgb=function(e){if(e>=232){var t=10*(e-232)+8;return[t,t,t]}var n;return e-=16,[Math.floor(e/36)/5*255,Math.floor((n=e%36)/6)/5*255,n%6/5*255]},a.rgb.hex=function(e){var t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},a.hex.rgb=function(e){var t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];var n=t[0];3===t[0].length&&(n=n.split("").map((function(e){return e+e})).join(""));var r=parseInt(n,16);return[r>>16&255,r>>8&255,255&r]},a.rgb.hcg=function(e){var t,n=e[0]/255,r=e[1]/255,o=e[2]/255,i=Math.max(Math.max(n,r),o),a=Math.min(Math.min(n,r),o),l=i-a;return t=l<=0?0:i===n?(r-o)/l%6:i===r?2+(o-n)/l:4+(n-r)/l+4,t/=6,[360*(t%=1),100*l,100*(l<1?a/(1-l):0)]},a.hsl.hcg=function(e){var t,n=e[1]/100,r=e[2]/100,o=0;return(t=r<.5?2*n*r:2*n*(1-r))<1&&(o=(r-.5*t)/(1-t)),[e[0],100*t,100*o]},a.hsv.hcg=function(e){var t=e[1]/100,n=e[2]/100,r=t*n,o=0;return r<1&&(o=(n-r)/(1-r)),[e[0],100*r,100*o]},a.hcg.rgb=function(e){var t=e[0]/360,n=e[1]/100,r=e[2]/100;if(0===n)return[255*r,255*r,255*r];var o,i=[0,0,0],a=t%1*6,l=a%1,s=1-l;switch(Math.floor(a)){case 0:i[0]=1,i[1]=l,i[2]=0;break;case 1:i[0]=s,i[1]=1,i[2]=0;break;case 2:i[0]=0,i[1]=1,i[2]=l;break;case 3:i[0]=0,i[1]=s,i[2]=1;break;case 4:i[0]=l,i[1]=0,i[2]=1;break;default:i[0]=1,i[1]=0,i[2]=s}return o=(1-n)*r,[255*(n*i[0]+o),255*(n*i[1]+o),255*(n*i[2]+o)]},a.hcg.hsv=function(e){var t=e[1]/100,n=t+e[2]/100*(1-t),r=0;return n>0&&(r=t/n),[e[0],100*r,100*n]},a.hcg.hsl=function(e){var t=e[1]/100,n=e[2]/100*(1-t)+.5*t,r=0;return n>0&&n<.5?r=t/(2*n):n>=.5&&n<1&&(r=t/(2*(1-n))),[e[0],100*r,100*n]},a.hcg.hwb=function(e){var t=e[1]/100,n=t+e[2]/100*(1-t);return[e[0],100*(n-t),100*(1-n)]},a.hwb.hcg=function(e){var t=e[1]/100,n=1-e[2]/100,r=n-t,o=0;return r<1&&(o=(n-r)/(1-r)),[e[0],100*r,100*o]},a.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},a.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},a.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},a.gray.hsl=a.gray.hsv=function(e){return[0,0,e[0]]},a.gray.hwb=function(e){return[0,100,e[0]]},a.gray.cmyk=function(e){return[0,0,0,e[0]]},a.gray.lab=function(e){return[e[0],0,0]},a.gray.hex=function(e){var t=255&Math.round(e[0]/100*255),n=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(n.length)+n},a.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}},2085:(e,t,n)=>{var r=n(8168),o=n(4111),i={};Object.keys(r).forEach((function(e){i[e]={},Object.defineProperty(i[e],"channels",{value:r[e].channels}),Object.defineProperty(i[e],"labels",{value:r[e].labels});var t=o(e);Object.keys(t).forEach((function(n){var r=t[n];i[e][n]=function(e){var t=function(t){if(null==t)return t;arguments.length>1&&(t=Array.prototype.slice.call(arguments));var n=e(t);if("object"==typeof n)for(var r=n.length,o=0;o<r;o++)n[o]=Math.round(n[o]);return n};return"conversion"in e&&(t.conversion=e.conversion),t}(r),i[e][n].raw=function(e){var t=function(t){return null==t?t:(arguments.length>1&&(t=Array.prototype.slice.call(arguments)),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}(r)}))})),e.exports=i},4111:(e,t,n)=>{var r=n(8168);function o(e,t){return function(n){return t(e(n))}}function i(e,t){for(var n=[t[e].parent,e],i=r[t[e].parent][e],a=t[e].parent;t[a].parent;)n.unshift(t[a].parent),i=o(r[t[a].parent][a],i),a=t[a].parent;return i.conversion=n,i}e.exports=function(e){for(var t=function(e){var t=function(){for(var e={},t=Object.keys(r),n=t.length,o=0;o<n;o++)e[t[o]]={distance:-1,parent:null};return e}(),n=[e];for(t[e].distance=0;n.length;)for(var o=n.pop(),i=Object.keys(r[o]),a=i.length,l=0;l<a;l++){var s=i[l],u=t[s];-1===u.distance&&(u.distance=t[o].distance+1,u.parent=o,n.unshift(s))}return t}(e),n={},o=Object.keys(t),a=o.length,l=0;l<a;l++){var s=o[l];null!==t[s].parent&&(n[s]=i(s,t))}return n}},8874:e=>{"use strict";e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},9818:(e,t,n)=>{var r=n(8874),o=n(6851),i={};for(var a in r)r.hasOwnProperty(a)&&(i[r[a]]=a);var l=e.exports={to:{},get:{}};function s(e,t,n){return Math.min(Math.max(t,e),n)}function u(e){var t=e.toString(16).toUpperCase();return t.length<2?"0"+t:t}l.get=function(e){var t,n;switch(e.substring(0,3).toLowerCase()){case"hsl":t=l.get.hsl(e),n="hsl";break;case"hwb":t=l.get.hwb(e),n="hwb";break;default:t=l.get.rgb(e),n="rgb"}return t?{model:n,value:t}:null},l.get.rgb=function(e){if(!e)return null;var t,n,o,i=[0,0,0,1];if(t=e.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(o=t[2],t=t[1],n=0;n<3;n++){var a=2*n;i[n]=parseInt(t.slice(a,a+2),16)}o&&(i[3]=parseInt(o,16)/255)}else if(t=e.match(/^#([a-f0-9]{3,4})$/i)){for(o=(t=t[1])[3],n=0;n<3;n++)i[n]=parseInt(t[n]+t[n],16);o&&(i[3]=parseInt(o+o,16)/255)}else if(t=e.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)){for(n=0;n<3;n++)i[n]=parseInt(t[n+1],0);t[4]&&(i[3]=parseFloat(t[4]))}else{if(!(t=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)))return(t=e.match(/(\D+)/))?"transparent"===t[1]?[0,0,0,0]:(i=r[t[1]])?(i[3]=1,i):null:null;for(n=0;n<3;n++)i[n]=Math.round(2.55*parseFloat(t[n+1]));t[4]&&(i[3]=parseFloat(t[4]))}for(n=0;n<3;n++)i[n]=s(i[n],0,255);return i[3]=s(i[3],0,1),i},l.get.hsl=function(e){if(!e)return null;var t=e.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){var n=parseFloat(t[4]);return[(parseFloat(t[1])+360)%360,s(parseFloat(t[2]),0,100),s(parseFloat(t[3]),0,100),s(isNaN(n)?1:n,0,1)]}return null},l.get.hwb=function(e){if(!e)return null;var t=e.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){var n=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,s(parseFloat(t[2]),0,100),s(parseFloat(t[3]),0,100),s(isNaN(n)?1:n,0,1)]}return null},l.to.hex=function(){var e=o(arguments);return"#"+u(e[0])+u(e[1])+u(e[2])+(e[3]<1?u(Math.round(255*e[3])):"")},l.to.rgb=function(){var e=o(arguments);return e.length<4||1===e[3]?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},l.to.rgb.percent=function(){var e=o(arguments),t=Math.round(e[0]/255*100),n=Math.round(e[1]/255*100),r=Math.round(e[2]/255*100);return e.length<4||1===e[3]?"rgb("+t+"%, "+n+"%, "+r+"%)":"rgba("+t+"%, "+n+"%, "+r+"%, "+e[3]+")"},l.to.hsl=function(){var e=o(arguments);return e.length<4||1===e[3]?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},l.to.hwb=function(){var e=o(arguments),t="";return e.length>=4&&1!==e[3]&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"},l.to.keyword=function(e){return i[e.slice(0,3)]}},6767:(e,t,n)=>{"use strict";var r=n(9818),o=n(2085),i=[].slice,a=["keyword","gray","hex"],l={};Object.keys(o).forEach((function(e){l[i.call(o[e].labels).sort().join("")]=e}));var s={};function u(e,t){if(!(this instanceof u))return new u(e,t);if(t&&t in a&&(t=null),t&&!(t in o))throw new Error("Unknown model: "+t);var n,d;if(null==e)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof u)this.model=e.model,this.color=e.color.slice(),this.valpha=e.valpha;else if("string"==typeof e){var c=r.get(e);if(null===c)throw new Error("Unable to parse color from string: "+e);this.model=c.model,d=o[this.model].channels,this.color=c.value.slice(0,d),this.valpha="number"==typeof c.value[d]?c.value[d]:1}else if(e.length){this.model=t||"rgb",d=o[this.model].channels;var p=i.call(e,0,d);this.color=f(p,d),this.valpha="number"==typeof e[d]?e[d]:1}else if("number"==typeof e)e&=16777215,this.model="rgb",this.color=[e>>16&255,e>>8&255,255&e],this.valpha=1;else{this.valpha=1;var v=Object.keys(e);"alpha"in e&&(v.splice(v.indexOf("alpha"),1),this.valpha="number"==typeof e.alpha?e.alpha:0);var h=v.sort().join("");if(!(h in l))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=l[h];var g=o[this.model].labels,m=[];for(n=0;n<g.length;n++)m.push(e[g[n]]);this.color=f(m)}if(s[this.model])for(d=o[this.model].channels,n=0;n<d;n++){var y=s[this.model][n];y&&(this.color[n]=y(this.color[n]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function d(e,t,n){return(e=Array.isArray(e)?e:[e]).forEach((function(e){(s[e]||(s[e]=[]))[t]=n})),e=e[0],function(r){var o;return arguments.length?(n&&(r=n(r)),(o=this[e]()).color[t]=r,o):(o=this[e]().color[t],n&&(o=n(o)),o)}}function c(e){return function(t){return Math.max(0,Math.min(e,t))}}function f(e,t){for(var n=0;n<t;n++)"number"!=typeof e[n]&&(e[n]=0);return e}u.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(e){var t=this.model in r.to?this:this.rgb(),n=1===(t=t.round("number"==typeof e?e:1)).valpha?t.color:t.color.concat(this.valpha);return r.to[t.model](n)},percentString:function(e){var t=this.rgb().round("number"==typeof e?e:1),n=1===t.valpha?t.color:t.color.concat(this.valpha);return r.to.rgb.percent(n)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var e={},t=o[this.model].channels,n=o[this.model].labels,r=0;r<t;r++)e[n[r]]=this.color[r];return 1!==this.valpha&&(e.alpha=this.valpha),e},unitArray:function(){var e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,1!==this.valpha&&e.push(this.valpha),e},unitObject:function(){var e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,1!==this.valpha&&(e.alpha=this.valpha),e},round:function(e){return e=Math.max(e||0,0),new u(this.color.map(function(e){return function(t){return function(e,t){return Number(e.toFixed(t))}(t,e)}}(e)).concat(this.valpha),this.model)},alpha:function(e){return arguments.length?new u(this.color.concat(Math.max(0,Math.min(1,e))),this.model):this.valpha},red:d("rgb",0,c(255)),green:d("rgb",1,c(255)),blue:d("rgb",2,c(255)),hue:d(["hsl","hsv","hsl","hwb","hcg"],0,(function(e){return(e%360+360)%360})),saturationl:d("hsl",1,c(100)),lightness:d("hsl",2,c(100)),saturationv:d("hsv",1,c(100)),value:d("hsv",2,c(100)),chroma:d("hcg",1,c(100)),gray:d("hcg",2,c(100)),white:d("hwb",1,c(100)),wblack:d("hwb",2,c(100)),cyan:d("cmyk",0,c(100)),magenta:d("cmyk",1,c(100)),yellow:d("cmyk",2,c(100)),black:d("cmyk",3,c(100)),x:d("xyz",0,c(100)),y:d("xyz",1,c(100)),z:d("xyz",2,c(100)),l:d("lab",0,c(100)),a:d("lab",1),b:d("lab",2),keyword:function(e){return arguments.length?new u(e):o[this.model].keyword(this.color)},hex:function(e){return arguments.length?new u(e):r.to.hex(this.rgb().round().color)},rgbNumber:function(){var e=this.rgb().color;return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},luminosity:function(){for(var e=this.rgb().color,t=[],n=0;n<e.length;n++){var r=e[n]/255;t[n]=r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity(),n=e.luminosity();return t>n?(t+.05)/(n+.05):(n+.05)/(t+.05)},level:function(e){var t=this.contrast(e);return t>=7.1?"AAA":t>=4.5?"AA":""},isDark:function(){var e=this.rgb().color;return(299*e[0]+587*e[1]+114*e[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var e=this.rgb(),t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten:function(e){var t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken:function(e){var t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate:function(e){var t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate:function(e){var t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten:function(e){var t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken:function(e){var t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale:function(){var e=this.rgb().color,t=.3*e[0]+.59*e[1]+.11*e[2];return u.rgb(t,t,t)},fade:function(e){return this.alpha(this.valpha-this.valpha*e)},opaquer:function(e){return this.alpha(this.valpha+this.valpha*e)},rotate:function(e){var t=this.hsl(),n=t.color[0];return n=(n=(n+e)%360)<0?360+n:n,t.color[0]=n,t},mix:function(e,t){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);var n=e.rgb(),r=this.rgb(),o=void 0===t?.5:t,i=2*o-1,a=n.alpha()-r.alpha(),l=((i*a==-1?i:(i+a)/(1+i*a))+1)/2,s=1-l;return u.rgb(l*n.red()+s*r.red(),l*n.green()+s*r.green(),l*n.blue()+s*r.blue(),n.alpha()*o+r.alpha()*(1-o))}},Object.keys(o).forEach((function(e){if(-1===a.indexOf(e)){var t=o[e].channels;u.prototype[e]=function(){if(this.model===e)return new u(this);if(arguments.length)return new u(arguments,e);var n,r="number"==typeof arguments[t]?t:this.valpha;return new u((n=o[this.model][e].raw(this.color),Array.isArray(n)?n:[n]).concat(r),e)},u[e]=function(n){return"number"==typeof n&&(n=f(i.call(arguments),t)),new u(n,e)}}})),e.exports=u},5171:e=>{e.exports=function(e){return!(!e||"string"==typeof e)&&(e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&"String"!==e.constructor.name))}},6851:(e,t,n)=>{"use strict";var r=n(5171),o=Array.prototype.concat,i=Array.prototype.slice,a=e.exports=function(e){for(var t=[],n=0,a=e.length;n<a;n++){var l=e[n];r(l)?t=o.call(t,i.call(l)):t.push(l)}return t};a.wrap=function(e){return function(){return e(a(arguments))}}},1660:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDarkColor=void 0;var r=n(6134);Object.defineProperty(t,"getDarkColor",{enumerable:!0,get:function(){return r.default}})},6134:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6767);t.default=function(e,t){void 0===t&&(t=21.247);try{var n=r(e||void 0),o=n.lab().array(),i=(100-o[0])*((100-t)/100)+t;e=r.lab(i,o[1],o[2]).rgb().alpha(n.alpha()).toString()}catch(e){}return e}},8106:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9069),o=n(6344);t.default=function(e,t,n){function i(e,n){if(null===e)return e;switch(t){case"lowercase":return e.toLocaleLowerCase(n);case"uppercase":return e.toLocaleUpperCase(n);case"capitalize":for(var r=e.toLocaleLowerCase(n).split(" "),o=0;o<r.length;o++)r[o]=r[o].charAt(0).toLocaleUpperCase(n)+r[o].slice(1);return r.join(" ");case"sentence":var i=new RegExp("^\\s*\\w|[\\.\\!\\?]\\s+\\w","g");return e.toLocaleLowerCase(n).replace(i,(function(e){return e.toLocaleUpperCase(n)}));default:return e}}(0,r.default)(e,(function(e){for(var t=(0,o.getFirstLeafNode)(e);t;t=(0,o.getNextLeafSibling)(e,t))if(3==t.nodeType)try{t.textContent=i(t.textContent,n)}catch(e){t.textContent=i(t.textContent,void 0)}}),"changeCapitalization")}},5177:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewFontSize=t.FONT_SIZES=void 0;var r=n(9069),o=n(6344);t.FONT_SIZES=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72];function i(e,t,n){e=1==t?Math.floor(e):Math.ceil(e);var r=n[n.length-1];if(e<=n[0])e=Math.max(e+t,1);else if(e>r||e==r&&1==t)e/=10,e=1==t?Math.floor(e):Math.ceil(e),e=Math.min(Math.max(10*(e+t),r),1e3);else if(1==t){for(var o=0;o<n.length;o++)if(e<n[o]){e=n[o];break}}else for(o=n.length-1;o>=0;o--)if(e>n[o]){e=n[o];break}return e}t.default=function(e,n,a){void 0===a&&(a=t.FONT_SIZES);var l=0==n?1:-1;(0,r.default)(e,(function(e){var t=parseFloat((0,o.getComputedStyle)(e,"font-size")||e.style.fontSize);e.style.fontSize=i(t,l,a)+"pt";var n=(0,o.getComputedStyle)(e,"line-height");n&&"normal"!=n&&(e.style.lineHeight="normal")}),"changeFontSize")},t.getNewFontSize=i},4234:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4040);t.default=function(e){(0,r.default)(e,1)}},4040:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7582),o=n(4485),i=n(9703),a=n(9733),l=n(4077),s=n(6304),u=n(690),d=n(9339),c=n(8683),f=n(6823),p=n(926),v=n(3275),h=n(6344),g=["font","text-decoration","color","background"],m="B,I,U,STRONG,EM,SUB,SUP,STRIKE,FONT,CENTER,H1,H2,H3,H4,H5,H6,UL,OL,LI,SPAN,P,BLOCKQUOTE,CODE,S,PRE".split(","),y=["href","src","cellpadding","cellspacing"],b=["TD","TH","TR","TABLE","TBODY","THEAD"];function E(e){var t=(0,h.toArray)(e.childNodes).map(E).every((function(e){return e})),n=(0,h.isBlockElement)(e),o=(0,h.getTagOfNode)(e);return o&&(m.indexOf(o)>=0||t&&!(0,h.isVoidHtmlElement)(e)&&b.indexOf(o)<0?(n&&!t&&(0,h.wrap)(e),(0,h.unwrap)(e)):function(e){var t,n,o=(0,h.safeInstanceOf)(e,"HTMLTableCellElement"),i=(0,h.safeInstanceOf)(e,"HTMLTableElement");try{for(var a=(0,r.__values)((0,h.toArray)(e.attributes)),l=a.next();!l.done;l=a.next()){var s=l.value;o&&"style"==s.name?S(e):i&&"style"==s.name?T(e):y.indexOf(s.name.toLowerCase())<0&&0!=s.name.indexOf("data-")&&e.removeAttribute(s.name)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}(e)),n}function C(e,t){var n=(0,h.getStyles)(e),r={};return(0,h.getObjectKeys)(n).forEach((function(e){return t(e,n,r)})),(0,h.setStyles)(e,n),r}function S(e){return C(e,(function(e,t,n){e.indexOf("border")<0&&(n[e]=t[e],delete t[e])}))}function T(e){return C(e,(function(e,t,n){"border-collapse"!=e&&(n[e]=t[e],delete t[e])}))}function P(e){(0,l.default)(e,(function(){(0,i.default)(e,(function(t){var n=(0,h.getSelectedBlockElementsInRegion)(t),r=(0,h.collapseNodesInRegion)(t,n);if(e.contains(t.rootNode)){var o=S(t.rootNode);if((0,h.getObjectKeys)(o).length>0){var i=(0,h.wrap)((0,h.toArray)(t.rootNode.childNodes));(0,h.setStyles)(i,o)}}for(;r.length>0&&r[0].parentNode&&(0,h.isNodeInRegion)(t,r[0].parentNode);){var a=(0,h.splitBalancedNodeRange)(r);r=a?[a]:[]}r.forEach(E)})),_(e)}),"clearBlockFormat")}function _(e){var t=e.getDefaultFormat(),n=0===(0,h.getObjectKeys)(t).length;if(e.queryElements("[style]",2,(function(e){var t=(0,h.getTagOfNode)(e);-1==b.indexOf(t)?w(t,e,n):e.childNodes.forEach((function(e){e.childNodes.forEach((function(e){var t=(0,h.getTagOfNode)(e);(0,h.safeInstanceOf)(e,"HTMLElement")&&w(t,e,n)}))}))})),!n){if(t.fontFamily&&(0,u.default)(e,t.fontFamily),t.fontSize&&(0,d.default)(e,t.fontSize),t.textColor){var r=e.queryElements("a *, a",1),i=r.length>0?function(e){return-1==r.indexOf(e)}:void 0;t.textColors?(0,c.default)(e,t.textColors,i):(0,c.default)(e,t.textColor,i)}t.backgroundColor&&(t.backgroundColors?(0,s.default)(e,t.backgroundColors):(0,s.default)(e,t.backgroundColor)),t.bold?(0,f.default)(e):function(e,t){void 0===t&&(t="400"),(0,o.default)(e,"font-weight",(function(e){return e.style.fontWeight=t}),"setDefaultFontWeight")}(e),t.italic&&(0,p.default)(e),t.underline&&(0,v.default)(e)}}function w(e,t,n){-1==b.indexOf(e)&&(g.forEach((function(e){return t.style.removeProperty(e)})),n&&""===t.getAttribute("style")&&t.removeAttribute("style"))}function O(e,t){switch(void 0===t&&(t=0),t){case 0:!function(e){e.focus(),e.addUndoSnapshot((function(){return(0,a.default)(e,"removeFormat"),e.queryElements("[class]",1,(function(e){return e.removeAttribute("class")})),_(e),"clearInlineFormat"}),"Format")}(e);break;case 1:P(e);break;default:!function(e){var t=function(e){var t=e.getSelectionTraverser();return!!(null==t?void 0:t.currentBlockElement)&&!!(null==t?void 0:t.getNextBlockElement())}(e);if(!t){var n=e.getSelectionTraverser(),r=null==n?void 0:n.currentInlineElement,o=r instanceof h.PartialInlineElement||r instanceof h.NodeInlineElement&&!function(e,t){for(var n,r=e,o=function(){if(r.nextSibling||r.previousSibling){if((0,h.safeInstanceOf)(r,"HTMLLIElement"))return{value:!0};var e=!0;return null===(n=r.parentNode)||void 0===n||n.childNodes.forEach((function(t){var n;t!=r&&(null===(n=t.textContent)||void 0===n?void 0:n.length)&&(e=!1)})),{value:e}}r=r.parentNode};r&&t.contains(r.parentNode);){var i=o();if("object"==typeof i)return i.value}return!0}(r.getContainerNode(),e);if(o)return void O(e)}P(e)}(e)}}t.default=O},2149:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6344),o=/^[a-zA-Z]+:/i,i=/^[\w.%+-]+@/i,a=/^ftp\./i;function l(e){return e.queryElements("a[href]",1)[0]}function s(e,t){t&&e.textContent!=t&&(e.textContent=t)}t.default=function(e,t,n,u,d){e.focus();var c=(function(e){var t=new r.HtmlSanitizer,n=document.createElement("a");return n.href=e||"",t.sanitize(n),n.getAttribute("href")}(t)||"").trim();if(c){var f=(0,r.matchLink)(c),p=f?f.normalizedUrl:function(e){if(!e)return e;var t="";return e.search(o)<0&&(t=0==e.search(i)?"mailto:":0==e.search(a)?"ftp://":"http://"),t+e}(c),v=f?f.originalUrl:c;e.addUndoSnapshot((function(){var t=e.getSelectionRangeEx(),o=null;if(0===t.type){var i=t.ranges[0];if(i&&i.collapsed)(o=l(e))?(o.href=p,s(o,u)):((o=e.getDocument().createElement("A")).textContent=u||v,o.href=p,e.insertNode(o));else{e.getDocument().execCommand("createLink",!1,p);for(var a=e.getSelectionTraverser(),c=null==a?void 0:a.getNextInlineElement(),f=[];c;)f.push(c.getContainerNode()),c=null==a?void 0:a.getNextInlineElement();f.forEach((function(t){return e.deleteNode(t)})),s(o=l(e),u)}}else 2===t.type&&((o=(0,r.wrap)(t.image,"A")).href=p);return n&&o&&(o.title=n),o&&function(e,t){t?e.target=t:!t&&e.getAttribute("target")&&e.removeAttribute("target")}(o,d),o}),"CreateLink")}}},3956:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getElementBasedFormatState=void 0;var r=n(7582),o=n(6344);function i(e,t){var n=(0,o.getTagOfNode)(e.getElementAtCursor("OL,UL",void 0,t)),r=e.getSelectionRange(),i=!1;if(r&&!r.collapsed){var l=e.getBlockElementAtNode(r.startContainer),s=e.getBlockElementAtNode(r.endContainer);i=!(!s||!l||s.equals(l))}var u=(0,o.getTagOfNode)(e.getElementAtCursor("H1,H2,H3,H4,H5,H6",void 0,t)),d=e.queryElements("table",1)[0],c=d?(0,o.getTableFormatInfo)(d):void 0,f=(null==d?void 0:d.rows[0])?(0,o.toArray)(d.rows[0].cells).every((function(e){return"TH"==(0,o.getTagOfNode)(e)})):void 0,p=u&&parseInt(u[1])||0;return{isBullet:"UL"==n,isNumbering:"OL"==n,isMultilineSelection:i,headingLevel:p,headerLevel:p,canUnlink:!!e.queryElements("a[href]",1)[0],canAddImageAltText:!!e.queryElements("img",1)[0],isBlockQuote:!!e.queryElements("blockquote",1)[0],isCodeInline:!!e.queryElements("code",1)[0],isCodeBlock:!!e.queryElements("pre>code",1)[0],isInTable:!!d,tableFormat:c||{},tableHasHeader:f,canMergeTableCell:a(e)}}t.getElementBasedFormatState=i,t.default=function(e,t){return(0,r.__assign)((0,r.__assign)((0,r.__assign)((0,r.__assign)((0,r.__assign)({},e.getPendableFormatState(!1)),i(e,t)),e.getStyleBasedFormatState()),e.getUndoState()),{isDarkMode:e.isDarkMode(),zoomScale:e.getZoomScale()})};var a=function(e){var t=e.getSelectionRangeEx();if(t&&1===t.type&&t.coordinates){var n=t.coordinates,r=n.firstCell,o=n.lastCell;return r.x!==o.x||r.y!==o.y}return!1}},9540:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(19),o=n(6344);t.default=function(e,t,n,i,a,l,s,u){var d,c=(0,o.wrap)(n,i?"div":"span");if(!i&&a&&(c.style.display="inline-block"),(0,o.commitEntity)(c,t,a),!e.contains(c)){var f=null,p=void 0;if("number"==typeof l)p=l;else if(l){f=e.getSelectionRange();var v=l.normalize().node,h=v&&e.getElementAtCursor((0,o.getEntitySelector)(),v);h&&(l=new o.Position(h,-3)),e.select(l),p=3}else e.focus(),p=3;var g=s&&e.getSelectedRegions(),m=g&&o.VListChain.createListChains(g);e.insertNode(c,{updateCursor:!1,insertOnNewLine:i,replaceSelection:!0,position:p,insertToRegionRoot:s}),m&&(0,r.default)(e,m),3==p&&(f?e.select(f):i||e.select(c,-3))}var y=(0,o.getEntityFromElement)(c);if(i){var b=(0,o.createElement)(1,e.getDocument());if(null===(d=c.parentNode)||void 0===d||d.insertBefore(b,c.nextSibling),b&&(0,o.applyFormat)(b,e.getDefaultFormat(),e.isDarkMode(),e.getDarkColorHandler()),u){var E=null==b?void 0:b.querySelector("br"),C=E&&new o.Position(E,-2);C&&e.select(C)}}else a&&((0,o.addDelimiters)(y.wrapper),y.wrapper.nextElementSibling&&e.hasFocus()&&e.select(new o.Position(y.wrapper.nextElementSibling,-3)));return e.triggerContentChangedEvent("InsertEntity",y),y}},7239:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4077),o=n(6344);function i(e,t,n){(0,r.default)(e,(function(){var r=e.getDocument().createElement("img");r.src=t,n&&(0,o.getObjectKeys)(n).forEach((function(e){return r.setAttribute(e,n[e])})),e.insertNode(r)}),"insertImage")}t.default=function(e,t,n){"string"==typeof t?i(e,t,n):(0,o.readFile)(t,(function(t){t&&!e.isDisposed()&&i(e,t,n)}))}},2633:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4077),o=n(6344);t.default=function(e){e.focus(),(0,r.default)(e,(function(t,n){e.queryElements("a[href]",1,o.unwrap),t&&n&&e.select(t,n)}),"removeLink")}},7758:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,o){var i,a,l;if(!t||!n)return!1;if(l="string"==typeof t?null!==(a=null==(o=null!==(i=o||e.getContentSearcherOfCursor())&&void 0!==i?i:void 0)?void 0:o.getRangeFromText(t,r))&&void 0!==a?a:null:t){var s=e.getSelectionRange();return(null==s?void 0:s.collapsed)&&l.endContainer==s.startContainer&&l.endOffset==s.startOffset&&(r=!0),e.insertNode(n,{position:5,updateCursor:r,replaceSelection:!0,insertOnNewLine:!1,range:l}),!0}return!1}},6827:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4077);t.default=function(e,t,n){t&&(0,r.default)(e,(function(){t.style.transform="rotate("+n+"deg)"}),"rotateElement")}},2391:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9703),o=n(9733),i=n(4077),a=n(6577),l=n(6344);t.default=function(e,t){(0,i.default)(e,(function(){var n,i=e.getSelectionRangeEx(),s=i&&1===i.type,u=e.getElementAtCursor();s&&i.coordinates&&(0,l.isWholeTableSelected)(new l.VTable(i.table),i.coordinates)?function(e,t){var n=e.table;1==t?(n.style.marginLeft="auto",n.style.marginRight="auto"):2==t?(n.style.marginLeft="auto",n.style.marginRight=""):(n.style.marginLeft="",n.style.marginRight="auto")}(i,t):u&&(n=u,(0,l.findClosestElementAncestor)(n,void 0,"LI"))?function(e,t){(0,r.default)(e,(function(e,n,r){var o=(0,l.getSelectedBlockElementsInRegion)(e)[0].getStartNode(),i=(0,l.createVListFromRegion)(e,!0,o);n&&r&&(null==i||i.setAlignment(n,r,t))}),void 0,"alignList")}(e,t):function(e,t){var n="left",r="justifyLeft";1==t?(r="justifyCenter",n="center"):2==t&&(r="justifyRight",n="right"),(0,o.default)(e,r);var i=e.queryElements("[align]",1,(function(e){e.style.textAlign=n,(0,a.default)(e)}));if(0==i.length){var l=e.getElementAtCursor();l&&(0,a.default)(l)}}(e,t)}),"setAlignment")}},6304:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9069),o=n(6344);t.default=function(e,t){(0,r.default)(e,(function(n,r){(0,o.setColor)(n,r?"":t,!0,e.isDarkMode(),!1,e.getDarkColorHandler())}),"setBackgroundColor")}},9741:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5483),o=n(4077);t.default=function(e,t){e.focus(),(0,o.default)(e,(function(n,o){(0,r.default)(e,(function(e){e.setAttribute("dir",0==t?"ltr":"rtl"),e.style.textAlign=0==t?"left":"right"})),n&&o&&e.select(n,o)}),"setDirection")}},690:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4485);t.default=function(e,t){(0,r.default)(e,"font-family",(function(e,n){e.style.fontFamily=n?"":t}),"setFontName")}},9339:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4485),o=n(6344);t.default=function(e,t){(0,r.default)(e,"font-size",(function(e,n){e.style.fontSize=n?"":t;var r=(0,o.getComputedStyle)(e,"line-height");r&&"normal"!=r&&(e.style.lineHeight="normal")}),"setFontSize")}},8298:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toggleHeader=void 0;var r=n(4077),o=n(6344);function i(e,t){t=Math.min(Math.max(Math.round(t),0),6),(0,r.default)(e,(function(){e.focus();var n=!1;if(e.queryElements("H1,H2,H3,H4,H5,H6",1,(function(t){n||(e.getDocument().execCommand("formatBlock",!1,"<DIV>"),n=!0);var r=e.getDocument().createElement("div");(0,o.moveChildNodes)(r,t),e.replaceNode(t,r)})),t>0){for(var r=e.getSelectionTraverser(),i=null==r?void 0:r.currentBlockElement,a=new o.HtmlSanitizer({cssStyleCallbacks:{"font-size":function(){return!1}}});i;){var l=i.collapseToSingleElement();a.sanitize(l),i=null==r?void 0:r.getNextBlockElement()}e.getDocument().execCommand("formatBlock",!1,"<H"+t+">")}}),"toggleHeader")}t.default=i,t.toggleHeader=i},620:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4077);t.default=function(e,t){e.focus(),(0,r.default)(e,(function(){e.queryElements("img",1,(function(e){return e.setAttribute("alt",t)}))}),"setImageAltText")}},1696:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9703),o=n(6577),i=n(6344);function a(e,t){t.forEach((function(t){var n=t.collapseToSingleElement(),r=(0,i.findClosestElementAncestor)(n,e.rootNode,"blockquote");if(r){for(n==r&&(n=(0,i.wrap)((0,i.toArray)(n.childNodes)));n&&(0,i.isNodeInRegion)(e,n)&&"BLOCKQUOTE"!=(0,i.getTagOfNode)(n);)n=(0,i.splitBalancedNodeRange)(n);n&&(0,i.isNodeInRegion)(e,n)&&(0,i.unwrap)(n)}}))}function l(e,t){var n;return(null===(n=e.items[0])||void 0===n?void 0:n.getNode())==t&&e.getListItemIndex(t)==(e.getStart()||1)}function s(e,t,n){return 0==e||t.getElementAtCursor("blockquote",n)}t.default=function(e,t){var n=0==t?function(e,t){var n=(0,i.collapseNodesInRegion)(e,t);(0,i.wrap)(n,2);var r=[];n.forEach((function(e){return(0,o.default)(e,r)}))}:a;(0,r.default)(e,(function(r,o,a){for(var u=(0,i.getSelectedBlockElementsInRegion)(r,!0),d=[[]],c=0;c<u.length;c++){var f=u[c].getStartNode(),p=(0,i.createVListFromRegion)(r,!0,f);if(p){for(;u[c+1]&&p.contains(u[c+1].getStartNode());)c++;var v=e.isFeatureEnabled("TabKeyTextFeatures");if(v&&l(p,f)&&s(t,e,f)){var h=e.getBlockElementAtNode(p.rootList);h&&d.push([h])}else o&&a&&(1==t?p.setIndentation(o,a,t,!1,v):p.setIndentation(o,a,t),p.writeBack(e.isFeatureEnabled("ReuseAllAncestorListElements"),e.isFeatureEnabled("DisableListChain")),d.push([]))}else d[d.length-1].push(u[c])}d.forEach((function(e){return n(r,e)}))}),(function(){var n=e.getSelectionRangeEx();if(1==n.type&&n.coordinates&&(0,i.isWholeTableSelected)(new i.VTable(n.table),n.coordinates)){if(1==t){var r=e.getElementAtCursor("blockquote",n.table);r&&(0,i.unwrap)(r)}else 0==t&&(0,i.wrap)(n.table,2);return!1}return!0}),"setIndentation")}},8073:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4077),o=n(6344);t.default=function(e,t,n){void 0===n&&(n=1),(0,r.default)(e,(function(){e.focus();var r=e.getSelectedRegions();if(r[0]){var i=(0,o.createVListFromRegion)(r[0],!1,t);i&&(i.split(t,n),i.writeBack(e.isFeatureEnabled("ReuseAllAncestorListElements"),e.isFeatureEnabled("DisableListChain")))}}),"setOrderedListNumbering")}},8683:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4485),o=n(6344);t.default=function(e,t,n){(0,r.default)(e,"color",(function(r,i){n&&!n(r)||(0,o.setColor)(r,i?"":t,!1,e.isDarkMode(),!1,e.getDarkColorHandler())}),"setTextColor")}},5936:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(949),o=n(6344),i=function(e){e.style.borderLeft="3px solid",e.style.borderColor="#C8C8C8",e.style.paddingLeft="10px",e.style.color="#666666"};t.default=function(e,t){(0,r.default)(e,(function(e){var n=(0,o.wrap)(e,"blockquote");(t||i)(n)}),(function(){return 0==e.queryElements("blockquote",1,o.unwrap).length}),"toggleBlockQuote")}},6823:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9733);t.default=function(e){(0,r.default)(e,"bold","toggleBold")}},2473:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5367);t.default=function(e,t,n){(0,r.default)(e,2,void 0,!1,void 0,t,n)}},8761:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(949),o=n(6344),i="code",a="pre>"+i;t.default=function(e,t){(0,r.default)(e,(function(e){var n=(0,o.wrap)(e,i),r=(0,o.wrap)(n,"pre");null==t||t(r)}),(function(){return 0==e.queryElements(a,1,(function(e){if(!e.previousSibling&&!e.nextSibling){var t=e.parentNode;(0,o.unwrap)(e),t&&(0,o.unwrap)(t)}})).length}),"toggleCodeBlock")}},926:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9733);t.default=function(e){(0,r.default)(e,"italic","toggleItalic")}},5485:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5367);t.default=function(e,t,n,o){(0,r.default)(e,1,t,void 0,n,void 0,o)}},2809:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9733);t.default=function(e){(0,r.default)(e,"strikeThrough","toggleStrikethrough")}},9752:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9733);t.default=function(e){(0,r.default)(e,"subscript","toggleSubscript")}},9282:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9733);t.default=function(e){(0,r.default)(e,"superscript","toggleSuperscript")}},3275:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9733);t.default=function(e){(0,r.default)(e,"underline","toggleUnderline")}},4548:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.experimentCommitListChains=t.commitListChains=t.blockFormat=t.toggleListType=t.applyCellShading=t.toggleHeader=t.setHeadingLevel=t.toggleUnderline=t.toggleSuperscript=t.toggleSubscript=t.toggleStrikethrough=t.toggleCodeBlock=t.toggleBlockQuote=t.setOrderedListNumbering=t.toggleNumbering=t.toggleItalic=t.toggleBullet=t.toggleBold=t.changeCapitalization=t.setIndentation=t.setImageAltText=t.setFontSize=t.setFontName=t.setDirection=t.setTextColor=t.setBackgroundColor=t.setAlignment=t.rotateElement=t.replaceWithNode=t.removeLink=t.formatTable=t.editTable=t.insertTable=t.insertImage=t.insertEntity=t.getElementBasedFormatState=t.getFormatState=t.createLink=t.clearFormat=t.clearBlockFormat=t.FONT_SIZES=t.changeFontSize=void 0;var r=n(5177);Object.defineProperty(t,"changeFontSize",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"FONT_SIZES",{enumerable:!0,get:function(){return r.FONT_SIZES}});var o=n(4234);Object.defineProperty(t,"clearBlockFormat",{enumerable:!0,get:function(){return o.default}});var i=n(4040);Object.defineProperty(t,"clearFormat",{enumerable:!0,get:function(){return i.default}});var a=n(2149);Object.defineProperty(t,"createLink",{enumerable:!0,get:function(){return a.default}});var l=n(3956);Object.defineProperty(t,"getFormatState",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"getElementBasedFormatState",{enumerable:!0,get:function(){return l.getElementBasedFormatState}});var s=n(9540);Object.defineProperty(t,"insertEntity",{enumerable:!0,get:function(){return s.default}});var u=n(7239);Object.defineProperty(t,"insertImage",{enumerable:!0,get:function(){return u.default}});var d=n(6725);Object.defineProperty(t,"insertTable",{enumerable:!0,get:function(){return d.default}});var c=n(5443);Object.defineProperty(t,"editTable",{enumerable:!0,get:function(){return c.default}});var f=n(3242);Object.defineProperty(t,"formatTable",{enumerable:!0,get:function(){return f.default}});var p=n(2633);Object.defineProperty(t,"removeLink",{enumerable:!0,get:function(){return p.default}});var v=n(7758);Object.defineProperty(t,"replaceWithNode",{enumerable:!0,get:function(){return v.default}});var h=n(6827);Object.defineProperty(t,"rotateElement",{enumerable:!0,get:function(){return h.default}});var g=n(2391);Object.defineProperty(t,"setAlignment",{enumerable:!0,get:function(){return g.default}});var m=n(6304);Object.defineProperty(t,"setBackgroundColor",{enumerable:!0,get:function(){return m.default}});var y=n(8683);Object.defineProperty(t,"setTextColor",{enumerable:!0,get:function(){return y.default}});var b=n(9741);Object.defineProperty(t,"setDirection",{enumerable:!0,get:function(){return b.default}});var E=n(690);Object.defineProperty(t,"setFontName",{enumerable:!0,get:function(){return E.default}});var C=n(9339);Object.defineProperty(t,"setFontSize",{enumerable:!0,get:function(){return C.default}});var S=n(620);Object.defineProperty(t,"setImageAltText",{enumerable:!0,get:function(){return S.default}});var T=n(1696);Object.defineProperty(t,"setIndentation",{enumerable:!0,get:function(){return T.default}});var P=n(8106);Object.defineProperty(t,"changeCapitalization",{enumerable:!0,get:function(){return P.default}});var _=n(6823);Object.defineProperty(t,"toggleBold",{enumerable:!0,get:function(){return _.default}});var w=n(2473);Object.defineProperty(t,"toggleBullet",{enumerable:!0,get:function(){return w.default}});var O=n(926);Object.defineProperty(t,"toggleItalic",{enumerable:!0,get:function(){return O.default}});var M=n(5485);Object.defineProperty(t,"toggleNumbering",{enumerable:!0,get:function(){return M.default}});var D=n(8073);Object.defineProperty(t,"setOrderedListNumbering",{enumerable:!0,get:function(){return D.default}});var A=n(5936);Object.defineProperty(t,"toggleBlockQuote",{enumerable:!0,get:function(){return A.default}});var L=n(8761);Object.defineProperty(t,"toggleCodeBlock",{enumerable:!0,get:function(){return L.default}});var R=n(2809);Object.defineProperty(t,"toggleStrikethrough",{enumerable:!0,get:function(){return R.default}});var I=n(9752);Object.defineProperty(t,"toggleSubscript",{enumerable:!0,get:function(){return I.default}});var N=n(9282);Object.defineProperty(t,"toggleSuperscript",{enumerable:!0,get:function(){return N.default}});var x=n(3275);Object.defineProperty(t,"toggleUnderline",{enumerable:!0,get:function(){return x.default}});var k=n(8298);Object.defineProperty(t,"setHeadingLevel",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(t,"toggleHeader",{enumerable:!0,get:function(){return k.toggleHeader}});var j=n(7622);Object.defineProperty(t,"applyCellShading",{enumerable:!0,get:function(){return j.default}});var B=n(5367);Object.defineProperty(t,"toggleListType",{enumerable:!0,get:function(){return B.default}});var F=n(9703);Object.defineProperty(t,"blockFormat",{enumerable:!0,get:function(){return F.default}});var H=n(19);Object.defineProperty(t,"commitListChains",{enumerable:!0,get:function(){return H.default}}),Object.defineProperty(t,"experimentCommitListChains",{enumerable:!0,get:function(){return H.experimentCommitListChains}})},7622:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7582),o=n(4077),i=n(6344);t.default=function(e,t){e.focus(),(0,o.default)(e,(function(){e.getSelectedRegions().forEach((function(n){if((0,i.safeInstanceOf)(n.rootNode,"HTMLTableCellElement")){(0,i.setColor)(n.rootNode,t,!0,e.isDarkMode(),!0,e.getDarkColorHandler());var o=(0,i.getTableCellMetadata)(n.rootNode);(0,i.saveTableCellMetadata)(n.rootNode,(0,r.__assign)((0,r.__assign)({},o),{bgColorOverride:!0}))}}))}),"applyCellShading")}},5443:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4077),o=n(6344);function i(e){return null==e}t.default=function(e,t){var n=e.getElementAtCursor("TD,TH");n&&(0,r.default)(e,(function(){var r=new o.VTable(n);if(function(e,t){var n,r=e.getSelectionRangeEx();r&&1===r.type&&(t.selection=null!==(n=r.coordinates)&&void 0!==n?n:null)}(e,r),r.edit(t),r.writeBack(!1,e.getDarkColorHandler()),e.transformToDarkColor(r.table),e.focus(),!i(r.row)&&!i(r.col)){var a=function(e,t,n){var r=t,o=n;switch(e){case 0:o=0;break;case 1:r+=1,o=0;break;case 2:r=0;break;case 3:r=0,o+=1}return{newRow:r,newCol:o}}(t,r.row,r.col),l=a.newCol,s=a.newRow,u=r.getCell(s,l).td;u&&e.select(u,0)}}),"editTable")}},3242:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4077),o=n(6344);t.default=function(e,t,n){(n=n||e.getElementAtCursor("TABLE"))&&(0,r.default)(e,(function(r,i){if(n){var a=new o.VTable(n);a.applyFormat(t),a.writeBack(!1,e.getDarkColorHandler()),e.transformToDarkColor(a.table),e.focus(),r&&i&&e.select(r,i)}}),"formatTable")}},6725:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4077),o=n(6304),i=n(6344);function a(e){return e<=4?"120px":e<=6?"100px":"70px"}t.default=function(e,t,n,l){var s=e.getDocument(),u=s.createElement("table");u.cellSpacing="0",u.cellPadding="1";for(var d=0;d<n;d++){var c=s.createElement("tr");u.appendChild(c);for(var f=0;f<t;f++){var p=s.createElement("td");c.appendChild(p),p.appendChild(s.createElement("br")),p.style.width=a(t)}}e.focus(),(0,r.default)(e,(function(){var t=e.getElementAtCursor();(null==t?void 0:t.style.backgroundColor)&&(0,o.default)(e,"transparent");var n=new i.VTable(u);l=l||{verticalAlign:"top"},n.applyFormat(l||{}),n.writeBack(),e.insertNode(u),e.runAsync((function(e){return e.select(new i.Position(u,0).normalize())}))}),"insertTable")}},9069:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4077),o=n(6344);t.default=function(e,t,n){e.focus();var i=e.getSelectionRangeEx(),a=function(e,n){return e.isContentEditable&&t(e,n)};if(i&&i.areAllCollapsed){var l=i.ranges[0].startContainer;"SPAN"!=(0,o.getTagOfNode)(l)||l.firstChild&&("BR"!=(0,o.getTagOfNode)(l.firstChild)||l.firstChild.nextSibling)?(e.triggerPluginEvent(13,{formatState:{},formatCallback:t}),e.triggerContentChangedEvent("Format")):(e.addUndoSnapshot(),a(l))}else(0,r.default)(e,(function(){var t,n;i.ranges.forEach((function(r){var o=e.getSelectionTraverser(r);if(o)for(var i=o&&o.currentInlineElement;i;){var l=o.getNextInlineElement();i.applyStyle((function(e,r){a(e,r),t=t||e,n=e})),i=l}})),t&&n&&0==i.type&&e.select(t,-2,n,-3)}),n)}},4485:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9069),o=n(6344);t.default=function(e,t,n,i){var a=[];(0,r.default)(e,(function(t,r){n(t,r);var o=e.getElementAtCursor("LI",t);o&&-1===a.indexOf(o)&&a.push(o)}),i),function(e,t){e.forEach((function(e){(0,o.safeInstanceOf)(e,"HTMLLIElement")&&(0,o.setListItemStyle)(e,t)}))}(a,[t])}},9703:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(19),o=n(4077),i=n(6344);t.default=function(e,t,n,a){e.focus();var l=e.getSelectionRangeEx();(0,o.default)(e,(function(o,a){if(!n||n()){var s=e.getSelectedRegions();if(s.length>0){var u=i.VListChain.createListChains(s,null==o?void 0:o.node);s.forEach((function(e){return t(e,o,a,u)})),(0,r.default)(e,u)}}0==l.type&&o&&a?e.select(o,a):e.select(l)}),a)}},949:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9703),o=n(6344);t.default=function(e,t,n,i){(0,r.default)(e,(function(e){var n=(0,o.getSelectedBlockElementsInRegion)(e,!0),r=(0,o.collapseNodesInRegion)(e,n);if(r.length>0){if(1==r.length){var i=(0,o.getTagOfNode)(r[0]);"BR"==i?r=[(0,o.wrap)(r[0])]:"LI"!=i&&"TD"!=i||(r=(0,o.toArray)(r[0].childNodes))}for(;r[0]&&r[0].parentNode&&(0,o.isNodeInRegion)(e,r[0].parentNode)&&r.some((function(e){return"LI"==(0,o.getTagOfNode)(e)}));){var a=(0,o.splitBalancedNodeRange)(r);r=a?[a]:[]}t(r)}}),n,i)}},5483:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6344);function o(e){var t=e.getStartNode();return t==e.getEndNode()&&3==t.nodeType&&["TR","TABLE"].indexOf((0,r.getTagOfNode)(t.parentNode))>=0}t.default=function(e,t){var n=e.getSelectionTraverser();if(n){for(var r=n.currentBlockElement,i=[];r;)o(r)||i.push(r),r=n.getNextBlockElement();i.forEach((function(e){var n=e.collapseToSingleElement();t(n)}))}}},19:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.experimentCommitListChains=void 0;var r=n(6344);function o(e,t){if((null==t?void 0:t.length)>0){var n=e.getSelectionRange(),o=n&&r.Position.getStart(n),i=n&&r.Position.getEnd(n),a=e.isFeatureEnabled("ReuseAllAncestorListElements"),l=e.isFeatureEnabled("DisableListChain");t.forEach((function(e){return e.commit(a,l)})),o&&i&&e.select(o,i)}}t.default=o,t.experimentCommitListChains=o},9733:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4077),o=n(6344);t.default=function(e,t,n){e.focus();var i=function(){return e.getDocument().execCommand(t,!1,void 0)},a=e.getSelectionRangeEx();if(a&&a.areAllCollapsed){e.addUndoSnapshot();var l=e.getPendableFormatState(!1);i();var s=(0,o.getObjectKeys)(o.PendableFormatCommandMap).filter((function(e){return o.PendableFormatCommandMap[e]==t}))[0];s&&(l[s]=!l[s],e.triggerPluginEvent(13,{formatState:l}))}else(0,r.default)(e,(function(){var t=0!=a.type;a.ranges.forEach((function(n){t&&e.select(n),i()})),t&&e.select(a)}),n)}},4077:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){e.addUndoSnapshot(t,"Format",void 0,n&&""!=n?{formatApiName:n}:void 0)}},6577:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6344);t.default=function(e,t){if((0,r.safeInstanceOf)(e,"HTMLElement")){var n=e.style.textAlign,o=(0,r.findClosestElementAncestor)(e,void 0,"blockquote");if(!o)return;var i=(a=e,"rtl"==(0,r.getComputedStyle)(a,"direction")||"rtl"==a.getAttribute("dir"));if(t){if(t.indexOf(o)>-1)return;t.push(o)}for(;o;)"center"==n?i?(o.style.removeProperty("marginInlineEnd"),o.style.marginInlineStart="auto"):(o.style.removeProperty("marginInlineStart"),o.style.marginInlineEnd="auto"):(o.style.removeProperty("marginInlineEnd"),o.style.removeProperty("marginInlineStart")),o=(0,r.findClosestElementAncestor)(o.parentElement,void 0,"blockquote")}var a}},5367:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9703),o=n(6344);t.default=function(e,t,n,i,a,l,s){void 0===n&&(n=0),void 0===i&&(i=!0),(0,r.default)(e,(function(r,s,u,d){var c,f,p=n>0&&d.filter((function(e){return e.canAppendAtCursor(n)}))[0],v=null===(f=(0,o.getBlockElementAtNode)(r.rootNode,null!==(c=null==s?void 0:s.node)&&void 0!==c?c:null))||void 0===f?void 0:f.collapseToSingleElement();if(v){var h=p&&u&&(null==s?void 0:s.equalTo(u))?p.createVListAtBlock(v,n):(0,o.createVListFromRegion)(r,1!==n&&i);h&&s&&u&&(h.changeListType(s,u,t),h.setListStyleType(a,l),function(e){var t=null==e?void 0:e.rootList;return!!t&&0===t.childElementCount}(h)&&h.removeMargins(),h.writeBack(e.isFeatureEnabled("ReuseAllAncestorListElements"),e.isFeatureEnabled("DisableListChain")))}}),void 0,s||"toggleListType")}},9484:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addUndoSnapshot=void 0;var r=n(7582),o=n(6344);function i(e,t,n){var i;if(!e.lifecycle.shadowEditFragment){var a=e.api.getSelectionRangeEx(e),l=e.lifecycle.isDarkMode,s=function(e,t,n){switch(null==t?void 0:t.type){case 1:return(0,r.__assign)({type:1,tableId:t.table.id,isDarkMode:!!n},t.coordinates);case 2:return{type:2,imageId:t.image.id,isDarkMode:!!n};case 0:return(0,r.__assign)({type:0,isDarkMode:!!n,start:[],end:[]},(0,o.getSelectionPath)(e,t.ranges[0])||{})}}(e.contentDiv,a,l)||null;e.undo.snapshotsService.addSnapshot({html:e.contentDiv.innerHTML,metadata:s,knownColors:(null===(i=e.darkColorHandler)||void 0===i?void 0:i.getKnownColorsCopy())||[],entityStates:n},t),e.undo.hasNewContent=!1}}t.addUndoSnapshot=function(e,t,n,r,a){var l,s,u,d=e.undo,c=d.isNested;c||(d.isNested=!0,!e.undo.hasNewContent&&(null==a?void 0:a.getEntityState)&&t||i(e,r,null===(l=null==a?void 0:a.getEntityState)||void 0===l?void 0:l.call(a)));try{var f;t&&(u=t((f=e.api.getSelectionRange(e,!0))&&o.Position.getStart(f).normalize(),f&&o.Position.getEnd(f).normalize()),c||i(e,!1,null===(s=null==a?void 0:a.getEntityState)||void 0===s?void 0:s.call(a)))}finally{c||(d.isNested=!1)}if(t&&n){var p={eventType:7,source:n,data:u,additionalData:a};e.api.triggerEvent(e,p,!0)}r&&(f=e.api.getSelectionRange(e,!1))&&(e.undo.hasNewContent=!1,e.undo.autoCompletePosition=o.Position.getStart(f))}},9457:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attachDomEvent=void 0;var r=n(6344);t.attachDomEvent=function(e,t){var n=(0,r.getObjectKeys)(t||{}).map((function(n){var r,o,i=(r=t[n],o={pluginEventType:null,beforeDispatch:null},"number"==typeof r?o.pluginEventType=r:"function"==typeof r?o.beforeDispatch=r:"object"==typeof r&&(o=r),o),a=i.pluginEventType,l=i.beforeDispatch,s=n,u=function(t){l&&l(t),null!=a&&e.api.triggerEvent(e,{eventType:a,rawEvent:t},!1)};return e.contentDiv.addEventListener(s,u),function(){e.contentDiv.removeEventListener(s,u)}}));return function(){return n.forEach((function(e){return e()}))}}},6447:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.coreApiMap=void 0;var r=n(9484),o=n(9457),i=n(3942),a=n(9943),l=n(3221),s=n(5049),u=n(5719),d=n(1467),c=n(2634),f=n(2628),p=n(5149),v=n(1844),h=n(6651),g=n(674),m=n(4830),y=n(7243),b=n(1036),E=n(1282),C=n(6233),S=n(5764),T=n(857);t.coreApiMap={attachDomEvent:o.attachDomEvent,addUndoSnapshot:r.addUndoSnapshot,createPasteFragment:i.createPasteFragment,ensureTypeInContainer:a.ensureTypeInContainer,focus:l.focus,getContent:s.getContent,getSelectionRange:d.getSelectionRange,getSelectionRangeEx:c.getSelectionRangeEx,getStyleBasedFormatState:f.getStyleBasedFormatState,getPendableFormatState:u.getPendableFormatState,hasFocus:p.hasFocus,insertNode:v.insertNode,restoreUndoSnapshot:h.restoreUndoSnapshot,select:g.select,selectRange:y.selectRange,setContent:E.setContent,switchShadowEdit:C.switchShadowEdit,transformColor:S.transformColor,triggerEvent:T.triggerEvent,selectTable:b.selectTable,selectImage:m.selectImage}},3942:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPasteFragment=void 0;var r=n(6344);t.createPasteFragment=function(e,t,n,o,i,a){if(void 0===a&&(a=!1),!t)return null;var l=function(e,t,n){var o=(0,r.createDefaultHtmlSanitizerOptions)();return o.cssStyleCallbacks["caret-color"]=function(){return!1},{eventType:10,clipboardData:t,fragment:e.contentDiv.ownerDocument.createDocumentFragment(),sanitizingOption:o,htmlBefore:"",htmlAfter:"",htmlAttributes:{},pasteType:n}}(e,t,(0,r.getPasteType)(o,i,a));return function(e,t,n,o,i,a,l){var s=l.fragment,u=t.rawHtml,d=t.text,c=t.imageDataUri,f=u?(new DOMParser).parseFromString(e.trustedHTMLHandler(u),"text/html"):void 0;if((0,r.retrieveMetadataFromClipboard)(f,l,e.trustedHTMLHandler),a&&c||!o&&!d&&c)(0,r.handleImagePaste)(c,s);else if(!o&&u&&f&&f.body){if((0,r.moveChildNodes)(s,null==f?void 0:f.body),i&&n){var p=function(e,t){var n=e.api.getPendableFormatState(e,!0),r=e.api.getStyleBasedFormatState(e,t);return{fontFamily:r.fontName,fontSize:r.fontSize,textColor:r.textColor,backgroundColor:r.backgroundColor,textColors:r.textColors,backgroundColors:r.backgroundColors,bold:n.isBold,italic:n.isItalic,underline:n.isUnderline}}(e,n.node);(0,r.applyTextStyle)(s,(function(e){return(0,r.applyFormat)(e,p)}))}}else d&&(0,r.handleTextPaste)(d,n,s);return 1!==l.pasteType&&e.api.triggerEvent(e,l,!0),(0,r.sanitizePasteContent)(l,n),s}(e,t,n,o,i,a,l)}},9943:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensureTypeInContainer=void 0;var r=n(6344);t.ensureTypeInContainer=function(e,t,n){var o,i=(0,r.findClosestElementAncestor)(t.node,e.contentDiv,"table");i&&(o=i.querySelector("td,th"))&&(t=new r.Position(o,0)),t=t.normalize();var a,l=(0,r.getBlockElementAtNode)(e.contentDiv,t.node);if(l){if(a=l.collapseToSingleElement(),(0,r.isNodeEmpty)(a,!1,!0)){var s=a.ownerDocument.createElement("br");a.append(s)}var u=(0,r.isNodeEmpty)(a)||n&&function(e,t){return(0,r.safeInstanceOf)(e.target,"Node")&&e.target.contains(t)&&e.key===t.innerText}(n,a);a=a&&u?a:null}else a=(0,r.createElement)(1,e.contentDiv.ownerDocument),e.api.insertNode(e,a,{position:1,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),t=new r.Position(a,0);a&&e.lifecycle.defaultFormat&&(0,r.applyFormat)(a,e.lifecycle.defaultFormat,e.lifecycle.isDarkMode,e.darkColorHandler),n&&e.api.selectRange(e,(0,r.createRange)(new r.Position(t)))}},3221:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.focus=void 0;var r=n(6344);t.focus=function(e){if(!e.lifecycle.shadowEditFragment){if(!(e.api.hasFocus(e)&&e.api.getSelectionRange(e,!1)||e.domEvent.selectionRange&&e.api.selectRange(e,e.domEvent.selectionRange,!0))){var t=(0,r.getFirstLeafNode)(e.contentDiv)||e.contentDiv;e.api.selectRange(e,(0,r.createRange)(t,0),!0)}r.Browser.isSafari||(e.domEvent.selectionRange=null),e.api.hasFocus(e)||e.contentDiv.focus()}}},5049:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getContent=void 0;var r=n(6344);t.getContent=function(e,t){var n,o,i="",a=0==t,l=2==t,s=e.lifecycle.shadowEditFragment||e.contentDiv;if(4==t)i=s.textContent;else if(3==t)i=(0,r.getTextContent)(s);else{var u=(n=s,(0,r.safeInstanceOf)(n,"DocumentFragment")?(o=n.ownerDocument.createElement("div")).appendChild(n.cloneNode(!0)):o=n.cloneNode(!0),o);u.normalize();var d=e.api.getSelectionRange(e,!0),c=l?e.lifecycle.shadowEditFragment?e.lifecycle.shadowEditSelectionPath:d?(0,r.getSelectionPath)(e.contentDiv,d):null:null,f=c&&(0,r.createRange)(u,c.start,c.end);e.api.transformColor(e,u,!1,null,1,!0,e.lifecycle.isDarkMode),a?(e.api.triggerEvent(e,{eventType:8,clonedRoot:u},!0),i=u.innerHTML):i=f?(0,r.getHtmlWithSelectionPath)(u,f):u.innerHTML}return null!=i?i:""}},5719:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPendableFormatState=void 0;var r=n(6344);t.getPendableFormatState=function(e,t){var n,a=e.api.getSelectionRange(e,!0),l=e.pendingFormatState.pendableFormatState,s=null===(n=e.pendingFormatState.pendableFormatPosition)||void 0===n?void 0:n.normalize(),u=a&&r.Position.getStart(a).normalize(),d=u&&s&&a.collapsed&&u.equalTo(s);return a&&l&&d&&!t?l:u?function(e,t){for(var n=t.node,a={},l=[],s=function(){var e=(0,r.getTagOfNode)(n),t=1==n.nodeType&&n.style;e&&t&&(0,r.getObjectKeys)(o).forEach((function(n){l.indexOf(n)>=0||(a[n]=a[n]||o[n](e,t),i[n](t)&&l.push(n))})),n=n.parentNode};n&&(0,r.contains)(e.contentDiv,n);)s();return a}(e,u):{}};var o={isBold:function(e,t){return"B"==e||"STRONG"==e||"H1"==e||"H2"==e||"H3"==e||"H4"==e||"H5"==e||"H6"==e||parseInt(t.fontWeight)>=700||["bold","bolder"].indexOf(t.fontWeight)>=0},isUnderline:function(e,t){return"U"==e||t.textDecoration.indexOf("underline")>=0},isItalic:function(e,t){return"I"==e||"EM"==e||"italic"===t.fontStyle},isSubscript:function(e,t){return"SUB"==e||"sub"===t.verticalAlign},isSuperscript:function(e,t){return"SUP"==e||"super"===t.verticalAlign},isStrikeThrough:function(e,t){return"S"==e||"STRIKE"==e||t.textDecoration.indexOf("line-through")>=0}},i={isBold:function(e){return""!==e.fontWeight&&parseInt(e.fontWeight)<700||"normal"===e.fontWeight},isUnderline:function(e){return""!==e.textDecoration&&e.textDecoration.indexOf("underline")<0},isItalic:function(e){return""!==e.fontStyle&&"italic"!==e.fontStyle},isSubscript:function(e){return""!==e.verticalAlign&&"sub"!==e.verticalAlign},isSuperscript:function(e){return""!==e.verticalAlign&&"super"!==e.verticalAlign},isStrikeThrough:function(e){return""!==e.textDecoration&&e.textDecoration.indexOf("line-through")<0}}},1467:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSelectionRange=void 0;var r=n(6344);t.getSelectionRange=function(e,t){var n,o=null;if(e.lifecycle.shadowEditFragment)return e.lifecycle.shadowEditSelectionPath&&(0,r.createRange)(e.contentDiv,e.lifecycle.shadowEditSelectionPath.start,e.lifecycle.shadowEditSelectionPath.end);if(!t||e.api.hasFocus(e)){var i=null===(n=e.contentDiv.ownerDocument.defaultView)||void 0===n?void 0:n.getSelection();if(i&&i.rangeCount>0){var a=i.getRangeAt(0);(0,r.contains)(e.contentDiv,a)&&(o=a)}}return!o&&t&&(o=e.domEvent.selectionRange),o}},2634:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSelectionRangeEx=void 0;var r=n(6344);function o(e){return{type:0,ranges:e,areAllCollapsed:i(e)}}function i(e){return e.filter((function(e){return null==e?void 0:e.collapsed})).length==e.length}t.getSelectionRangeEx=function(e){var t,n,a;if(e.lifecycle.shadowEditFragment){var l,s=e.lifecycle,u=s.shadowEditTableSelectionPath,d=s.shadowEditSelectionPath,c=s.shadowEditImageSelectionPath;if(((null==u?void 0:u.length)||0)>0)return{type:1,ranges:l=e.lifecycle.shadowEditTableSelectionPath.map((function(t){return(0,r.createRange)(e.contentDiv,t.start,t.end)})),areAllCollapsed:i(l),table:(0,r.findClosestElementAncestor)(l[0].startContainer,e.contentDiv,"table"),coordinates:void 0};if(((null==c?void 0:c.length)||0)>0)return{type:2,ranges:l=e.lifecycle.shadowEditImageSelectionPath.map((function(t){return(0,r.createRange)(e.contentDiv,t.start,t.end)})),areAllCollapsed:i(l),image:(0,r.findClosestElementAncestor)(l[0].startContainer,e.contentDiv,"img"),imageId:void 0};var f=d&&(0,r.createRange)(e.contentDiv,d.start,d.end);return o(f?[f]:[])}if(e.api.hasFocus(e)){if(e.domEvent.tableSelectionRange)return e.domEvent.tableSelectionRange;if(e.domEvent.imageSelectionRange)return e.domEvent.imageSelectionRange;var p=null===(t=e.contentDiv.ownerDocument.defaultView)||void 0===t?void 0:t.getSelection();if(p&&p.rangeCount>0){var v=p.getRangeAt(0);if((0,r.contains)(e.contentDiv,v))return o([v])}}return null!==(a=null!==(n=e.domEvent.tableSelectionRange)&&void 0!==n?n:e.domEvent.imageSelectionRange)&&void 0!==a?a:o(e.domEvent.selectionRange?[e.domEvent.selectionRange]:[])}},2628:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStyleBasedFormatState=void 0;var r=n(6344);t.getStyleBasedFormatState=function(e,t){if(!t)return{};var n=[],o=e.pendingFormatState.pendableFormatSpan;o&&(n=[o.style.fontFamily,o.style.fontSize,o.style.color,o.style.backgroundColor]);for(var i,a,l=t?(0,r.getComputedStyles)(t,["font-family","font-size","color","background-color","line-height","margin-top","margin-bottom","text-align","direction","font-weight"]):[],s=e.contentDiv,u=e.darkColorHandler;t&&(0,r.contains)(s,t,!0)&&(!i||!a);){if(1==t.nodeType){var d=t;i=i||d.style.getPropertyValue("color"),a=a||d.style.getPropertyValue("background-color")}t=t.parentNode}e.lifecycle.isDarkMode||t!=e.contentDiv||(i=i||l[2],a=a||l[3]);var c=u.parseColorValue(n[2]||i),f=u.parseColorValue(n[3]||a);return{fontName:n[0]||l[0],fontSize:n[1]||l[1],textColor:c.lightModeColor,backgroundColor:f.lightModeColor,textColors:c.darkModeColor?{lightModeColor:c.lightModeColor,darkModeColor:c.darkModeColor}:void 0,backgroundColors:f.darkModeColor?{lightModeColor:f.lightModeColor,darkModeColor:f.darkModeColor}:void 0,lineHeight:l[4],marginTop:l[5],marginBottom:l[6],textAlign:l[7],direction:l[8],fontWeight:l[9]}}},5149:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasFocus=void 0;var r=n(6344);t.hasFocus=function(e){var t=e.contentDiv.ownerDocument.activeElement;return!(!t||!(0,r.contains)(e.contentDiv,t,!0))}},1844:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.insertNode=void 0;var r=n(6344);t.insertNode=function(e,t,n){var o;n=n||{position:3,insertOnNewLine:!1,updateCursor:!0,replaceSelection:!0,insertToRegionRoot:!1};var i=e.contentDiv;return n.updateCursor&&e.api.focus(e),4==n.position?(null===(o=i.parentNode)||void 0===o||o.insertBefore(t,i.nextSibling),!0):(e.api.transformColor(e,t,!0,(function(){var o,a;if(n)switch(n.position){case 0:case 1:var l,s=0==n.position,u=(0,r.getFirstLastBlockElement)(i,s);if(u){var d=s?u.getStartNode():u.getEndNode();n.insertOnNewLine||3==d.nodeType||(0,r.isVoidHtmlElement)(d)?(0,r.safeInstanceOf)(t,"DocumentFragment")?(l=(0,r.toArray)(t.childNodes),null===(o=d.parentNode)||void 0===o||o.insertBefore(t,s?d:d.nextSibling)):l=null===(a=d.parentNode)||void 0===a?void 0:a.insertBefore(t,s?d:d.nextSibling):l=d.insertBefore(t,s?d.firstChild:null)}else l=i.appendChild(t);if(l&&n.insertOnNewLine){var c=Array.isArray(l)?l:[l];(0,r.isBlockElement)(c[0])&&(0,r.isBlockElement)(c[c.length-1])||(0,r.wrap)(c)}break;case 2:var f=i.appendChild(t);f&&n.insertOnNewLine&&!(0,r.isBlockElement)(f)&&(0,r.wrap)(f);break;case 5:case 3:var p=function(e,t){var n=e.api.getSelectionRange(e,!0),r=null;return 5==t.position?(r=n,n=t.range):n&&(r=n.cloneRange()),{range:n,rangeToRestore:r}}(e,n),v=p.range,h=p.rangeToRestore;if(!v)return;n.replaceSelection&&!v.collapsed&&v.deleteContents();var g=r.Position.getStart(v),m=void 0;g=n.insertOnNewLine&&n.insertToRegionRoot?function(e,t,n){var o=(0,r.getRegionsFromRange)(e.contentDiv,t,0)[0],i=n.node;if(o){if(3!=i.nodeType||n.isAtEnd||(i=(0,r.splitTextNode)(i,n.offset,!0)),i!=o.rootNode)for(;i&&i.parentNode!=o.rootNode;)(0,r.splitParentNode)(i,!1),i=i.parentNode;i&&(n=new r.Position(i,-3))}return n}(e,v,g):n.insertOnNewLine&&(m=(0,r.getBlockElementAtNode)(i,g.normalize().node))?function(e,t,n){var o=new r.Position(e.getEndNode(),-3);if((0,r.safeInstanceOf)(o.node,"HTMLTableRowElement")){var i=t.contentDiv.ownerDocument.createElement("div");(0,r.createRange)(n).insertNode(i),o=new r.Position(i,0)}return o}(m,e,g):(0,r.adjustInsertPosition)(i,t,g,v);var y=11==t.nodeType?t.lastChild:t;(v=(0,r.createRange)(g)).insertNode(t),n.updateCursor&&y&&(h=(0,r.createRange)(new r.Position(y,-3).normalize())),h&&e.api.selectRange(e,h)}}),0),!0)}},6651:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.restoreUndoSnapshot=void 0;var r=n(6344);t.restoreUndoSnapshot=function(e,t){var n,o;e.undo.hasNewContent&&t<0&&e.api.addUndoSnapshot(e,null,null,!1);var i=e.undo.snapshotsService.move(t);if(i&&null!=i.html)try{e.undo.isRestoring=!0,e.api.setContent(e,i.html,!0,null!==(n=i.metadata)&&void 0!==n?n:void 0);var a=e.darkColorHandler,l=e.lifecycle.isDarkMode;i.knownColors.forEach((function(e){a.registerColor(e.lightModeColor,l,e.darkModeColor)})),null===(o=i.entityStates)||void 0===o||o.forEach((function(t){var n=t.type,o=t.id,i=t.state,a=(0,r.queryElements)(e.contentDiv,(0,r.getEntitySelector)(n,o))[0],l=a&&(0,r.getEntityFromElement)(a);l&&e.api.triggerEvent(e,{eventType:15,operation:11,entity:l,state:i},!1)}))}finally{e.undo.isRestoring=!1}}},674:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.select=void 0;var r=n(6344);t.select=function(e,t,n,o,i){var a=function(e,t,n,o,i){var a,l=null;if(function(e){var t=e;return t&&"object"==typeof t&&"number"==typeof t.type&&Array.isArray(t.ranges)}(t))l=t;else if((0,r.safeInstanceOf)(t,"HTMLTableElement")&&(null===(a=n)||a&&"object"==typeof a&&"object"==typeof a.firstCell&&"object"==typeof a.lastCell))l={type:1,ranges:[],areAllCollapsed:!1,table:t,coordinates:null!=n?n:void 0};else if((0,r.safeInstanceOf)(t,"HTMLImageElement")&&void 0===n)l={type:2,ranges:[],areAllCollapsed:!1,image:t};else{var s=t?(0,r.safeInstanceOf)(t,"Range")?t:function(e){var t=e;return t&&"object"==typeof t&&Array.isArray(t.start)&&Array.isArray(t.end)}(t)?(0,r.createRange)(e.contentDiv,t.start,t.end):function(e){var t=e;return t&&"object"==typeof t&&"object"==typeof t.node&&"number"==typeof t.offset}(t)||(0,r.safeInstanceOf)(t,"Node")?(0,r.createRange)(t,n,o,i):null:null;l=s?{type:0,ranges:[s],areAllCollapsed:s.collapsed}:null}return l}(e,t,n,o,i);if(a){var l=e.domEvent.skipReselectOnFocus;e.domEvent.skipReselectOnFocus=!0;try{!function(e,t){switch(null==t?void 0:t.type){case 1:(0,r.contains)(e.contentDiv,t.table)&&(e.domEvent.imageSelectionRange=e.api.selectImage(e,null),e.domEvent.tableSelectionRange=e.api.selectTable(e,t.table,t.coordinates),t=e.domEvent.tableSelectionRange);break;case 2:(0,r.contains)(e.contentDiv,t.image)&&(e.domEvent.tableSelectionRange=e.api.selectTable(e,null),e.domEvent.imageSelectionRange=e.api.selectImage(e,t.image),t=e.domEvent.imageSelectionRange);break;case 0:e.domEvent.tableSelectionRange=e.api.selectTable(e,null),e.domEvent.imageSelectionRange=e.api.selectImage(e,null),(0,r.contains)(e.contentDiv,t.ranges[0])?e.api.selectRange(e,t.ranges[0]):t=null}e.api.triggerEvent(e,{eventType:22,selectionRangeEx:t},!0)}(e,a)}finally{e.domEvent.skipReselectOnFocus=l}}else e.domEvent.tableSelectionRange=e.api.selectTable(e,null),e.domEvent.imageSelectionRange=e.api.selectImage(e,null);return!!a}},4830:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectImage=void 0;var r=n(3505),o=n(6344),i="imageStyle";t.selectImage=function(e,t){s(e);var n=null;if(t){var i=(0,o.createRange)(t);(0,r.default)(t,"imageSelected"),(0,r.default)(e.contentDiv,"contentDiv_"),e.api.selectRange(e,(0,o.createRange)(new o.Position(t,-3))),a(e,t),n={type:2,ranges:[i],image:t,areAllCollapsed:i.collapsed}}return n};var a=function(e,t){(0,o.removeImportantStyleRule)(t,["border","margin"]);var n=l(e,t.id);(0,o.setGlobalCssStyles)(e.contentDiv.ownerDocument,n,i+e.contentDiv.id)},l=function(e,t){return"#"+e.contentDiv.id+" #"+t+" {outline-style: auto!important;outline-color: "+(e.imageSelectionBorderColor||"#DB626C")+"!important;caret-color: transparent!important;}"},s=function(e){var t=e.contentDiv.ownerDocument;(0,o.removeGlobalCssStyle)(t,i+e.contentDiv.id)}},7243:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectRange=void 0;var r=n(5149),o=n(6344);t.selectRange=function(e,t,n){return!(e.lifecycle.shadowEditSelectionPath||!(0,o.contains)(e.contentDiv,t)||((0,o.addRangeToSelection)(t,n),(0,r.hasFocus)(e)||(e.domEvent.selectionRange=t),t.collapsed&&function(e){var t=e.contentDiv,n=e.pendingFormatState,r=e.api.getSelectionRange;if(n.pendableFormatState){var i=t.ownerDocument,a=(0,o.getPendableFormatState)(i);(0,o.getObjectKeys)(o.PendableFormatCommandMap).forEach((function(e){var t;!!(null===(t=n.pendableFormatState)||void 0===t?void 0:t[e])!=a[e]&&i.execCommand(o.PendableFormatCommandMap[e],!1,void 0)}));var l=r(e,!0),s=l&&o.Position.getStart(l);s&&(n.pendableFormatPosition=s)}}(e),0))}},1036:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectTable=void 0;var r=n(3505),o=n(6344),i="tableStyle";t.selectTable=function(e,t,n){var d;if(a(e),function(e){if(e){var t=e||{},n=t.firstCell,r=t.lastCell;if(n&&r){var o=function(e){return u(e.x)&&u(e.y)};return o(n)&&o(r)}}return!1}(n)&&t){(0,r.default)(t,"tableSelected"),(0,r.default)(e.contentDiv,"contentDiv_");var c=function(e,t,n){var r=function(e,t,n){var r,i=[],a=[],u=new o.VTable(e),d=(0,o.isWholeTableSelected)(u,t);d?function(e,t,n,r){var o=t.table,i=e+" #"+o.id;n.push(i,i+" *");var a=new Range;a.selectNode(o),r.push(a)}(n,u,a,i):function(e,t,n,r,i){var a,u=e.firstCell.y,d=e.firstCell.x,c=e.lastCell.y,f=e.lastCell.x,p=t.table,v=null,h=null,g=(0,o.toArray)(p.childNodes).filter((function(e){return["THEAD","TBODY","TFOOT"].indexOf((0,o.getTagOfNode)(e))>-1})),m=0,y=g.map((function(e){var t={el:(0,o.getTagOfNode)(e),start:m,end:e.childNodes.length+m};return m=t.end,t}));null===(a=t.cells)||void 0===a||a.forEach((function(e,t){var a=0;v=null,h=null;for(var g=y.filter((function(e){return e.start<=t&&e.end>t}))[0],m=g?">"+g.el+">":">",b=g&&t+1>=g.start?t+1-g.start:t+1,E=0;E<e.length;E++){var C=e[E].td;if(C&&(a++,t>=u&&t<=c&&E>=d&&E<=f)){s(C);var S=l(n,p.id,m,b,(0,o.getTagOfNode)(C),a),T=S+" *";r.push(S,T),v=v||p.querySelector(S),h=p.querySelector(S)}}if(v&&h){var P=new Range;P.setStartBefore(v),P.setEndAfter(h),i.push(P)}}))}(t,u,n,a,i);for(var c=[],f="";a.length>0;)((f+=(f.length>0?",":"")+a.shift()||"").length+((null===(r=a[0])||void 0===r?void 0:r.length)||0)>9e3||0==a.length)&&(c.push(f+" {background-color: rgb(198,198,198) !important; caret-color: transparent}"),f="");return{cssRules:c,ranges:i,isWholeTableSelected:d}}(t,n,"#"+e.contentDiv.id),a=r.cssRules,u=r.ranges,d=r.isWholeTableSelected;return a.forEach((function(t){return(0,o.setGlobalCssStyles)(e.contentDiv.ownerDocument,t,i+e.contentDiv.id)})),{ranges:u,isWholeTableSelected:d}}(e,t,n),f=c.ranges,p=c.isWholeTableSelected;if(!function(e,t){var n,r=t.firstCell;return!(e.rows.item(r.y)&&(null===(n=e.rows.item(r.y))||void 0===n?void 0:n.cells.item(r.x)))}(t,n)){var v=null===(d=t.rows.item(n.firstCell.y))||void 0===d?void 0:d.cells.item(n.firstCell.x);v&&e.api.selectRange(e,(0,o.createRange)(new o.Position(v,0)))}return{type:1,ranges:f,table:t,areAllCollapsed:f.filter((function(e){return null==e?void 0:e.collapsed})).length==f.length,coordinates:n,isWholeTableSelected:p}}return null};var a=function(e){var t=e.contentDiv.ownerDocument;(0,o.removeGlobalCssStyle)(t,i+e.contentDiv.id)};function l(e,t,n,r,o,i){return e+" #"+t+n+" tr:nth-child("+r+")>"+o+":nth-child("+i+")"}function s(e){e&&(0,o.removeImportantStyleRule)(e,["background-color","background"])}function u(e){return(!!e||0==e)&&e>-1}},1282:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setContent=void 0;var r=n(6344);t.setContent=function(e,t,n,o){var i,a,l=!1;if(e.contentDiv.innerHTML!=t){e.api.triggerEvent(e,{eventType:20,newContent:t},!0);var s=e.entity.entityMap,u=t||"",d=(new DOMParser).parseFromString(null!==(a=null===(i=e.trustedHTMLHandler)||void 0===i?void 0:i.call(e,u))&&void 0!==a?a:u,"text/html").body;(0,r.restoreContentWithEntityPlaceholder)(d,e.contentDiv,s);var c=(0,r.extractContentMetadata)(e.contentDiv);(function(e,t){if(!e.lifecycle.shadowEditSelectionPath&&t)switch(e.domEvent.tableSelectionRange=null,e.domEvent.imageSelectionRange=null,e.domEvent.selectionRange=null,t.type){case 0:e.api.selectTable(e,null),e.api.selectImage(e,null);var n=(0,r.createRange)(e.contentDiv,t.start,t.end);e.api.selectRange(e,n);break;case 1:var o=(0,r.queryElements)(e.contentDiv,"#"+t.tableId)[0];o&&(e.domEvent.tableSelectionRange=e.api.selectTable(e,o,t));break;case 2:var i=(0,r.queryElements)(e.contentDiv,"#"+t.imageId)[0];i&&(e.domEvent.imageSelectionRange=e.api.selectImage(e,i))}})(e,o=o||c),l=!0}var f=e.lifecycle.isDarkMode;(!o&&f||o&&!!o.isDarkMode!=!!f)&&(e.api.transformColor(e,e.contentDiv,!1,null,f?0:1,!0,null==o?void 0:o.isDarkMode),l=!0),n&&l&&e.api.triggerEvent(e,{eventType:7,source:"SetContent"},!1)}},6233:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.switchShadowEdit=void 0;var r=n(6344);t.switchShadowEdit=function(e,t){var n=e.lifecycle,o=e.contentDiv,i=n.shadowEditEntities,a=n.shadowEditFragment,l=n.shadowEditSelectionPath,s=n.shadowEditTableSelectionPath,u=n.shadowEditImageSelectionPath,d=!!a,c=function(e,t){return(null==t?void 0:t.type)==e&&t.ranges.map((function(e){return(0,r.getSelectionPath)(o,e)})).map((function(e){return e}))||null};if(t){if(!d){var f=e.api.getSelectionRangeEx(e),p=e.api.getSelectionRange(e,!0);l=p&&(0,r.getSelectionPath)(o,p),s=c(1,f),u=c(2,f),i={},a=(0,r.moveContentWithEntityPlaceholders)(o,i),e.api.triggerEvent(e,{eventType:17,fragment:a,selectionPath:l},!1),n.shadowEditFragment=a,n.shadowEditSelectionPath=l,n.shadowEditTableSelectionPath=s,n.shadowEditImageSelectionPath=u,n.shadowEditEntities=i}n.shadowEditFragment&&(0,r.restoreContentWithEntityPlaceholder)(n.shadowEditFragment,o,n.shadowEditEntities,!0)}else n.shadowEditFragment=null,n.shadowEditSelectionPath=null,n.shadowEditEntities=null,d&&(e.api.triggerEvent(e,{eventType:18},!1),a&&(0,r.restoreContentWithEntityPlaceholder)(a,o,i),l&&(e.domEvent.selectionRange=(0,r.createRange)(o,l.start,l.end)))}},5764:(e,t)=>{"use strict";function n(e,t,o){o&&r(e)&&t(e);for(var i=e.firstChild;i;i=i.nextSibling)r(i)&&t(i),n(i,t)}function r(e){var t=e;return e.nodeType==Node.ELEMENT_NODE&&!!t.style}Object.defineProperty(t,"__esModule",{value:!0}),t.transformColor=void 0,t.transformColor=function(e,t,r,o,i,a,l){void 0===l&&(l=!1);var s=e.darkColorHandler,u=e.lifecycle.onExternalContentTransform,d=0==i;t&&(a||e.lifecycle.isDarkMode)&&n(t,u?function(e){u(e,l,d,s)}:function(e){s.transformElementColor(e,l,d)},r),null==o||o()}},857:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.triggerEvent=void 0;var n=[11,12,8,21];t.triggerEvent=function(e,t,r){e.lifecycle.shadowEditFragment&&!(n.indexOf(t.eventType)>=0)||!r&&e.plugins.some((function(e){return function(e,t){var n;return!(!t.onPluginEvent||!(null===(n=t.willHandleEventExclusively)||void 0===n?void 0:n.call(t,e)))&&(t.onPluginEvent(e),!0)}(t,e)}))||e.plugins.forEach((function(e){e.onPluginEvent&&e.onPluginEvent(t)}))}},3505:(e,t)=>{"use strict";function n(e,t,n){for(var r=0,o=function(){return n.getElementById(t+r)},i=o();i;)r++,i=o();e.id=t+r}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=e.ownerDocument;e.id?r.querySelectorAll("#"+e.id).length>1&&(e.removeAttribute("id"),n(e,t,r)):n(e,t,r)}},4142:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2544),o=n(4082),i=n(6344),a=function(){function e(e){var t=this;this.editor=null,this.disposer=null,this.onPaste=function(e){var n,r=null;if(t.editor){var o=t.editor;(0,i.extractClipboardEvent)(e,(function(e){o&&!o.isDisposed()&&o.paste(e)}),{allowedCustomPasteType:t.state.allowedCustomPasteType,getTempDiv:function(){var e;return r=null!==(e=o.getSelectionRange())&&void 0!==e?e:null,t.getTempDiv(o)},removeTempDiv:function(e){r&&t.cleanUpAndRestoreSelection(e,r,!1)}},null!==(n=t.editor.getSelectionRange())&&void 0!==n?n:void 0)}},this.state={allowedCustomPasteType:e.allowedCustomPasteType||[]}}return e.prototype.getName=function(){return"CopyPaste"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.disposer=this.editor.addDomEventHandler({paste:function(e){return t.onPaste(e)},copy:function(e){return t.onCutCopy(e,!1)},cut:function(e){return t.onCutCopy(e,!0)}})},e.prototype.dispose=function(){this.disposer&&this.disposer(),this.disposer=null,this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onCutCopy=function(e,t){var n=this;if(this.editor){var r=this.editor.getSelectionRangeEx();if(r&&!r.areAllCollapsed){var o=this.editor.getContent(2),a=this.getTempDiv(this.editor,!0),l=(0,i.setHtmlWithMetadata)(a,o,this.editor.getTrustedHTMLHandler()),s=null;if(1===r.type&&r.coordinates){var u=a.querySelector("#"+r.table.id);s=this.createTableRange(u,r.coordinates),t&&this.deleteTableContent(this.editor,r.table,r.coordinates)}else if(2===r.type){var d=a.querySelector("#"+r.image.id);d&&(s=(0,i.createRange)(d),t&&this.deleteImage(this.editor,r.image.id))}else s=0===(null==l?void 0:l.type)?(0,i.createRange)(a,l.start,l.end):null;s&&(this.editor.triggerPluginEvent(9,{clonedRoot:a,range:s,rawEvent:e,isCut:t}).range&&(0,i.addRangeToSelection)(s),this.editor.runAsync((function(e){n.cleanUpAndRestoreSelection(a,r,!t),t&&e.addUndoSnapshot((function(){var t=e.deleteSelectedContent();e.focus(),e.select(t)}),"Cut")})))}}},e.prototype.getTempDiv=function(e,t){var n=e.getCustomData("CopyPasteTempDiv",(function(){var t=(0,i.createElement)(3,e.getDocument());return e.getDocument().body.appendChild(t),t}),(function(e){var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)}));return t&&(n.style.backgroundColor="white",n.style.color="black"),n.style.display="",n.focus(),n},e.prototype.cleanUpAndRestoreSelection=function(e,t,n){var r,o,a;if((null===(r=t)||void 0===r?void 0:r.type)||0==t.type){var l=t;switch(l.type){case 1:case 2:null===(o=this.editor)||void 0===o||o.select(l);break;case 0:var s=null===(a=l.ranges)||void 0===a?void 0:a[0];this.restoreRange(s,n)}}else this.restoreRange(t,n);e.style.backgroundColor="",e.style.color="",e.style.display="none",(0,i.moveChildNodes)(e)},e.prototype.restoreRange=function(e,t){e&&this.editor&&(t&&i.Browser.isAndroid&&e.collapse(),this.editor.select(e))},e.prototype.createTableRange=function(e,t){var n=new i.VTable(e);return n.selection=t,(0,o.removeCellsOutsideSelection)(n),n.writeBack(),(0,i.createRange)(n.table)},e.prototype.deleteTableContent=function(e,t,n){var o=new i.VTable(t);o.selection=n,(0,r.forEachSelectedCell)(o,(function(t){(null==t?void 0:t.td)&&(t.td.innerHTML=e.getTrustedHTMLHandler()("<br>"))}));var a=(0,i.isWholeTableSelected)(o,n),l=t.rows.length-1===n.lastCell.y&&0===n.firstCell.y;a?(o.edit(4),o.writeBack()):l&&(o.edit(5),o.writeBack()),(a||l)&&(t.style.removeProperty("width"),t.style.removeProperty("height"))},e.prototype.deleteImage=function(e,t){e.queryElements("#"+t,(function(t){e.deleteNode(t)}))},e}();t.default=a},7039:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6344),o=function(){function e(e,t){var n,o=this;this.editor=null,this.disposer=null,this.onDragStart=function(e){var t,n=e,r=null===(t=o.editor)||void 0===t?void 0:t.getElementAtCursor("*",n.target);r&&!r.isContentEditable&&n.preventDefault()},this.onDrop=function(){var e;null===(e=o.editor)||void 0===e||e.runAsync((function(e){e.addUndoSnapshot((function(){}),"Drop")}))},this.onFocus=function(){var e,t,n;if(!o.state.skipReselectOnFocus){var i=o.state.tableSelectionRange||{},a=i.table,l=i.coordinates,s=(o.state.imageSelectionRange||{}).image;a&&l?null===(e=o.editor)||void 0===e||e.select(a,l):s?null===(t=o.editor)||void 0===t||t.select(s):o.state.selectionRange&&(null===(n=o.editor)||void 0===n||n.select(o.state.selectionRange))}r.Browser.isSafari||(o.state.selectionRange=null)},this.onSelectionChangeSafari=function(){var e;(null===(e=o.editor)||void 0===e?void 0:e.hasFocus())&&!o.editor.isInShadowEdit()&&(o.state.selectionRange=o.editor.getSelectionRange(!1))},this.cacheSelection=function(){!o.state.selectionRange&&o.editor&&(o.state.selectionRange=o.editor.getSelectionRange(!1))},this.onScroll=function(e){var t;null===(t=o.editor)||void 0===t||t.triggerPluginEvent(14,{rawEvent:e,scrollContainer:o.state.scrollContainer})},this.onKeyboardEvent=function(e){((0,r.isCharacterValue)(e)||e.which>=33&&e.which<=40)&&e.stopPropagation()},this.onInputEvent=function(e){e.stopPropagation()},this.onContextMenuEvent=function(e){var t,n,i=[],a=null===(t=o.editor)||void 0===t?void 0:t.getContentSearcherOfCursor(),l=null==a?void 0:a.getInlineElementBefore(),s=e.target;2!=e.button&&l&&(s=l.getContainerNode()),o.state.contextMenuProviders.forEach((function(e){var t,n=null!==(t=e.getContextMenuItems(s))&&void 0!==t?t:[];(null==n?void 0:n.length)>0&&(i.length>0&&i.push(null),(0,r.arrayPush)(i,n))})),null===(n=o.editor)||void 0===n||n.triggerPluginEvent(16,{rawEvent:e,items:i})},this.state={isInIME:!1,scrollContainer:e.scrollContainer||t,selectionRange:null,stopPrintableKeyboardEventPropagation:!e.allowKeyboardEventPropagation,contextMenuProviders:(null===(n=e.plugins)||void 0===n?void 0:n.filter(i))||[],tableSelectionRange:null,imageSelectionRange:null}}return e.prototype.getName=function(){return"DOMEvent"},e.prototype.initialize=function(e){var t,n,o,i=this;this.editor=e;var a=this.editor.getDocument(),l=((t={keypress:this.getEventHandler(1),keydown:this.getEventHandler(0),keyup:this.getEventHandler(2),mousedown:5,contextmenu:this.onContextMenuEvent,compositionstart:function(){return i.state.isInIME=!0},compositionend:function(t){i.state.isInIME=!1,e.triggerPluginEvent(4,{rawEvent:t})},dragstart:this.onDragStart,drop:this.onDrop,focus:this.onFocus})[r.Browser.isIE?"textinput":"input"]=this.getEventHandler(3),t);r.Browser.isSafari?a.addEventListener("selectionchange",this.onSelectionChangeSafari):r.Browser.isIEOrEdge?l.beforedeactivate=this.cacheSelection:l.blur=this.cacheSelection,this.disposer=e.addDomEventHandler(l),this.state.scrollContainer.addEventListener("scroll",this.onScroll),null===(n=a.defaultView)||void 0===n||n.addEventListener("scroll",this.onScroll),null===(o=a.defaultView)||void 0===o||o.addEventListener("resize",this.onScroll)},e.prototype.dispose=function(){var e,t,n,o,i=null===(e=this.editor)||void 0===e?void 0:e.getDocument();i&&r.Browser.isSafari&&i.removeEventListener("selectionchange",this.onSelectionChangeSafari),null===(t=null==i?void 0:i.defaultView)||void 0===t||t.removeEventListener("resize",this.onScroll),null===(n=null==i?void 0:i.defaultView)||void 0===n||n.removeEventListener("scroll",this.onScroll),this.state.scrollContainer.removeEventListener("scroll",this.onScroll),null===(o=this.disposer)||void 0===o||o.call(this),this.disposer=null,this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.getEventHandler=function(e){var t=this;return this.state.stopPrintableKeyboardEventPropagation?{pluginEventType:e,beforeDispatch:function(n){return 3==e?t.onInputEvent(n):t.onKeyboardEvent(n)}}:e},e}();function i(e){var t;return!!(null===(t=e)||void 0===t?void 0:t.getContextMenuItems)}t.default=o},6262:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6344),o=function(){function e(){this.editor=null,this.state={features:{}}}return e.prototype.getName=function(){return"Edit"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){var t,n=!1,o=null,i=!1,a=0==e.eventType;if(a){var l=e.rawEvent,s=null===(t=this.editor)||void 0===t?void 0:t.getSelectionRange();n=(i=(0,r.isCtrlOrMetaPressed)(l))||l.altKey,o=this.state.features[l.which]||s&&!s.collapsed&&this.state.features[258]}else 7==e.eventType&&(o=this.state.features[257]);for(var u=0;o&&u<(null==o?void 0:o.length);u++){var d=o[u];if((d.allowFunctionKeys||!n)&&this.editor&&d.shouldHandleEvent(e,this.editor,i)){d.handleEvent(e,this.editor),a&&(e.handledByEditFeature=!0);break}}},e}();t.default=o},3346:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4195),o=n(6344),i=/_(\d{1,8})$/,a=["^_Entity$","^_EId_","^_EType_","^_EReadonly_"],l=[6,7,4,5],s=function(){function e(){var e=this;this.editor=null,this.handleCutEvent=function(t){var n,r=null===(n=e.editor)||void 0===n?void 0:n.getSelectionRange();r&&!r.collapsed&&e.checkRemoveEntityForRange(t)},this.state={entityMap:{}}}return e.prototype.getName=function(){return"Entity"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null,this.state.entityMap={}},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 6:this.handleMouseUpEvent(e);break;case 0:this.handleKeyDownEvent(e.rawEvent);break;case 9:e.isCut&&this.handleCutEvent(e.rawEvent);break;case 10:this.handleBeforePasteEvent(e.sanitizingOption);break;case 7:this.handleContentChangedEvent(e);break;case 11:this.handleContentChangedEvent();break;case 8:this.handleExtractContentWithDomEvent(e.clonedRoot);break;case 16:this.handleContextMenuEvent(e.rawEvent);break;case 15:this.handleEntityOperationEvent(e)}this.editor&&(0,r.inlineEntityOnPluginEvent)(e,this.editor)},e.prototype.handleContextMenuEvent=function(e){var t,n=e.target,r=n&&(null===(t=this.editor)||void 0===t?void 0:t.getElementAtCursor((0,o.getEntitySelector)(),n));r&&(e.preventDefault(),this.triggerEvent(r,2,e))},e.prototype.handleMouseUpEvent=function(e){var t,n=e.rawEvent,r=e.isClicking,i=n.target;this.editor&&r&&i&&(t=this.editor.getElementAtCursor((0,o.getEntitySelector)(),i))&&(this.triggerEvent(t,1,n),u(this.editor))},e.prototype.handleKeyDownEvent=function(e){var t;if((0,o.isCharacterValue)(e)||8==e.which||46==e.which||13==e.which){var n=null===(t=this.editor)||void 0===t?void 0:t.getSelectionRange();n&&!n.collapsed&&this.checkRemoveEntityForRange(e)}},e.prototype.handleBeforePasteEvent=function(e){var t,n=null===(t=this.editor)||void 0===t?void 0:t.getSelectionRange();n&&!n.collapsed&&this.checkRemoveEntityForRange(null),e.additionalAllowedCssClasses&&(0,o.arrayPush)(e.additionalAllowedCssClasses,a)},e.prototype.handleContentChangedEvent=function(e){var t=this,n=!1;(0,o.getObjectKeys)(this.state.entityMap).forEach((function(e){var r=t.state.entityMap[e],i=r.element;!t.editor||r.isDeleted||t.editor.contains(i)||(r.isDeleted=!0,t.triggerEvent(i,6),n||i.isContentEditable||(0,o.isBlockElement)(i)||(n=!0))})),("InsertEntity"==(null==e?void 0:e.source)&&e.data?[e.data]:this.getExistingEntities().filter((function(e){var n=t.state.entityMap[e.id];return!n||n.element!=e.wrapper||n.isDeleted}))).forEach((function(e){var n=e.wrapper,r=e.type,i=e.id,a=e.isReadonly;e.id=t.ensureUniqueId(r,i,n),(0,o.commitEntity)(n,r,a,e.id),t.handleNewEntity(e)})),n&&this.editor&&(0,r.normalizeDelimitersInEditor)(this.editor)},e.prototype.handleEntityOperationEvent=function(e){if(this.editor&&l.indexOf(e.operation)>=0){var t=this.state.entityMap[e.entity.id];t&&(t.isDeleted=!0)}},e.prototype.handleExtractContentWithDomEvent=function(e){var t=this;(0,o.toArray)(e.querySelectorAll((0,o.getEntitySelector)())).forEach((function(e){e.removeAttribute("contentEditable"),t.triggerEvent(e,8)}))},e.prototype.checkRemoveEntityForRange=function(e){var t,n=this,r=[],i=(0,o.getEntitySelector)();if(null===(t=this.editor)||void 0===t||t.queryElements(i,1,(function(t){t.isContentEditable?r.push(t):n.triggerEvent(t,6,e)})),this.editor&&r.length>0){var a=this.editor.queryElements(i,2);r.forEach((function(t){var r=a.indexOf(t)>=0;n.triggerEvent(t,r?6:7,e)}))}},e.prototype.triggerEvent=function(e,t,n){var r,i=e&&(0,o.getEntityFromElement)(e);return i?null===(r=this.editor)||void 0===r?void 0:r.triggerPluginEvent(15,{operation:t,rawEvent:n,entity:i}):null},e.prototype.handleNewEntity=function(e){var t=e.wrapper,n=this.triggerEvent(t,0),r={element:e.wrapper};(null==n?void 0:n.shouldPersist)&&(r.canPersist=!0),this.state.entityMap[e.id]=r},e.prototype.getExistingEntities=function(){var e,t;return null!==(t=null===(e=this.editor)||void 0===e?void 0:e.queryElements((0,o.getEntitySelector)()).map(o.getEntityFromElement).filter((function(e){return!!e})))&&void 0!==t?t:[]},e.prototype.ensureUniqueId=function(e,t,n){for(var r=i.exec(t),o=(r?t.substr(0,t.length-r[0].length):t)||e,a="",l=r&&parseInt(r[1])||0;;l++){a=l>0?o+"_"+l:o;var s=this.state.entityMap[a];if(!s||s.element==n)break}return a},e}();t.default=s;var u=o.Browser.isIE?function(e){e.runAsync((function(e){var t=e.getCustomData("ENTITY_IE_FOCUS_BUTTON",(function(){var t=(0,o.createElement)({tag:"button",style:"overflow:hidden;position:fixed;width:0;height:0;top:-1000px"},e.getDocument());return t.onblur=function(){t.style.display="none"},e.insertNode(t,{position:4}),t}));t.style.display="",(0,o.addRangeToSelection)((0,o.createRange)(t,0))}))}:function(){}},6194:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6344),o=function(){function e(){this.editor=null}return e.prototype.getName=function(){return"ImageSelection"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){var e;null===(e=this.editor)||void 0===e||e.select(null),this.editor=null},e.prototype.onPluginEvent=function(e){var t,n;if(this.editor)switch(e.eventType){case 6:var o=e.rawEvent.target;(0,r.safeInstanceOf)(o,"HTMLImageElement")&&o.isContentEditable&&1!=e.rawEvent.button&&e.isClicking&&this.editor.select(o);break;case 5:var i=e.rawEvent.target,a=this.editor.getSelectionRangeEx();a&&2===a.type&&a.image!==i&&this.editor.select(null);break;case 0:var l=e.rawEvent,s=l.key,u=this.editor.getSelectionRangeEx();if(!(l.ctrlKey||l.altKey||l.shiftKey||l.metaKey||2!==u.type)){var d=null===(t=u.image)||void 0===t?void 0:t.parentNode;"Escape"===s&&d?(this.editor.select(u.image,-2),null===(n=this.editor.getSelectionRange())||void 0===n||n.collapse(),e.rawEvent.stopPropagation()):"Delete"===s?(this.editor.deleteNode(u.image),e.rawEvent.preventDefault()):d&&this.editor.select(u.image,-2)}break;case 16:var c=e.rawEvent.target,f=this.editor.getSelectionRangeEx();!(0,r.safeInstanceOf)(c,"HTMLImageElement")||2===f.type&&f.image===c||this.editor.select(c)}},e}();t.default=o},6121:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7582),o=n(6344),i="contenteditable",a={darkModeColor:"rgb(51,51,51)",lightModeColor:"rgb(255,255,255)"},l={darkModeColor:"rgb(255,255,255)",lightModeColor:"rgb(0,0,0)"},s=function(){function e(e,t){var n,s,u=this;this.editor=null,this.initializer=null,this.disposer=null,this.initialContent=e.initialContent||t.innerHTML||"",null===t.getAttribute(i)&&(this.initializer=function(){t.contentEditable="true",t.style.userSelect="text"},this.disposer=function(){t.style.userSelect="",t.removeAttribute(i)}),this.adjustColor=e.doNotAdjustEditorColor?function(){}:function(){var e,n=l,r=a,i=u.state.isDarkMode,s=null===(e=u.editor)||void 0===e?void 0:e.getDarkColorHandler();(0,o.setColor)(t,n,!1,i,!1,s),(0,o.setColor)(t,r,!0,i,!1,s)};var d=null!==(n=e.getDarkColor)&&void 0!==n?n:function(e){return e},c=e.defaultFormat?(0,r.__assign)({},e.defaultFormat):null;c&&(c.textColor&&!c.textColors&&(c.textColors={lightModeColor:c.textColor,darkModeColor:d(c.textColor)},delete c.textColor),c.backgroundColor&&!c.backgroundColors&&(c.backgroundColors={lightModeColor:c.backgroundColor,darkModeColor:d(c.backgroundColor)},delete c.backgroundColor)),this.state={customData:{},defaultFormat:c,isDarkMode:!!e.inDarkMode,getDarkColor:d,onExternalContentTransform:null!==(s=e.onExternalContentTransform)&&void 0!==s?s:null,experimentalFeatures:e.experimentalFeatures||[],shadowEditFragment:null,shadowEditEntities:null,shadowEditSelectionPath:null,shadowEditTableSelectionPath:null,shadowEditImageSelectionPath:null}}return e.prototype.getName=function(){return"Lifecycle"},e.prototype.initialize=function(e){var t;this.editor=e,this.editor.setContent(this.initialContent,!1),null===(t=this.initializer)||void 0===t||t.call(this),this.adjustColor(),this.editor.triggerPluginEvent(11,{},!0)},e.prototype.dispose=function(){var e,t=this;null===(e=this.editor)||void 0===e||e.triggerPluginEvent(12,{},!0),(0,o.getObjectKeys)(this.state.customData).forEach((function(e){var n=t.state.customData[e];n&&n.disposer&&n.disposer(n.value),delete t.state.customData[e]})),this.disposer&&(this.disposer(),this.disposer=null,this.initializer=null),this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){7!=e.eventType||"SwitchToDarkMode"!=e.source&&"SwitchToLightMode"!=e.source||(this.state.isDarkMode="SwitchToDarkMode"==e.source,this.adjustColor())},e}();t.default=s},5896:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){var e=this;this.editor=null,this.mouseUpEventListerAdded=!1,this.mouseDownX=null,this.mouseDownY=null,this.onMouseUp=function(t){e.editor&&(e.removeMouseUpEventListener(),e.editor.triggerPluginEvent(6,{rawEvent:t,isClicking:e.mouseDownX==t.pageX&&e.mouseDownY==t.pageY}))}}return e.prototype.getName=function(){return"MouseUp"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.removeMouseUpEventListener(),this.editor=null},e.prototype.onPluginEvent=function(e){this.editor&&5==e.eventType&&!this.mouseUpEventListerAdded&&(this.editor.getDocument().addEventListener("mouseup",this.onMouseUp,!0),this.mouseUpEventListerAdded=!0,this.mouseDownX=e.rawEvent.pageX,this.mouseDownY=e.rawEvent.pageY)},e.prototype.removeMouseUpEventListener=function(){this.editor&&this.mouseUpEventListerAdded&&(this.mouseUpEventListerAdded=!1,this.editor.getDocument().removeEventListener("mouseup",this.onMouseUp,!0))},e}();t.default=n},3433:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6344),o=function(){function e(){this.editor=null}return e.prototype.getName=function(){return"NormalizeTable"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 11:case 7:this.editor&&this.normalizeTables(this.editor.queryElements("table"));break;case 10:this.normalizeTables((0,r.toArray)(e.fragment.querySelectorAll("table")));break;case 5:this.normalizeTableFromEvent(e.rawEvent);break;case 0:e.rawEvent.shiftKey&&this.normalizeTableFromEvent(e.rawEvent);break;case 8:t=e.clonedRoot,(0,r.toArray)(t.querySelectorAll("li")).forEach((function(e){var t=e.previousSibling;"block"==e.style.display&&(0,r.safeInstanceOf)(t,"HTMLLIElement")&&(e.style.removeProperty("display"),t.appendChild((0,r.changeElementTag)(e,"div")))}))}var t},e.prototype.normalizeTableFromEvent=function(e){var t,n=null===(t=this.editor)||void 0===t?void 0:t.getElementAtCursor("table",e.target);n&&this.normalizeTables([n])},e.prototype.normalizeTables=function(e){if(this.editor&&e.length>0){var t=this.editor.getSelectionRangeEx(),n=0==(null==t?void 0:t.type)&&t.ranges[0]||{},o=n.startContainer,i=n.endContainer,a=n.startOffset,l=n.endOffset,s=function(e){var t=!1;return e.forEach((function(e){for(var n,o=null,i=e.firstChild;i;i=i.nextSibling)switch((0,r.getTagOfNode)(i)){case"TR":o||(o=e.ownerDocument.createElement("tbody"),e.insertBefore(o,i)),o.appendChild(i),i=o,t=!0;break;case"TBODY":o?((0,r.moveChildNodes)(o,i,!0),null===(n=i.parentNode)||void 0===n||n.removeChild(i),i=o,t=!0):o=i;break;default:o=null}var a=e.querySelectorAll("colgroup"),l=e.querySelector("thead");l&&a.forEach((function(e){l.contains(e)||l.appendChild(e)}))})),t}(e);s&&(o&&i&&"number"==typeof a&&"number"==typeof l?this.editor.select(o,a,i,l):1==(null==t?void 0:t.type)&&t.coordinates&&this.editor.select(t.table,t.coordinates))}},e}();t.default=o},4465:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6344),o=function(){function e(){this.editor=null,this.state={pendableFormatPosition:null,pendableFormatState:null,pendableFormatSpan:null}}return e.prototype.getName=function(){return"PendingFormatState"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null,this.clear()},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 13:e.formatState?(this.state.pendableFormatPosition=this.getCurrentPosition(),this.state.pendableFormatState=e.formatState,this.state.pendableFormatSpan=e.formatCallback?this.createPendingFormatSpan(e.formatCallback):null):this.clear();break;case 0:case 5:case 7:var t=null;this.editor&&0==e.eventType&&(0,r.isCharacterValue)(e.rawEvent)&&this.state.pendableFormatSpan?(this.state.pendableFormatSpan.removeAttribute("contentEditable"),this.editor.insertNode(this.state.pendableFormatSpan),this.editor.select(this.state.pendableFormatSpan,0,this.state.pendableFormatSpan,-1),this.clear()):(0==e.eventType&&e.rawEvent.which>=33&&e.rawEvent.which<=40||this.state.pendableFormatPosition&&(t=this.getCurrentPosition())&&!this.state.pendableFormatPosition.equalTo(t)||7==e.eventType&&("SwitchToDarkMode"==e.source||"SwitchToLightMode"==e.source))&&this.clear()}},e.prototype.clear=function(){this.state.pendableFormatPosition=null,this.state.pendableFormatState=null,this.state.pendableFormatSpan=null},e.prototype.getCurrentPosition=function(){var e,t,n=null===(e=this.editor)||void 0===e?void 0:e.getSelectionRange();return null!==(t=n&&r.Position.getStart(n).normalize())&&void 0!==t?t:null},e.prototype.createPendingFormatSpan=function(e){var t,n,o=this.state.pendableFormatSpan;if(!o&&this.editor){var i=this.editor.getStyleBasedFormatState(),a=this.editor.getDocument(),l=this.editor.isDarkMode();(o=a.createElement("span")).contentEditable="true",o.appendChild(a.createTextNode("​")),o.style.setProperty("font-family",null!==(t=i.fontName)&&void 0!==t?t:null),o.style.setProperty("font-size",null!==(n=i.fontSize)&&void 0!==n?n:null);var s=this.editor.getDarkColorHandler();(i.textColors||i.textColor)&&(0,r.setColor)(o,i.textColors||i.textColor,!1,l,!1,s),(i.backgroundColors||i.backgroundColor)&&(0,r.setColor)(o,i.backgroundColors||i.backgroundColor,!0,l,!1,s)}return o&&e(o),o},e}();t.default=o},4269:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6344),o=function(){function e(){this.editor=null}return e.prototype.getName=function(){return"TypeInContainer"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.isRangeEmpty=function(e){return!(!e.collapsed||e.startContainer.nodeType!==Node.ELEMENT_NODE||"DIV"!=(0,r.getTagOfNode)(e.startContainer)||e.startContainer.firstChild)},e.prototype.onPluginEvent=function(e){var t,n=this;if(1==e.eventType&&this.editor&&(!e.rawEvent||!(0,r.isCtrlOrMetaPressed)(e.rawEvent))){var o=this.editor.getSelectionRange(),i=o&&(0,r.findClosestElementAncestor)(o.startContainer,void 0,"[style]");if(!o||!this.isRangeEmpty(o)&&this.editor.contains(i))return;if(o.collapsed)this.editor.ensureTypeInContainer(r.Position.getStart(o),e.rawEvent);else{var a=function(){var t,r,o=null===(t=n.editor)||void 0===t?void 0:t.getFocusedPosition();o&&(null===(r=n.editor)||void 0===r||r.ensureTypeInContainer(o,e.rawEvent))};r.Browser.isMobileOrTablet?null===(t=this.editor.getDocument().defaultView)||void 0===t||t.setTimeout(a,100):this.editor.runAsync(a)}}},e}();t.default=o},6469:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6344),o=function(){function e(e){var t,n,o;this.editor=null,this.lastKeyPress=null,this.state={snapshotsService:e.undoMetadataSnapshotService||(n=e.undoSnapshotService,n?{canMove:function(e){return n.canMove(e)},move:function(e){return(o=n.move(e))?{html:o,metadata:null,knownColors:[]}:null},addSnapshot:function(e,t){return n.addSnapshot(e.html+(e.metadata?"\x3c!--"+JSON.stringify(e.metadata)+"--\x3e":""),t)},clearRedo:function(){return n.clearRedo()},canUndoAutoComplete:function(){return n.canUndoAutoComplete()}}:void 0)||(t=(0,r.createSnapshots)(1e7),{canMove:function(e){return(0,r.canMoveCurrentSnapshot)(t,e)},move:function(e){return(0,r.moveCurrentSnapshot)(t,e)},addSnapshot:function(e,n){return(0,r.addSnapshotV2)(t,e,n)},clearRedo:function(){return(0,r.clearProceedingSnapshotsV2)(t)},canUndoAutoComplete:function(){return(0,r.canUndoAutoComplete)(t)}}),isRestoring:!1,hasNewContent:!1,isNested:!1,autoCompletePosition:null}}return e.prototype.getName=function(){return"Undo"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.willHandleEventExclusively=function(e){return 0==e.eventType&&8==e.rawEvent.which&&!e.rawEvent.ctrlKey&&this.canUndoAutoComplete()},e.prototype.onPluginEvent=function(e){if(this.editor&&!this.editor.isInIME())switch(e.eventType){case 11:var t=this.editor.getUndoState();t.canUndo||t.canRedo||this.addUndoSnapshot();break;case 0:this.onKeyDown(e.rawEvent);break;case 1:this.onKeyPress(e.rawEvent);break;case 4:this.clearRedoForInput(),this.addUndoSnapshot();break;case 7:this.onContentChanged(e);break;case 23:this.onBeforeKeyboardEditing(e.rawEvent)}},e.prototype.onKeyDown=function(e){var t,n;if(8==e.which&&!e.altKey||46==e.which){if(8==e.which&&!e.ctrlKey&&this.canUndoAutoComplete())e.preventDefault(),null===(t=this.editor)||void 0===t||t.undo(),this.state.autoCompletePosition=null,this.lastKeyPress=e.which;else if(!e.defaultPrevented){var o=null===(n=this.editor)||void 0===n?void 0:n.getSelectionRange();!o||o.collapsed&&this.lastKeyPress==e.which&&!(0,r.isCtrlOrMetaPressed)(e)||this.addUndoSnapshot(),this.state.hasNewContent=!0,this.lastKeyPress=e.which}}else e.which>=33&&e.which<=40?(this.state.hasNewContent&&this.addUndoSnapshot(),this.lastKeyPress=0):8!=this.lastKeyPress&&46!=this.lastKeyPress||this.state.hasNewContent&&this.addUndoSnapshot()},e.prototype.onKeyPress=function(e){var t;if(!e.metaKey){var n=null===(t=this.editor)||void 0===t?void 0:t.getSelectionRange();n&&!n.collapsed||32==e.which&&32!=this.lastKeyPress||13==e.which?(this.addUndoSnapshot(),13==e.which&&(this.state.hasNewContent=!0)):this.clearRedoForInput(),this.lastKeyPress=e.which}},e.prototype.onBeforeKeyboardEditing=function(e){e.which!=this.lastKeyPress&&this.addUndoSnapshot(),this.lastKeyPress=e.which,this.state.hasNewContent=!0},e.prototype.onContentChanged=function(e){this.state.isRestoring||"SwitchToDarkMode"==e.source||"SwitchToLightMode"==e.source||"Keyboard"==e.source||this.clearRedoForInput()},e.prototype.clearRedoForInput=function(){this.state.snapshotsService.clearRedo(),this.lastKeyPress=0,this.state.hasNewContent=!0},e.prototype.canUndoAutoComplete=function(){var e,t,n=null===(e=this.editor)||void 0===e?void 0:e.getFocusedPosition();return this.state.snapshotsService.canUndoAutoComplete()&&!!n&&!!(null===(t=this.state.autoCompletePosition)||void 0===t?void 0:t.equalTo(n))},e.prototype.addUndoSnapshot=function(){var e;null===(e=this.editor)||void 0===e||e.addUndoSnapshot(),this.state.autoCompletePosition=null},e}();t.default=o},8376:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPluginState=void 0;var r=n(4142),o=n(7039),i=n(6262),a=n(3346),l=n(6194),s=n(6121),u=n(5896),d=n(3433),c=n(4465),f=n(4269),p=n(6469);t.default=function(e,t){var n=t.corePluginOverride||{};return{typeInContainer:n.typeInContainer||new f.default,edit:n.edit||new i.default,pendingFormatState:n.pendingFormatState||new c.default,_placeholder:null,typeAfterLink:null,undo:n.undo||new p.default(t),domEvent:n.domEvent||new o.default(t,e),mouseUp:n.mouseUp||new u.default,copyPaste:n.copyPaste||new r.default(t),entity:n.entity||new a.default,imageSelection:n.imageSelection||new l.default,normalizeTable:n.normalizeTable||new d.default,lifecycle:n.lifecycle||new s.default(t,e)}},t.getPluginState=function(e){return{domEvent:e.domEvent.getState(),pendingFormatState:e.pendingFormatState.getState(),edit:e.edit.getState(),lifecycle:e.lifecycle.getState(),undo:e.undo.getState(),entity:e.entity.getState(),copyPaste:e.copyPaste.getState()}}},2544:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachSelectedCell=void 0,t.forEachSelectedCell=function(e,t){var n;if(e.selection)for(var r=e.selection,o=r.lastCell,i=r.firstCell,a=i.y;a<=o.y;a++)for(var l=i.x;l<=o.x;l++)e.cells&&(null===(n=e.cells[a][l])||void 0===n?void 0:n.td)&&t(e.cells[a][l])}},4195:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeDelimitersInEditor=t.inlineEntityOnPluginEvent=void 0;var r=n(6344),o=".entityDelimiterAfter,.entityDelimiterBefore",i="​",a="span"+(0,r.getEntitySelector)();function l(e){var t,n,o,a;e.normalize();var l,s=e.firstChild,u=null!==(n=null===(t=s.nodeValue)||void 0===t?void 0:t.indexOf(i))&&void 0!==n?n:-1;if(u>=0&&((0,r.splitTextNode)(s,0==u?1:u,!1),e.childNodes.forEach((function(e){e.nodeValue!==i&&(l=e)})),l)){null===(o=e.parentElement)||void 0===o||o.insertBefore(l,"entityDelimiterBefore"==e.className?e:e.nextSibling);var d=null===(a=l.ownerDocument)||void 0===a?void 0:a.getSelection();d&&d.setPosition(l,new r.Position(l,-1).offset)}}function s(e){e.queryElements(o).forEach((function(e){if((0,r.getDelimiterFromElement)(e)){var t=e.classList.contains("entityDelimiterBefore")?e.nextElementSibling:e.previousElementSibling;(0,r.safeInstanceOf)(t,"HTMLElement")&&(0,r.getEntityFromElement)(t)||c(e)}else f(e)})),u(e.queryElements(a))}function u(e){e.forEach((function(e){d(e)&&(0,r.addDelimiters)(e)}))}function d(e){return!!(e&&(0,r.safeInstanceOf)(e,"HTMLElement")&&(t=(0,r.getEntityFromElement)(e),(null==t?void 0:t.isReadonly)&&!(0,r.isBlockElement)(t.wrapper)&&(0,r.safeInstanceOf)(t.wrapper,"HTMLElement")));var t}function c(e){var t;null===(t=null==e?void 0:e.parentElement)||void 0===t||t.removeChild(e)}function f(e,t){if(void 0===t&&(t=!0),e){var n=e.classList.contains("entityDelimiterAfter")?e.previousElementSibling:e.nextElementSibling;t&&n&&d(n)||(e.classList.remove("entityDelimiterAfter","entityDelimiterBefore"),e.normalize(),e.childNodes.forEach((function(e){var t,n,o,a=null!==(n=null===(t=e.textContent)||void 0===t?void 0:t.indexOf(i))&&void 0!==n?n:-1;a>=0&&(null===(o=(0,r.createRange)(e,a,e,a+1))||void 0===o||o.deleteContents())})))}}t.inlineEntityOnPluginEvent=function(e,t){switch(e.eventType){case 7:"SetContent"===e.source&&s(t);break;case 11:s(t);break;case 10:var n=e.fragment,i=e.sanitizingOption;u(n.querySelectorAll(a)),i.additionalAllowedCssClasses&&(0,r.arrayPush)(i.additionalAllowedCssClasses,["entityDelimiterAfter","entityDelimiterBefore"]);break;case 8:case 9:e.clonedRoot.querySelectorAll(o).forEach((function(e){(0,r.getDelimiterFromElement)(e)?c(e):f(e)}));break;case 0:!function(e,t){var n,i,a=e.getSelectionRangeEx(),s=t.rawEvent;if(0==a.type)if(a.areAllCollapsed&&((0,r.isCharacterValue)(s)||13===s.which)){var u=null===(n=e.getFocusedPosition())||void 0===n?void 0:n.normalize();if(!u)return;var c=u.element,v=c==u.node?c.childNodes.item(u.offset):c,h=e.getElementAtCursor(o,v);if(!h)return;13===s.which?function(e,t){var n=t.classList.contains("entityDelimiterAfter"),i=n?t.previousSibling:t.nextSibling,a=function(e,t){var n;if(t){for(var o=null===(n=e.getBlockElementAtNode(t))||void 0===n?void 0:n.getStartNode();o&&!(0,r.isBlockElement)(o);)o=e.contains(o.parentElement)?o.parentElement:void 0;return o}}(e,t);e.runAsync((function(){if(a){var e=n?a.nextSibling:a.previousSibling;if(e&&(0,r.safeInstanceOf)(e,"HTMLElement")){var t=e.querySelectorAll(o);f(t.item(n?0:t.length-1))}d(i)&&([i.nextElementSibling,i.previousElementSibling].forEach((function(e){e&&(0,r.matchesSelector)(e,o)&&!(0,r.getDelimiterFromElement)(e)&&f(e,!1)})),(0,r.addDelimiters)(i))}}))}(e,h):3==(null===(i=h.firstChild)||void 0===i?void 0:i.nodeType)&&e.runAsync((function(){return l(h)}))}else if(!a.areAllCollapsed&&!s.shiftKey&&16!=s.which){var g=a.ranges[0];if(!g)return;!function(e,t,n){var i=t.startContainer,a=t.endContainer,s=t.startOffset,u=t.endOffset,d=e.getElementAtCursor(o,i),c=e.getElementAtCursor(o,a),v=p(d),h=p(c);(v||h)&&e.select(null!=v?v:new r.Position(i,s),null!=h?h:new r.Position(a,u)),e.runAsync((function(e){var t=e.getElementAtCursor(o);t&&(l(t),13===n.which&&f(t))}))}(e,g,s)}}(t,e)}},t.normalizeDelimitersInEditor=s;var p=function(e){if(e&&(0,r.getDelimiterFromElement)(e)){var t=e.classList.contains("entityDelimiterAfter");return new r.Position(e,t?-3:-2)}}},4082:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeCellsOutsideSelection=void 0;var r=n(6344);t.removeCellsOutsideSelection=function(e){if(e.selection){if((0,r.isWholeTableSelected)(e,e.selection))return;e.table.style.removeProperty("width"),e.table.style.removeProperty("height");var t=e.selection,n=t.firstCell,o=t.lastCell,i=[],a=n.x,l=n.y,s=o.x,u=o.y;e.cells&&(e.cells.forEach((function(e,t){(e=e.filter((function(e,n){return t>=l&&t<=u&&n>=a&&n<=s}))).length>0&&i.push(e)})),e.cells=i)}}},2842:(e,t,n)=>{"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(6344),l=/^\s*var\(\s*(\-\-[a-zA-Z0-9\-_]+)\s*(?:,\s*(.*))?\)\s*$/;!function(e){e[e.CssColor=0]="CssColor",e[e.HtmlColor=1]="HtmlColor"}(i||(i={}));var s=[(r={},r[0]="color",r[1]="color",r),(o={},o[0]="background-color",o[1]="bgcolor",o)],u=function(){function e(e,t){this.contentDiv=e,this.getDarkColor=t,this.knownColors={}}return e.prototype.getKnownColorsCopy=function(){return Object.values(this.knownColors)},e.prototype.registerColor=function(e,t,n){var r,o=this.parseColorValue(e);return o&&(e=o.lightModeColor,n=o.darkModeColor||n,r=o.key),t&&e?(r=r||"--darkColor_"+e.replace(/[^\d\w]/g,"_"),this.knownColors[r]||(n=n||this.getDarkColor(e),this.knownColors[r]={lightModeColor:e,darkModeColor:n},this.contentDiv.style.setProperty(r,n)),"var("+r+", "+e+")"):e},e.prototype.reset=function(){var e=this;(0,a.getObjectKeys)(this.knownColors).forEach((function(t){return e.contentDiv.style.removeProperty(t)})),this.knownColors={}},e.prototype.parseColorValue=function(e,t){var n,r,o,i="";if(e){var a=e.startsWith("var(")?l.exec(e):null;a?a[2]?(r=a[1],i=a[2],o=null===(n=this.knownColors[r])||void 0===n?void 0:n.darkModeColor):i="":t?(i=this.findLightColorFromDarkColor(e)||"")&&(o=e):i=e}return{key:r,lightModeColor:i,darkModeColor:o}},e.prototype.findLightColorFromDarkColor=function(e){var t=this,n=(0,a.parseColor)(e);if(n){var r=(0,a.getObjectKeys)(this.knownColors).find((function(e){var r=(0,a.parseColor)(t.knownColors[e].darkModeColor);return r&&r[0]==n[0]&&r[1]==n[1]&&r[2]==n[2]}));if(r)return this.knownColors[r].lightModeColor}return null},e.prototype.transformElementColor=function(e,t,n){var r=this;s.forEach((function(o,i){var l=r.parseColorValue(e.style.getPropertyValue(o[0])||e.getAttribute(o[1]),!!t).lightModeColor;e.style.setProperty(o[0],null),e.removeAttribute(o[1]),l&&"inherit"!=l&&(0,a.setColor)(e,l,0!=i,n,!1,r)}))},e}();t.default=u},3386:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7582),o=n(9602),i=function(e){function t(t,n){return void 0===n&&(n={}),e.call(this,t,n,o.createEditorCore)||this}return(0,r.__extends)(t,e),t}(n(5075).EditorBase);t.default=i},5075:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EditorBase=void 0;var r=n(7582),o=n(3441),i=n(6344),a=function(){function e(e,t,n){var r=this;if(this.core=null,"DIV"!=(0,i.getTagOfNode)(e))throw new Error("contentDiv must be an HTML DIV element");this.core=n(e,t),this.core.plugins.forEach((function(e){return e.initialize(r)})),this.ensureTypeInContainer(new i.Position(this.core.contentDiv,0).normalize())}return e.prototype.dispose=function(){for(var e,t=this.getCore(),n=t.plugins.length-1;n>=0;n--){var r=t.plugins[n];try{r.dispose()}catch(n){null===(e=t.disposeErrorHandler)||void 0===e||e.call(t,r,n)}}t.darkColorHandler.reset(),this.core=null},e.prototype.isDisposed=function(){return!this.core},e.prototype.insertNode=function(e,t){var n=this.getCore();return!!e&&n.api.insertNode(n,e,null!=t?t:null)},e.prototype.deleteNode=function(e){return!!(e&&this.contains(e)&&e.parentNode)&&(e.parentNode.removeChild(e),!0)},e.prototype.replaceNode=function(e,t,n){var r=this.getCore();return!(!this.contains(e)||!t||(r.api.transformColor(r,n?t:null,!0,(function(){var n;return null===(n=e.parentNode)||void 0===n?void 0:n.replaceChild(t,e)}),0),0))},e.prototype.getBlockElementAtNode=function(e){return(0,i.getBlockElementAtNode)(this.getCore().contentDiv,e)},e.prototype.contains=function(e){return!!e&&(0,i.contains)(this.getCore().contentDiv,e)},e.prototype.queryElements=function(e,t,n){void 0===t&&(t=0);var o=this.getCore(),a=[],l=t instanceof Function?0:t;n=t instanceof Function?t:n;var s=0==l?null:this.getSelectionRangeEx();return s?(s.ranges.forEach((function(t){a.push.apply(a,(0,r.__spreadArray)([],(0,r.__read)((0,i.queryElements)(o.contentDiv,e,n,l,t)),!1))})),a):(0,i.queryElements)(o.contentDiv,e,n,l,void 0)},e.prototype.collapseNodes=function(e,t,n){return(0,i.collapseNodes)(this.getCore().contentDiv,e,t,n)},e.prototype.isEmpty=function(e){return(0,i.isNodeEmpty)(this.getCore().contentDiv,e)},e.prototype.getContent=function(e){void 0===e&&(e=0);var t=this.getCore();return t.api.getContent(t,e)},e.prototype.setContent=function(e,t){void 0===t&&(t=!0);var n=this.getCore();n.api.setContent(n,e,t)},e.prototype.insertContent=function(e,t){var n;if(e){var r=this.getDocument(),o=null===(n=(new DOMParser).parseFromString(this.getCore().trustedHTMLHandler(e),"text/html"))||void 0===n?void 0:n.body,a=(null==o?void 0:o.childNodes)?(0,i.toArray)(o.childNodes):[];t&&t.insertOnNewLine&&a.length>1&&(a=[(0,i.wrap)(a)]);var l=r.createDocumentFragment();a.forEach((function(e){return l.appendChild(e)})),this.insertNode(l,t)}},e.prototype.deleteSelectedContent=function(){var e=this.getSelectionRange();return e&&!e.collapsed?(0,i.deleteSelectedContent)(this.getCore().contentDiv,e):null},e.prototype.paste=function(e,t,n,r){var o=this;void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===r&&(r=!1);var a=this.getCore();if(e){e.snapshotBeforePaste?this.setContent(e.snapshotBeforePaste):e.snapshotBeforePaste=this.getContent(2);var l=this.getSelectionRange(),s=l&&i.Position.getStart(l),u=a.api.createPasteFragment(a,e,s,t,n,r);u&&this.addUndoSnapshot((function(){return o.insertNode(u),e}),"Paste")}},e.prototype.getSelectionRange=function(e){void 0===e&&(e=!0);var t=this.getCore();return t.api.getSelectionRange(t,e)},e.prototype.getSelectionRangeEx=function(){var e=this.getCore();return e.api.getSelectionRangeEx(e)},e.prototype.getSelectionPath=function(){var e=this.getSelectionRange();return e&&(0,i.getSelectionPath)(this.getCore().contentDiv,e)},e.prototype.hasFocus=function(){var e=this.getCore();return e.api.hasFocus(e)},e.prototype.focus=function(){var e=this.getCore();e.api.focus(e)},e.prototype.select=function(e,t,n,r){var o=this.getCore();return o.api.select(o,e,t,n,r)},e.prototype.getFocusedPosition=function(){var e,t=null===(e=this.getDocument().defaultView)||void 0===e?void 0:e.getSelection();if((null==t?void 0:t.focusNode)&&this.contains(t.focusNode))return new i.Position(t.focusNode,t.focusOffset);var n=this.getSelectionRange();return n?i.Position.getStart(n):null},e.prototype.getElementAtCursor=function(e,t,n){var r,o=this;return n=t?void 0:n,null!==(r=(0,i.cacheGetEventData)(null!=n?n:null,"GET_ELEMENT_AT_CURSOR_"+e,(function(){if(!t){var n=o.getFocusedPosition();t=null==n?void 0:n.node}return t&&(0,i.findClosestElementAncestor)(t,o.getCore().contentDiv,e)})))&&void 0!==r?r:null},e.prototype.isPositionAtBeginning=function(e){return(0,i.isPositionAtBeginningOf)(e,this.getCore().contentDiv)},e.prototype.getSelectedRegions=function(e){void 0===e&&(e=0);var t=this.getSelectionRangeEx(),n=[],o=this.getCore().contentDiv;return t.ranges.forEach((function(t){n.push.apply(n,(0,r.__spreadArray)([],(0,r.__read)(t?(0,i.getRegionsFromRange)(o,t,e):[]),!1))})),n.filter((function(e,t,n){return n.indexOf(e)===t}))},e.prototype.addDomEventHandler=function(e,t){var n,r="string"==typeof e?((n={})[e]=t,n):e,o=this.getCore();return o.api.attachDomEvent(o,r)},e.prototype.triggerPluginEvent=function(e,t,n){void 0===n&&(n=!1);var o=this.getCore(),i=(0,r.__assign)({eventType:e},t);return o.api.triggerEvent(o,i,n),i},e.prototype.triggerContentChangedEvent=function(e,t){void 0===e&&(e="SetContent"),this.triggerPluginEvent(7,{source:e,data:t})},e.prototype.undo=function(){this.focus();var e=this.getCore();e.api.restoreUndoSnapshot(e,-1)},e.prototype.redo=function(){this.focus();var e=this.getCore();e.api.restoreUndoSnapshot(e,1)},e.prototype.addUndoSnapshot=function(e,t,n,r){var o=this.getCore();o.api.addUndoSnapshot(o,null!=e?e:null,null!=t?t:null,null!=n&&n,r)},e.prototype.getUndoState=function(){var e=this.getCore().undo,t=e.hasNewContent,n=e.snapshotsService;return{canUndo:t||n.canMove(-1),canRedo:n.canMove(1)}},e.prototype.getDocument=function(){return this.getCore().contentDiv.ownerDocument},e.prototype.getScrollContainer=function(){return this.getCore().domEvent.scrollContainer},e.prototype.getCustomData=function(e,t,n){var r=this.getCore();return(r.lifecycle.customData[e]=r.lifecycle.customData[e]||{value:t?t():void 0,disposer:n}).value},e.prototype.isInIME=function(){return this.getCore().domEvent.isInIME},e.prototype.getDefaultFormat=function(){var e;return null!==(e=this.getCore().lifecycle.defaultFormat)&&void 0!==e?e:{}},e.prototype.getBodyTraverser=function(e){return i.ContentTraverser.createBodyTraverser(this.getCore().contentDiv,e)},e.prototype.getSelectionTraverser=function(e){var t;return(e=null!==(t=null!=e?e:this.getSelectionRange())&&void 0!==t?t:void 0)?i.ContentTraverser.createSelectionTraverser(this.getCore().contentDiv,e):null},e.prototype.getBlockTraverser=function(e){void 0===e&&(e=3);var t=this.getSelectionRange();return t?i.ContentTraverser.createBlockTraverser(this.getCore().contentDiv,t,e):null},e.prototype.getContentSearcherOfCursor=function(e){var t=this;return(0,i.cacheGetEventData)(null!=e?e:null,"ContentSearcher",(function(){var e=t.getSelectionRange();return e&&new i.PositionContentSearcher(t.getCore().contentDiv,i.Position.getStart(e))}))},e.prototype.runAsync=function(e){var t=this,n=this.getCore().contentDiv.ownerDocument.defaultView||window,r=n.requestAnimationFrame((function(){!t.isDisposed()&&e&&e(t)}));return function(){n.cancelAnimationFrame(r)}},e.prototype.setEditorDomAttribute=function(e,t){null===t?this.getCore().contentDiv.removeAttribute(e):this.getCore().contentDiv.setAttribute(e,t)},e.prototype.getEditorDomAttribute=function(e){return this.getCore().contentDiv.getAttribute(e)},e.prototype.getRelativeDistanceToEditor=function(e,t){if(this.contains(e)){var n=this.getCore().contentDiv,r=n.getBoundingClientRect(),o=e.getBoundingClientRect();if(r&&o){var i=o.left-(null==r?void 0:r.left),a=o.top-(null==r?void 0:r.top);return t&&(i+=n.scrollLeft,a+=n.scrollTop),[i,a]}}return null},e.prototype.addContentEditFeature=function(e){var t=this.getCore();null==e||e.keys.forEach((function(n){var r=t.edit.features[n]||[];r.push(e),t.edit.features[n]=r}))},e.prototype.removeContentEditFeature=function(e){var t=this.getCore();null==e||e.keys.forEach((function(n){var r,o=t.edit.features[n],i=null!==(r=null==o?void 0:o.indexOf(e))&&void 0!==r?r:-1;i>=0&&(t.edit.features[n].splice(i,1),t.edit.features[n].length<1&&delete t.edit.features[n])}))},e.prototype.getStyleBasedFormatState=function(e){var t;if(!e){var n=this.getSelectionRange();e=null!==(t=n&&i.Position.getStart(n).normalize().node)&&void 0!==t?t:void 0}var r=this.getCore();return r.api.getStyleBasedFormatState(r,null!=e?e:null)},e.prototype.getPendableFormatState=function(e){void 0===e&&(e=!1);var t=this.getCore();return t.api.getPendableFormatState(t,e)},e.prototype.ensureTypeInContainer=function(e,t){var n=this.getCore();n.api.ensureTypeInContainer(n,e,t)},e.prototype.setDarkModeState=function(e){var t=this.isDarkMode();if(t!=!!e){var n=this.getCore();n.api.transformColor(n,n.contentDiv,!1,null,e?0:1,!0,t),this.triggerContentChangedEvent(e?"SwitchToDarkMode":"SwitchToLightMode")}},e.prototype.isDarkMode=function(){return this.getCore().lifecycle.isDarkMode},e.prototype.transformToDarkColor=function(e,t){void 0===t&&(t=0);var n=this.getCore();n.api.transformColor(n,e,!0,null,t)},e.prototype.getDarkColorHandler=function(){return this.getCore().darkColorHandler},e.prototype.startShadowEdit=function(){var e=this.getCore();e.api.switchShadowEdit(e,!0)},e.prototype.stopShadowEdit=function(){var e=this.getCore();e.api.switchShadowEdit(e,!1)},e.prototype.isInShadowEdit=function(){return!!this.getCore().lifecycle.shadowEditFragment},e.prototype.isFeatureEnabled=function(e){return(0,o.isFeatureEnabled)(this.getCore().lifecycle.experimentalFeatures,e)},e.prototype.getTrustedHTMLHandler=function(){return this.getCore().trustedHTMLHandler},e.prototype.getSizeTransformer=function(){return this.getCore().sizeTransformer},e.prototype.getZoomScale=function(){return this.getCore().zoomScale},e.prototype.setZoomScale=function(e){var t=this.getCore();if(e>0&&e<=10){var n=t.zoomScale;t.zoomScale=e,n!=e&&this.triggerPluginEvent(21,{oldZoomScale:n,newZoomScale:e},!0)}},e.prototype.getVisibleViewport=function(){return this.getCore().getVisibleViewport()},e.prototype.getCore=function(){if(!this.core)throw new Error("Editor is already disposed");return this.core},e}();t.EditorBase=a},9602:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEditorCore=void 0;var r=n(7582),o=n(8376),i=n(2842),a=n(6344),l=n(6447);t.createEditorCore=function(e,t){var n,s=(0,o.default)(e,t),u=[];(0,a.getObjectKeys)(s).forEach((function(e){"_placeholder"==e?t.plugins&&(0,a.arrayPush)(u,t.plugins):u.push(s[e])}));var d=(0,o.getPluginState)(s),c=(null!==(n=t.zoomScale)&&void 0!==n?n:-1)>0?t.zoomScale:1,f=t.getVisibleViewport||function(){var e=d.domEvent.scrollContainer;return(0,a.getIntersectedRect)(e==p.contentDiv?[e]:[e,p.contentDiv])},p=(0,r.__assign)((0,r.__assign)({contentDiv:e,api:(0,r.__assign)((0,r.__assign)({},l.coreApiMap),t.coreApiOverride||{}),originalApi:l.coreApiMap,plugins:u.filter((function(e){return!!e}))},d),{trustedHTMLHandler:t.trustedHTMLHandler||function(e){return e},zoomScale:c,sizeTransformer:t.sizeTransformer||function(e){return e/c},getVisibleViewport:f,imageSelectionBorderColor:t.imageSelectionBorderColor,darkColorHandler:new i.default(e,d.lifecycle.getDarkColor),disposeErrorHandler:t.disposeErrorHandler});return p}},3441:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFeatureEnabled=void 0,t.isFeatureEnabled=function(e,t){return(e||[]).indexOf(t)>=0}},6630:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEditorCore=t.isFeatureEnabled=t.EditorBase=t.Editor=void 0;var r=n(3386);Object.defineProperty(t,"Editor",{enumerable:!0,get:function(){return r.default}});var o=n(5075);Object.defineProperty(t,"EditorBase",{enumerable:!0,get:function(){return o.EditorBase}});var i=n(3441);Object.defineProperty(t,"isFeatureEnabled",{enumerable:!0,get:function(){return i.isFeatureEnabled}});var a=n(9602);Object.defineProperty(t,"createEditorCore",{enumerable:!0,get:function(){return a.createEditorCore}})},8715:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8655),o=n(6997),i=function(){function e(e){this.element=e}return e.prototype.collapseToSingleElement=function(){return this.element},e.prototype.getStartNode=function(){return this.element},e.prototype.getEndNode=function(){return this.element},e.prototype.equals=function(e){return this.element==e.getStartNode()},e.prototype.isAfter=function(e){return(0,o.default)(this.element,e.getEndNode())},e.prototype.contains=function(e){return(0,r.default)(this.element,e,!0)},e.prototype.getTextContent=function(){var e;return(null===(e=this.element)||void 0===e?void 0:e.textContent)||""},e}();t.default=i},461:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8053),o=n(8655),i=n(8831),a=n(3408),l=n(5499),s=n(6997),u=n(4251),d=n(9381),c=["TD","TH","LI","BLOCKQUOTE"],f=function(){function e(e,t,n){this.rootNode=e,this.startNode=t,this.endNode=n}return e.getBlockContext=function(e){for(var t=e;t&&!(0,l.default)(t);)t=t.parentNode;return t},e.prototype.collapseToSingleElement=function(){for(var t=e.getBlockContext(this.startNode),n=t?(0,r.default)(t,this.startNode,this.endNode,!0):[],o=e.getBlockContext(this.startNode);n[0]&&n[0]!=o&&n[0].parentNode!=this.rootNode&&c.indexOf((0,a.default)(n[0].parentNode))<0;){var i=(0,d.splitBalancedNodeRange)(n);if(!i)break;n=[i]}return 1==n.length&&(0,l.default)(n[0])?n[0]:(0,u.default)(n)},e.prototype.getStartNode=function(){return this.startNode},e.prototype.getEndNode=function(){return this.endNode},e.prototype.equals=function(e){return this.startNode==e.getStartNode()&&this.endNode==e.getEndNode()},e.prototype.isAfter=function(e){return(0,s.default)(this.getStartNode(),e.getEndNode())},e.prototype.contains=function(e){return(0,o.default)(this.startNode,e,!0)||(0,o.default)(this.endNode,e,!0)||(0,s.default)(e,this.startNode)&&(0,s.default)(this.endNode,e)},e.prototype.getTextContent=function(){var e=(0,i.default)(this.getStartNode(),this.getEndNode());return e?e.toString():""},e}();t.default=f},7070:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8053),o=n(8655),i=n(3408),a=n(5499),l=n(8715),s=n(461);function u(e,t,n){var r=e;if("BR"==(0,i.default)(r)&&n)return r;for(;r;){for(var o=e;e.parentNode&&!(o=n?e.nextSibling:e.previousSibling);)if((e=e.parentNode)==t)return r;for(;o;){if((0,a.default)(o))return r;if("BR"==(0,i.default)(o))return n?o:r;e=o,o=n?e.firstChild:e.lastChild}r=e}return r}t.default=function(e,t){if(!(0,o.default)(e,t))return null;var n=s.default.getBlockContext(t);if(!n)return null;if(n==t)return new l.default(n);var i=u(t,n,!1),d=u(t,n,!0);if(!i||!d)return null;var c=(0,r.default)(e,i,d,!1);if(0===c.length)return null;if(i=c[0],d=c[c.length-1],i.parentNode!=d.parentNode)return new s.default(e,i,d);for(;!i.previousSibling&&!d.nextSibling;){var f=i.parentNode;if(f==n){n!=e&&(i=d=f);break}if(!f||f==e)break;i=d=f}return i==d&&(0,a.default)(i)?new l.default(i):new s.default(e,i,d)}},1306:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7070);t.default=function(e,t){var n=e;do{n=n&&(t?n.firstChild:n.lastChild)}while(n&&n.firstChild);return n&&(0,r.default)(e,n)||null}},1545:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3877),o=n(6960),i=n(8375),a=n(246);t.default=function(e,t,n,l){var s,u=e.clipboardData||(null===(s=e.target.ownerDocument)||void 0===s?void 0:s.defaultView).clipboardData;u.items?(e.preventDefault(),(0,r.default)((0,i.default)(u.items),n,!0).then((function(e){var n;n=l,a.Browser.isAndroid&&n&&n.deleteContents(),t(e)}))):(0,o.default)(u,t,n)}},3877:(e,t,n)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0});var o=n(3126),i=n(246),a=/^Version:[0-9\.]+\s+StartHTML:\s*([0-9]+)\s+EndHTML:\s*([0-9]+)\s+/i,l="text/*",s="link-preview",u=((r={})["text/html"]=function(e,t){return e.rawHtml=i.Browser.isEdge?function(e){var t=a.exec(e);if(3==(null==t?void 0:t.length)){var n=parseInt(t[1]),r=parseInt(t[2]);n>0&&r>n&&(e=e.substring(n,r))}return e}(t):t},r["text/plain"]=function(e,t){return e.text=t},r[l]=function(e,t,n){return!!n&&(e.customValues[n]=t)},r["text/"+s]=function(e,t){try{e.customValues[s]=t,e.linkPreview=JSON.parse(t)}catch(e){}},r);t.default=function(e,t,n){var r={types:[],text:"",image:null,files:[],rawHtml:null,customValues:{},pasteNativeEvent:n};return Promise.all((e||[]).map((function(e){var n=e.type;if(0!=n.indexOf("image/")||r.image||"file"!=e.kind){if("file"==e.kind)return new Promise((function(t){var o=e.getAsFile();o&&(r.types.push(n),r.files.push(o)),t()}));var i=function(e,t){var n=0==e.indexOf("text/")?e.substring(5):null,r=t&&n?t.indexOf(n):-1;return n&&r>=0?n:void 0}(n,null==t?void 0:t.allowedCustomPasteType),a=u[n]||(i?u[l]:null);return new Promise((function(t){return a?e.getAsString((function(e){r.types.push(n),a(r,e,i),t()})):t()}))}return r.types.push(n),r.image=e.getAsFile(),new Promise((function(e){r.image?(0,o.default)(r.image,(function(t){r.imageDataUri=t,e()})):e()}))}))).then((function(){return r}))}},6960:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3126),o=n(8375);t.default=function(e,t,n){for(var i,a,l,s={types:e.types?(0,o.default)(e.types):[],text:e.getData("text"),image:null,files:[],rawHtml:null,customValues:{},pasteNativeEvent:!0},u=0;u<(e.files?e.files.length:0);u++){var d=e.files.item(u);if(0==(null===(i=null==d?void 0:d.type)||void 0===i?void 0:i.indexOf("image/"))){s.image=d;break}}var c=function(){s.image?(0,r.default)(s.image,(function(e){s.imageDataUri=e,t(s)})):t(s)};if((null==n?void 0:n.getTempDiv)&&(null==n?void 0:n.removeTempDiv)){var f=n.getTempDiv();f.contentEditable="true",f.innerHTML="",f.focus(),null===(l=null===(a=f.ownerDocument)||void 0===a?void 0:a.defaultView)||void 0===l||l.setTimeout((function(){var e;s.rawHtml=f.innerHTML,null===(e=n.removeTempDiv)||void 0===e||e.call(n,f),c()}),0)}else s.rawHtml=void 0,c()}},351:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){return e?1:t?2:n?3:0}},8736:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=t.ownerDocument.createElement("img");n.style.maxWidth="100%",n.src=e,t.appendChild(n)}},2543:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transformTabCharacters=void 0;var r=n(4251);function o(e,t){void 0===t&&(t=0);for(var n,r=e;-1!=(n=r.indexOf("\t"));){var o=r.slice(0,n),i=r.slice(n+1),a=6-(o.length+t)%6;r=o+Array(a).fill(" ").join("")+i}return r}t.default=function(e,t,n){var i=n.ownerDocument;e.split("\n").forEach((function(e,a,l){(e=e.replace(/^ /g," ").replace(/\r/g,"").replace(/ {2}/g,"  ")).includes("\t")&&(e=o(e,0===a?null==t?void 0:t.offset:0));var s=i.createTextNode(e);2==l.length&&0==a?(n.appendChild(s),n.appendChild(i.createElement("br"))):a>0&&a<l.length-1?n.appendChild((0,r.default)(""==e?i.createElement("br"):s)):n.appendChild(s)}))},t.transformTabCharacters=o},5673:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3408),o=n(8375);function i(e,t){(0,o.default)(e.querySelectorAll("style")).forEach(t)}t.default=function(e,t,n){var a,l,s=t.clipboardData,u=t.sanitizingOption,d=s.rawHtml;if(d&&(null==e?void 0:e.body)){var c=null===(a=e.querySelector("html"))||void 0===a?void 0:a.attributes;(c?(0,o.default)(c):[]).reduce((function(e,t){return e[t.name]=t.value,e}),t.htmlAttributes),(0,o.default)(e.querySelectorAll("meta")).reduce((function(e,t){return e[t.name]=t.content,e}),t.htmlAttributes),s.htmlFirstLevelChildTags=[],null==e||e.body.normalize();for(var f=0;f<(null==e?void 0:e.body.childNodes.length);f++){var p=null==e?void 0:e.body.childNodes.item(f);if(p.nodeType!=Node.TEXT_NODE||(null===(l=p.nodeValue)||void 0===l?void 0:l.replace(/(\r\n|\r|\n)/gm,"").trim())){var v=(0,r.default)(p);p.nodeType!=Node.COMMENT_NODE&&s.htmlFirstLevelChildTags.push(v)}}i(e,(function(t){null==e||e.head.appendChild(t),u.additionalGlobalStyleNodes.push(t)}));var h=d.indexOf("\x3c!--StartFragment--\x3e"),g=d.lastIndexOf("\x3c!--EndFragment--\x3e");h>=0&&g>=h+20&&(t.htmlBefore=d.substr(0,h),t.htmlAfter=d.substr(g+18),s.html=d.substring(h+20,g),e.body.innerHTML=n(s.html),i(e.body,(function(e){var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)})))}}},5216:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(623),o=n(8488);t.default=function(e,t){var n=e.fragment,i=new o.default(e.sanitizingOption);i.convertGlobalCssToInlineCss(n),i.sanitize(n,t?(0,r.default)(t.element):void 0)}},7676:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8655),o=n(7070),i=n(1306),a=n(8153),l=n(7229),s=function(){function e(e,t){this.rootNode=e,this.startNode=(0,r.default)(e,t)?t:null}return e.prototype.getStartBlockElement=function(){return this.startNode?(0,o.default)(this.rootNode,this.startNode):(0,i.default)(this.rootNode,!0)},e.prototype.getStartInlineElement=function(){return this.startNode?(0,a.default)(this.rootNode,this.startNode):(0,l.getFirstInlineElement)(this.rootNode)},e.prototype.isBlockInScope=function(e){return(0,r.default)(this.rootNode,e.getStartNode())},e.prototype.trimInlineElement=function(e){return e},e}();t.default=s},6754:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7676),o=n(8251),i=n(7070),a=n(8153),l=n(5269),s=n(9984),u=n(3526),d=n(2571),c=n(2513),f=function(){function e(e,t){this.scoper=e,this.skipTags=t,this.currentInline=null,this.currentBlock=null}return e.createBodyTraverser=function(t,n,o){return new e(new r.default(t,n))},e.createSelectionTraverser=function(t,n,r){return new e(new u.default(t,n),r)},e.createBlockTraverser=function(t,n,r,o){return void 0===r&&(r=3),new e(new s.default(t,n,r))},Object.defineProperty(e.prototype,"currentBlockElement",{get:function(){return this.currentBlock||(this.currentBlock=this.scoper.getStartBlockElement()),this.currentBlock},enumerable:!1,configurable:!0}),e.prototype.getNextBlockElement=function(){return this.getPreviousNextBlockElement(!0)},e.prototype.getPreviousBlockElement=function(){return this.getPreviousNextBlockElement(!1)},e.prototype.getPreviousNextBlockElement=function(e){var t=this.currentBlockElement;if(!t)return null;var n=(0,c.getLeafSibling)(this.scoper.rootNode,e?t.getEndNode():t.getStartNode(),e,this.skipTags),r=n?(0,i.default)(this.scoper.rootNode,n):null;return r&&this.scoper.isBlockInScope(r)&&(e&&r.isAfter(t)||!e&&t.isAfter(r))?(this.currentBlock=r,this.currentBlock):null},Object.defineProperty(e.prototype,"currentInlineElement",{get:function(){return this.currentInline||(this.currentInline=this.scoper.getStartInlineElement()),this.currentInline instanceof o.default?null:this.currentInline},enumerable:!1,configurable:!0}),e.prototype.getNextInlineElement=function(){return this.getPreviousNextInlineElement(!0)},e.prototype.getPreviousInlineElement=function(){return this.getPreviousNextInlineElement(!1)},e.prototype.getPreviousNextInlineElement=function(e){var t,n=this.currentInlineElement||this.currentInline;return n?(n instanceof o.default?(t=(0,d.getInlineElementBeforeAfter)(this.scoper.rootNode,n.getStartPosition(),e))&&!n.getParentBlock().contains(t.getContainerNode())&&(t=null):(t=function(e,t,n){if(!t)return null;if(t instanceof l.default){var r=n?t.nextInlineElement:t.previousInlineElement;if(r)return r}var o=t.getContainerNode();return o=(0,c.getLeafSibling)(e,o,n),(0,a.default)(e,o)}(this.scoper.rootNode,n,e),t=t&&n&&(e&&t.isAfter(n)||!e&&n.isAfter(t))?t:null),t&&(t=this.scoper.trimInlineElement(t))?(this.currentInline=t,this.currentInline):null):null},e}();t.default=f},6091:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6754),o=n(8831),i=/[\s\u00A0\u200B\u3000]+([^\s\u00A0\u200B\u3000]*)$/i,a=function(){function e(e,t){this.rootNode=e,this.position=t,this.text="",this.word="",this.inlineBefore=null,this.inlineAfter=null,this.traverser=null,this.traversingComplete=!1,this.inlineElements=[],this.nearestNonTextInlineElement=null}return e.prototype.getWordBefore=function(){var e=this;return this.word||this.traverse((function(){return e.word})),this.word||""},e.prototype.getInlineElementBefore=function(){return this.inlineBefore||this.traverse(null),this.inlineBefore},e.prototype.getInlineElementAfter=function(){return this.inlineAfter||(this.inlineAfter=r.default.createBlockTraverser(this.rootNode,this.position).currentInlineElement),this.inlineAfter},e.prototype.getSubStringBefore=function(e){var t=this;return this.text.length<e&&this.traverse((function(){return t.text.length>=e})),this.text.substr(Math.max(0,this.text.length-e))},e.prototype.getRangeFromText=function(e,t){if(!e)return null;var n=null,r=null,i=e.length-1;return this.forEachTextInlineElement((function(o){for(var a=o.getTextContent()||"",l=a.length-1;l>=0&&i>=0;l--)if(e.charCodeAt(i)==a.charCodeAt(l))i--,r||(r=o.getStartPosition().move(l+1));else if(t||r)return!0;return-1==i&&(n=o.getStartPosition().move(l+1),!0)})),n&&r&&(0,o.default)(n,r)},e.prototype.forEachTextInlineElement=function(e){this.inlineElements.some(e)||this.traverse(e)},e.prototype.getNearestNonTextInlineElement=function(){var e=this;return this.nearestNonTextInlineElement||this.traverse((function(){return e.nearestNonTextInlineElement})),this.nearestNonTextInlineElement},e.prototype.traverse=function(e){if(this.traverser=this.traverser||r.default.createBlockTraverser(this.rootNode,this.position),this.traverser&&!this.traversingComplete)for(var t=this.traverser.getPreviousInlineElement();!this.traversingComplete;){if(this.inlineBefore=this.inlineBefore||t,!t||!t.isTextualInlineElement()){this.nearestNonTextInlineElement=t,this.traversingComplete=!0,this.word||(this.word=this.text);break}var n=t.getTextContent();if(!this.word){var o=i.exec(n);o&&2==o.length&&(this.word=o[1]+this.text)}if(this.text=n+this.text,this.inlineElements.push(t),e&&e(t))break;t=this.traverser.getPreviousInlineElement()}},e}();t.default=a},9984:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8251),o=n(7070),i=n(8153),a=n(8715),l=n(4630),s=n(5924),u=n(2571),d=n(7229),c=function(){function e(e,t,n){this.rootNode=e,this.startFrom=n,(0,s.default)(t,"Range")&&(t=l.default.getStart(t)),this.position=t.normalize(),this.block=(0,o.default)(this.rootNode,this.position.node)}return e.prototype.getStartBlockElement=function(){return this.block},e.prototype.getStartInlineElement=function(){if(this.block)switch(this.startFrom){case 0:case 1:case 2:return function(e,t){if(e instanceof a.default){var n=e.getStartNode();return t?(0,d.getFirstInlineElement)(n):(0,d.getLastInlineElement)(n)}return(0,i.default)(e,t?e.getStartNode():e.getEndNode())}(this.block,0==this.startFrom);case 3:var e=(0,u.getInlineElementAfter)(this.rootNode,this.position);return e&&this.block.contains(e.getContainerNode())?e:new r.default(this.position,this.block)}return null},e.prototype.isBlockInScope=function(e){return!(!this.block||!e)&&this.block.equals(e)},e.prototype.trimInlineElement=function(e){return this.block&&e&&this.block.contains(e.getContainerNode())?e:null},e}();t.default=c},3526:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7070),o=n(5269),i=n(4630),a=n(2571),l=function(){function e(e,t){this.rootNode=e,this.startBlock=null,this.startInline=null,this.start=i.default.getStart(t).normalize(),this.end=i.default.getEnd(t).normalize()}return e.prototype.getStartBlockElement=function(){return this.startBlock||(this.startBlock=(0,r.default)(this.rootNode,this.start.node)),this.startBlock},e.prototype.getStartInlineElement=function(){return this.startInline||(this.startInline=this.trimInlineElement((0,a.getInlineElementAfter)(this.rootNode,this.start))),this.startInline},e.prototype.isBlockInScope=function(e){if(!e)return!1;var t=!1,n=this.getStartBlockElement();if(this.start.equalTo(this.end))t=!!n&&n.equals(e);else{var o=(0,r.default)(this.rootNode,this.end.node);t=!!n&&!!o&&(e.equals(n)||e.equals(o)||e.isAfter(n)&&o.isAfter(e))}return t},e.prototype.trimInlineElement=function(e){if(!e||this.start.equalTo(this.end))return null;var t=e.getStartPosition(),n=e.getEndPosition();if(t.isAfter(this.end)||this.start.isAfter(n))return null;var r=!1,i=!1;return this.start.isAfter(t)&&(t=this.start,r=!0),n.isAfter(this.end)&&(n=this.end,i=!0),t.isAfter(n)||t.equalTo(n)?null:r||i?new o.default(e,r?t:void 0,i?n:void 0):e},e}();t.default=l},8937:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addDelimiterBefore=t.addDelimiterAfter=void 0;var r=n(7582),o=n(6935),i=n(3765),a="​";function l(e){return d(e,"entityDelimiterAfter")}function s(e){return d(e,"entityDelimiterBefore")}function u(e,t){return e&&(0,i.default)(e)&&e.classList.contains(t)?e:void 0}function d(e,t){var n=(0,o.default)({tag:"span",className:t,children:[a]},e.ownerDocument);if(n){var r="entityDelimiterAfter"==t?"afterend":"beforebegin";e.insertAdjacentElement(r,n)}return n}t.default=function(e){var t,n,o,i,a=(0,r.__read)((n=[],o=(t=e).nextElementSibling,i=t.previousElementSibling,n.push(u(o,"entityDelimiterAfter"),u(i,"entityDelimiterBefore")),n),2),d=a[0],c=a[1];return d||(d=l(e)),c||(c=s(e)),[d,c]},t.addDelimiterAfter=l,t.addDelimiterBefore=s},3765:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5924);t.default=function(e){return e&&(0,r.default)(e,"HTMLSpanElement")&&(e.classList.contains("entityDelimiterAfter")||e.classList.contains("entityDelimiterBefore"))&&"​"===e.textContent?e:null}},2738:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4984),o=n(8655),i=n(6754),a=n(8831),l=n(3598),s=n(7070),u=n(3408),d=n(1657),c=n(1431),f=n(8235),p=n(5672),v=n(1473),h=n(4731),g=n(4630),m=n(6091),y=n(8471),b=n(7409),E=n(8375),C=n(82),S=n(4251),T=n(9381),P="[contenteditable=false]",_=[function(e,t,n,r){var i,l,u=(0,s.default)(e,n.node);if(u){var c=(0,y.default)(e,"a[href]",null,1,(0,a.default)(n)).filter((function(e){return u.contains(e)}))[0];if(c&&(0,d.default)(c)&&(n=new g.default(c,-2),w(c),c=null),c&&(null===(i=t)||void 0===i?void 0:i.querySelector)&&(null===(l=t)||void 0===l?void 0:l.querySelector("a[href]"))){var f=n.normalize(),p=f.node.parentNode,v=3==f.node.nodeType?(0,b.default)(f.node,f.offset,!1):f.isAtEnd?f.node.nextSibling:f.node,h=e.ownerDocument.createTextNode("");for(p.insertBefore(h,v);h&&(0,o.default)(c,h);)h=(0,T.splitBalancedNodeRange)(h);h&&(n=new g.default(h,-2),w(h))}}return n},function(e,t,n,r){var o=t,i=!1;if(11==o.nodeType){i=!0;var a=(0,E.default)(o.childNodes).filter((function(e){return"BR"!=(0,u.default)(e)}));o=1==a.length?a[0]:null}var s=(0,u.default)(o),d=s&&o&&"BR"==(0,u.default)(o.nextSibling),f=(0,l.default)(n.node,e,"LI"),p=f&&(0,l.default)(f,e,"OL,UL"),m=(0,l.default)(n.node,e,"TD,TH");if("LI"==s&&(s=p?(0,u.default)(p):"UL",o=(0,S.default)(o,s)),("OL"==s||"UL"==s)&&o&&"LI"==(0,u.default)(o.firstChild)){var y=!o.firstChild.nextSibling&&!d;d&&o.parentNode&&w(o.nextSibling),y?((0,C.default)(o.firstChild),(0,C.default)(o)):(0,u.default)(p)==s&&((0,C.default)(o),n=new g.default(f,(0,c.default)(n,f)?-2:-3))}return i&&"TABLE"==s&&m&&((0,h.default)(m,o,n,r),n=new g.default(o,0),(0,v.default)(t)),n},function(e,t,n,o){if("P"==(0,u.default)(n.node)){var i=n.normalize(),a=(0,r.default)(n.node,"div");i.node!=a&&(n=i)}return n},function(e,t,n,r){return(0,f.default)(n.node)&&(n=new g.default(n.node,n.isAtEnd?-3:-2)),n},function(e,t,n,r){if(r&&r.collapsed){var o=new m.default(e,g.default.getStart(r)),i=o.getInlineElementBefore(),a=o.getInlineElementAfter();i instanceof p.default?n=new g.default(i.getContainerNode(),-3):a instanceof p.default&&(n=new g.default(a.getContainerNode(),-2))}return n},function e(t,n,r,o){var i;if(!(null===(i=r.element)||void 0===i?void 0:i.isContentEditable)){for(var a=void 0,s=(0,l.default)(r.node,t,P);s;)s=(null==(a=s)?void 0:a.parentElement)?(0,l.default)(a.parentElement,t,P):null;if(a)return e(t,n,r=new g.default(a,-3),o)}return r},function(e,t,n,r){if(1==t.childNodes.length&&"TABLE"==(0,u.default)(t.childNodes[0])||"TABLE"==(0,u.default)(t)){var o=n.element,s=new g.default(o,-2),d=(0,a.default)(s,n),c=i.default.createSelectionTraverser(e,d),f=c&&c.currentBlockElement;if(f){for(var p=f;!p;)(p=c.getNextBlockElement())&&(f=p);var v=null==f?void 0:f.getEndNode();if(v&&(0,l.default)(v,e,"TABLE")){var h=(0,a.default)(n);h.collapse(!1);var m=e.ownerDocument.createElement("br");h.insertNode(m),h=(0,a.default)(m),n=g.default.getEnd(h)}}}return n}];function w(e){var t;null===(t=null==e?void 0:e.parentNode)||void 0===t||t.removeChild(e)}t.default=function(e,t,n,r){return _.forEach((function(o){n=o(e,t,n,r)})),n}},3030:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7582),o=n(8605),i=n(6688),a=n(8394),l=n(4539),s=n(2799),u=n(4630),d=n(8471),c=n(5924),f=n(7409);function p(e,t,n){var r,o;if((0,c.default)(e,"Text")){var i=(0,f.default)(e,t,n);return n?[i,e]:[e,i]}var a=e.childNodes[t-1],l=e.childNodes[t];if(a||l||(n?a=(l=e).previousSibling:l=(a=e).nextSibling),(a||l)&&(!a||!l)){var s=e.ownerDocument.createTextNode("");null===(o=null===(r=a||l)||void 0===r?void 0:r.parentNode)||void 0===o||o.insertBefore(s,l),a?l=s:a=s}return[a,l]}t.default=function(e,t){var n=null,f=(0,d.default)(e,"table,tr",null,2,t),v=(0,a.default)(e,t,0).map((function(e){var t=(0,l.default)(e);if(!t)return null;var a=t.startContainer,s=t.endContainer,u=t.startOffset,d=t.endOffset,v=t.commonAncestorContainer;if((0,c.default)(v,"HTMLElement")&&!v.isContentEditable)return null;var h=(0,r.__read)(p(s,d,!1),2),g=h[0],m=h[1],y=(0,r.__read)(p(a,u,!0),2),b=y[0],E=y[1];n=n||b;var C=(0,i.default)(e,[E,g]);return(0,o.default)(f,C),{region:e,beforeStart:b,afterEnd:m}})).filter((function(e){return!!e}));return f.forEach((function(e){var t;return(null===(t=e.parentElement)||void 0===t?void 0:t.isContentEditable)&&e.parentElement.removeChild(e)})),v.forEach((function(e){e&&(0,s.default)(e.region,e.beforeStart,e.afterEnd)})),n&&new u.default(n,-1)}},8606:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6754);t.default=function(e){for(var t=r.default.createBodyTraverser(e),n=t&&t.currentBlockElement,o=[];n;)o.push(n.getTextContent()),n=t.getNextBlockElement();return o.join("\n")}},8839:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="contenteditable";t.default=function(e,t,r,o){e&&(e.className="_Entity _EType_"+t+" "+(o?"_EId_"+o+" ":"")+"_EReadonly_"+(r?"1":"0"),r?e.contentEditable="false":e.getAttribute(n)&&e.removeAttribute(n))}},3032:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.restoreContentWithEntityPlaceholder=t.moveContentWithEntityPlaceholders=t.createEntityPlaceholder=void 0;var r=n(3726),o=n(4965),i=n(5924);function a(e,t){for(var n;e&&(!t||e!=t);){var r=e;e=e.nextSibling,null===(n=r.parentNode)||void 0===n||n.removeChild(r)}return e}function l(e,t){var n,o=(0,i.default)(t,"HTMLElement")&&t.classList.contains("_Entity")&&(null===(n=(0,r.default)(t))||void 0===n?void 0:n.id),a=o?null==e?void 0:e[o]:null;return a?(0,i.default)(a,"HTMLElement")?a:(null==a?void 0:a.canPersist)?a.element:null:null}function s(e,t){return t[e.id]=e.wrapper,e.wrapper.cloneNode(!0)}t.createEntityPlaceholder=function(e){var t=e.wrapper.ownerDocument.createElement("ENTITY-PLACEHOLDER");return t.id=e.id,t},t.moveContentWithEntityPlaceholders=function(e,t){for(var n=(0,o.default)(),a=e.ownerDocument.createDocumentFragment(),l=null,u=function(e){var o,u=e;l=e.nextSibling,(0,i.default)(e,"HTMLElement")&&((o=(0,r.default)(e))?u=s(o,t):e.querySelectorAll(n).forEach((function(e){var n;if(o=(0,r.default)(e)){var i=s(o,t);null===(n=e.parentNode)||void 0===n||n.replaceChild(i,e)}}))),a.appendChild(u)},d=e.firstChild;d;d=l)u(d);return a.normalize(),a},t.restoreContentWithEntityPlaceholder=function(e,t,n,r){for(var s=t.firstChild,u=(0,o.default)(),d=e.firstChild;d;){var c=d.nextSibling,f=l(n,d);if(f)(s=a(s,f))?s=s.nextSibling:t.appendChild(f);else{var p=r?d.cloneNode(!0):d;t.insertBefore(p,s),(0,i.default)(p,"HTMLElement")&&p.querySelectorAll(u).forEach((function(e){var t,r=l(n,e);r&&(null===(t=e.parentNode)||void 0===t||t.replaceChild(r,e))}))}d=c}a(s)}},3726:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,n=!1,r="",o="",i=!1;return null===(t=null==e?void 0:e.className)||void 0===t||t.split(" ").forEach((function(e){"_Entity"==e?n=!0:0==e.indexOf("_EType_")?r=e.substr(7):0==e.indexOf("_EId_")?o=e.substr(5):0==e.indexOf("_EReadonly_")&&(i="1"==e.substr(11))})),n?{wrapper:e,id:o,type:r,isReadonly:i}:null}},4965:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return"._Entity"+(e?"._EType_"+e:"")+(t?"._EId_"+t:"")}},996:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var r=e&&e.eventDataCache&&e.eventDataCache.hasOwnProperty(t)?e.eventDataCache[t]:n();return e&&(e.eventDataCache=e.eventDataCache||{},e.eventDataCache[t]=r),r}},2924:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e&&e.eventDataCache&&(t&&e.eventDataCache.hasOwnProperty(t)?delete e.eventDataCache[t]:t||(e.eventDataCache={}))}},7254:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1045);t.default=function(e){return!(0,r.default)(e)&&!!e.key&&1==e.key.length}},5188:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(246).Browser.isMac?function(e){return e.metaKey}:function(e){return e.ctrlKey};t.default=function(e){return r(e)}},1045:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.ctrlKey||"Control"===e.key,n=e.altKey||"Alt"===e.key,r=e.metaKey||"Meta"===e.key;return t||n||r}},8488:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7582),o=n(4984),i=n(623),a=n(4709),l=n(4869),s=n(359),u=n(3408),d=n(5924),c=n(6092),f=n(8375),p=n(9420),v=n(5097),h=n(2374),g=function(){function e(e){e=e||{},this.elementCallbacks=(0,p.cloneObject)(e.elementCallbacks),this.styleCallbacks=(0,h.getStyleCallbacks)(e.cssStyleCallbacks),this.attributeCallbacks=(0,p.cloneObject)(e.attributeCallbacks),this.tagReplacements=(0,h.getTagReplacement)(e.additionalTagReplacements),this.allowedAttributes=(0,h.getAllowedAttributes)(e.additionalAllowedAttributes),this.allowedCssClassesRegex=(0,h.getAllowedCssClassesRegex)(e.additionalAllowedCssClasses),this.defaultStyleValues=(0,h.getDefaultStyleValues)(e.additionalDefaultStyleValues),this.additionalPredefinedCssForElement=e.additionalPredefinedCssForElement||null,this.additionalGlobalStyleNodes=e.additionalGlobalStyleNodes||[],this.preserveHtmlComments=e.preserveHtmlComments||!1,this.unknownTagReplacement=e.unknownTagReplacement||null}return e.convertInlineCss=function(t,n){return new e({additionalGlobalStyleNodes:n}).exec(t,!0)},e.sanitizeHtml=function(t,n){var r=new e(n=n||{}),o=(0,d.default)(n.currentElementOrStyle,"HTMLElement")?(0,i.default)(n.currentElementOrStyle):n.currentElementOrStyle;return r.exec(t,n.convertCssOnly,o)},e.prototype.exec=function(e,t,n){var r=(new DOMParser).parseFromString(e||"","text/html");return r&&r.body&&r.body.firstChild&&(this.convertGlobalCssToInlineCss(r),t||this.sanitize(r.body,n)),r&&r.body&&r.body.innerHTML||""},e.prototype.sanitize=function(e,t){if(!e)return"";t=(0,p.cloneObject)(t,(0,i.default)(null)),this.processNode(e,t,{})},e.prototype.convertGlobalCssToInlineCss=function(e){var t,n,o=(0,f.default)(e.querySelectorAll("style")),i=this.additionalGlobalStyleNodes.reverse().map((function(e){return e.sheet})).concat(o.map((function(e){return e.sheet})).reverse()).filter((function(e){return e}));try{for(var a=(0,r.__values)(i),l=a.next();!l.done;l=a.next())for(var s=l.value,u=function(t){var n,o,i=s.cssRules[t],a=i&&i.style?i.style.cssText:null;if(i.type!=CSSRule.STYLE_RULE||!a||!i.selectorText)return"continue";try{for(var l=(n=void 0,(0,r.__values)(i.selectorText.split(","))),u=l.next();!u.done;u=l.next()){var d=u.value;!d||!d.trim()||d.indexOf(":")>=0||(0,f.default)(e.querySelectorAll(d)).forEach((function(e){return e.setAttribute("style",a+(e.getAttribute("style")||""))}))}}catch(e){n={error:e}}finally{try{u&&!u.done&&(o=l.return)&&o.call(l)}finally{if(n)throw n.error}}},d=s.cssRules.length-1;d>=0;d--)u(d)}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}o.forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)}))},e.prototype.processNode=function(e,t,n){var r,i=e.nodeType,a=1==i,l=3==i,s=11==i,d=8==i,c=!1;if(a){var f=(0,u.default)(e),v=this.elementCallbacks[f],h=this.tagReplacements[f.toLowerCase()];void 0===h&&(h=this.unknownTagReplacement),v?c=v(e,n):f.indexOf(":")>0||f==h||"*"==h?c=!0:h&&/^[a-zA-Z][\w\-]*$/.test(h)&&(e=(0,o.default)(e,h),c=!0)}else if(l){var g=t["white-space"];c="pre"==g||"pre-line"==g||"pre-wrap"==g||!/^[\r\n]*$/g.test(e.nodeValue||"")}else c=!!s||!!d&&this.preserveHtmlComments;if(c)if(!l||"pre"!=t["white-space"]&&"pre-wrap"!=t["white-space"]){if(a||s){var m=(0,p.cloneObject)(t),y=e;a&&(this.processAttributes(y,n),this.preprocessCss(y,m),this.processCss(y,m,n));for(var b=y.firstChild,E=void 0;b;b=E)E=b.nextSibling,this.processNode(b,m,n)}}else e.nodeValue=(e.nodeValue||"").replace(/^ /gm," ").replace(/ {2}/g,"  ");else null===(r=e.parentNode)||void 0===r||r.removeChild(e)},e.prototype.preprocessCss=function(e,t){var n=(0,l.default)(e,this.additionalPredefinedCssForElement);n&&(0,a.default)(n).forEach((function(e){t[e]=n[e]}))},e.prototype.processCss=function(e,t,n){var r=this,o=(0,s.default)(e);(0,a.default)(o).forEach((function(i){var a=o[i],l=r.styleCallbacks[i],s=null!=t[i],u=!0;u&&l&&(u=l(a,e,t,n)),u&&(0,v.isCssVariable)(a)&&(u=!!(a=(0,v.processCssVariable)(a))),(u=u&&"inherit"!=a&&a.indexOf("expression")<0&&"-"!=i.substr(0,1)&&r.defaultStyleValues[i]!=a&&(s&&a!=t[i]||!s&&"initial"!=a&&"normal"!=a))&&s&&(t[i]=a),u?o[i]=a:delete o[i]})),(0,c.default)(e,o)},e.prototype.processAttributes=function(e,t){for(var n=e.attributes.length-1;n>=0;n--){var r=e.attributes[n],o=r.name.toLowerCase().trim(),i=r.value,a=this.attributeCallbacks[o],l=a?a(i,e,t):this.allowedAttributes.indexOf(o)>=0||0==o.indexOf("data-")?i:null;"class"==o&&this.allowedCssClassesRegex&&(l=this.processCssClass(i,l)),null==l||l.match(/s\n*c\n*r\n*i\n*p\n*t\n*:/i)?e.removeAttribute(o):r.value=l}},e.prototype.processCssClass=function(e,t){var n=this,r=e?e.split(" "):[],o=t?t.split(" "):[];return r.forEach((function(e){var t;(null===(t=n.allowedCssClassesRegex)||void 0===t?void 0:t.test(e))&&o.indexOf(e)<0&&o.push(e)})),(null==o?void 0:o.length)>0?o.join(" "):null},e}();t.default=g},585:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7582);t.default=function(e,t,n){if(e[t]){var o=e[t];e[t]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.apply(void 0,(0,r.__spreadArray)([],(0,r.__read)(e),!1)),n.apply(void 0,(0,r.__spreadArray)([],(0,r.__read)(e),!1))}}else e[t]=n}},9420:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cloneObject=void 0;var r=n(7582),o=n(4709),i=Object.assign?function(e,t){return Object.assign(t||{},e)}:function(e,t){var n,i,a=t||{};if(e)try{for(var l=(0,r.__values)((0,o.default)(e)),s=l.next();!s.done;s=l.next()){var u=s.value;a[u]=e[u]}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}return a};t.cloneObject=function(e,t){return i(e,t)}},4834:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return{elementCallbacks:{},attributeCallbacks:{},cssStyleCallbacks:{},additionalTagReplacements:{},additionalAllowedAttributes:[],additionalAllowedCssClasses:[],additionalDefaultStyleValues:{},additionalGlobalStyleNodes:[],additionalPredefinedCssForElement:{},preserveHtmlComments:!1,unknownTagReplacement:null}}},2374:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStyleCallbacks=t.getDefaultStyleValues=t.getAllowedCssClassesRegex=t.getAllowedAttributes=t.getTagReplacement=void 0;var r=n(7582),o=n(4709),i=n(9420),a={a:"*",abbr:"*",address:"*",area:"*",article:"*",aside:"*",b:"*",bdi:"*",bdo:"*",blockquote:"*",body:"*",br:"*",button:"*",canvas:"*",caption:"*",center:"*",cite:"*",code:"*",col:"*",colgroup:"*",data:"*",datalist:"*",dd:"*",del:"*",details:"*",dfn:"*",dialog:"*",dir:"*",div:"*",dl:"*",dt:"*",em:"*",fieldset:"*",figcaption:"*",figure:"*",font:"*",footer:"*",h1:"*",h2:"*",h3:"*",h4:"*",h5:"*",h6:"*",head:"*",header:"*",hgroup:"*",hr:"*",html:"*",i:"*",img:"*",input:"*",ins:"*",kbd:"*",label:"*",legend:"*",li:"*",main:"*",map:"*",mark:"*",menu:"*",menuitem:"*",meter:"*",nav:"*",ol:"*",optgroup:"*",option:"*",output:"*",p:"*",picture:"*",pre:"*",progress:"*",q:"*",rp:"*",rt:"*",ruby:"*",s:"*",samp:"*",section:"*",select:"*",small:"*",span:"*",strike:"*",strong:"*",sub:"*",summary:"*",sup:"*",table:"*",tbody:"*",td:"*",textarea:"*",tfoot:"*",th:"*",thead:"*",time:"*",tr:"*",tt:"*",u:"*",ul:"*",var:"*",wbr:"*",xmp:"*",form:"SPAN",applet:null,audio:null,base:null,basefont:null,embed:null,frame:null,frameset:null,iframe:null,link:null,meta:null,noscript:null,object:null,param:null,script:null,slot:null,source:null,style:null,template:null,title:null,track:null,video:null},l="accept,align,alt,checked,cite,color,cols,colspan,contextmenu,coords,datetime,default,dir,dirname,disabled,download,face,headers,height,hidden,high,href,hreflang,ismap,kind,label,lang,list,low,max,maxlength,media,min,multiple,open,optimum,pattern,placeholder,readonly,rel,required,reversed,rows,rowspan,scope,selected,shape,size,sizes,span,spellcheck,src,srclang,srcset,start,step,style,tabindex,target,title,translate,type,usemap,valign,value,width,wrap,bgColor".split(","),s={"background-color":"transparent","border-bottom-color":"rgb(0, 0, 0)","border-bottom-style":"none","border-bottom-width":"0px","border-image-outset":"0","border-image-repeat":"stretch","border-image-slice":"100%","border-image-source":"none","border-image-width":"1","border-left-color":"rgb(0, 0, 0)","border-left-style":"none","border-left-width":"0px","border-right-color":"rgb(0, 0, 0)","border-right-style":"none","border-right-width":"0px","border-top-color":"rgb(0, 0, 0)","border-top-style":"none","border-top-width":"0px","outline-color":"transparent","outline-style":"none","outline-width":"0px",overflow:"visible","-webkit-text-stroke-width":"0px","word-wrap":"break-word","margin-left":"0px","margin-right":"0px",padding:"0px","padding-top":"0px","padding-left":"0px","padding-right":"0px","padding-bottom":"0px",border:"0px","border-top":"0px","border-left":"0px","border-right":"0px","border-bottom":"0px","vertical-align":"baseline",float:"none"},u=[];function d(){return null}function c(e,t){var n=t.tagName;return!("LI"==n||"DIV"==n)}t.getTagReplacement=function(e){var t=(0,r.__assign)({},a),n=e||{};return(0,o.default)(n).forEach((function(e){e&&(t[e.toLowerCase()]=n[e])})),t},t.getAllowedAttributes=function(e){return(t=l.concat(e||[]),t.filter((function(e,t,n){return n.indexOf(e)==t}))).map((function(e){return e.toLocaleLowerCase()}));var t},t.getAllowedCssClassesRegex=function(e){var t=u.concat(e||[]);return t.length>0?new RegExp(t.join("|")):null},t.getDefaultStyleValues=function(e){var t=(0,i.cloneObject)(s);return e&&Object.keys(e).forEach((function(n){var r=e[n];null!=r?t[n]=r:delete t[n]})),t},t.getStyleCallbacks=function(e){var t=(0,i.cloneObject)(e);return t.position=t.position||d,t.width=t.width||c,t}},623:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="border-spacing,caption-side,color,cursor,direction,empty-cells,font-family,font-size,font-style,font-variant,font-weight,font,letter-spacing,line-height,list-style-image,list-style-position,list-style-type,list-style,orphans,quotes,text-align,text-indent,text-transform,visibility,white-space,widows,word-spacing".split(",");t.default=function(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView,r=t&&e&&t.getComputedStyle(e),o={};return n.forEach((function(e){return o[e]=r&&r.getPropertyValue(e)||""})),o}},4869:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3408),o={B:{"font-weight":"bold"},EM:{"font-style":"italic"},I:{"font-style":"italic"},U:{"text-decoration":"underline"},P:{"margin-top":"1em","margin-bottom":"1em"},PRE:{"white-space":"pre"},S:{"text-decoration":"line-through"},STRIKE:{"text-decoration":"line-through"},SUB:{"vertical-align":"sub","font-size":"smaller"},SUP:{"vertical-align":"super","font-size":"smaller"}};t.default=function(e,t){var n=(0,r.default)(e);return o[n]||(t||{})[n]}},5097:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCssVariable=t.processCssVariable=void 0;var n=/^\s*var\(\s*[a-zA-Z0-9-_]+\s*(,\s*(.*))?\)\s*$/;t.processCssVariable=function(e){var t=n.exec(e);return(null==t?void 0:t[2])||""},t.isCssVariable=function(e){return 0==e.indexOf("var(")}},6344:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeRect=t.splitTextNode=t.getLastLeafNode=t.getFirstLeafNode=t.getPreviousLeafSibling=t.getNextLeafSibling=t.wrap=t.unwrap=t.splitBalancedNodeRange=t.splitParentNode=t.queryElements=t.matchLink=t.isVoidHtmlElement=t.isNodeEmpty=t.isBlockElement=t.getTagOfNode=t.PendableFormatCommandMap=t.getPendableFormatState=t.getComputedStyle=t.getComputedStyles=t.fromHtml=t.findClosestElementAncestor=t.contains=t.collapseNodes=t.changeElementTag=t.applyFormat=t.getBrowserInfo=t.Browser=t.getPasteType=t.sanitizePasteContent=t.retrieveMetadataFromClipboard=t.handleTextPaste=t.handleImagePaste=t.extractClipboardItemsForIE=t.extractClipboardItems=t.extractClipboardEvent=t.applyTextStyle=t.PartialInlineElement=t.NodeInlineElement=t.LinkInlineElement=t.ImageInlineElement=t.getInlineElementAtNode=t.getDelimiterFromElement=t.addDelimiterBefore=t.addDelimiterAfter=t.addDelimiters=t.PositionContentSearcher=t.ContentTraverser=t.getFirstLastBlockElement=t.getBlockElementAtNode=void 0,t.getInheritableStyles=t.HtmlSanitizer=t.canUndoAutoComplete=t.createSnapshots=t.moveCurrentSnapsnot=t.moveCurrentSnapshot=t.clearProceedingSnapshotsV2=t.clearProceedingSnapshots=t.canMoveCurrentSnapshot=t.addSnapshotV2=t.addSnapshot=t.addRangeToSelection=t.extractContentMetadata=t.setHtmlWithMetadata=t.setHtmlWithSelectionPath=t.getHtmlWithSelectionPath=t.getSelectionPath=t.isPositionAtBeginningOf=t.getPositionRect=t.createRange=t.Position=t.mergeBlocksInRegion=t.getSelectionRangeInRegion=t.isNodeInRegion=t.collapseNodesInRegion=t.getSelectedBlockElementsInRegion=t.getRegionsFromRange=t.getTableCellMetadata=t.saveTableCellMetadata=t.getTableFormatInfo=t.setListItemStyle=t.convertDecimalsToRoman=t.convertDecimalsToAlpha=t.VListChain=t.createVListFromRegion=t.VListItem=t.VList=t.isWholeTableSelected=t.VTable=t.parseColor=t.isNodeAfter=t.getIntersectedRect=t.moveChildNodes=t.KnownCreateElementData=t.createElement=t.matchesSelector=t.setColor=t.getInnerHTML=t.readFile=t.safeInstanceOf=void 0,t.getPasteSource=t.toArray=t.getObjectKeys=t.arrayPush=t.removeMetadata=t.setMetadata=t.getMetadata=t.createObjectDefinition=t.createArrayDefinition=t.createStringDefinition=t.createBooleanDefinition=t.createNumberDefinition=t.validate=t.getTextContent=t.deleteSelectedContent=t.adjustInsertPosition=t.removeGlobalCssStyle=t.setGlobalCssStyles=t.removeImportantStyleRule=t.setStyles=t.getStyles=t.isCtrlOrMetaPressed=t.isCharacterValue=t.isModifierKey=t.clearEventDataCache=t.cacheGetEventData=t.restoreContentWithEntityPlaceholder=t.moveContentWithEntityPlaceholders=t.createEntityPlaceholder=t.getEntitySelector=t.getEntityFromElement=t.commitEntity=t.chainSanitizerCallback=t.createDefaultHtmlSanitizerOptions=void 0;var r=n(7070);Object.defineProperty(t,"getBlockElementAtNode",{enumerable:!0,get:function(){return r.default}});var o=n(1306);Object.defineProperty(t,"getFirstLastBlockElement",{enumerable:!0,get:function(){return o.default}});var i=n(6754);Object.defineProperty(t,"ContentTraverser",{enumerable:!0,get:function(){return i.default}});var a=n(6091);Object.defineProperty(t,"PositionContentSearcher",{enumerable:!0,get:function(){return a.default}});var l=n(8937);Object.defineProperty(t,"addDelimiters",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"addDelimiterAfter",{enumerable:!0,get:function(){return l.addDelimiterAfter}}),Object.defineProperty(t,"addDelimiterBefore",{enumerable:!0,get:function(){return l.addDelimiterBefore}});var s=n(3765);Object.defineProperty(t,"getDelimiterFromElement",{enumerable:!0,get:function(){return s.default}});var u=n(8153);Object.defineProperty(t,"getInlineElementAtNode",{enumerable:!0,get:function(){return u.default}});var d=n(271);Object.defineProperty(t,"ImageInlineElement",{enumerable:!0,get:function(){return d.default}});var c=n(5672);Object.defineProperty(t,"LinkInlineElement",{enumerable:!0,get:function(){return c.default}});var f=n(8797);Object.defineProperty(t,"NodeInlineElement",{enumerable:!0,get:function(){return f.default}});var p=n(5269);Object.defineProperty(t,"PartialInlineElement",{enumerable:!0,get:function(){return p.default}});var v=n(140);Object.defineProperty(t,"applyTextStyle",{enumerable:!0,get:function(){return v.default}});var h=n(1545);Object.defineProperty(t,"extractClipboardEvent",{enumerable:!0,get:function(){return h.default}});var g=n(3877);Object.defineProperty(t,"extractClipboardItems",{enumerable:!0,get:function(){return g.default}});var m=n(6960);Object.defineProperty(t,"extractClipboardItemsForIE",{enumerable:!0,get:function(){return m.default}});var y=n(8736);Object.defineProperty(t,"handleImagePaste",{enumerable:!0,get:function(){return y.default}});var b=n(2543);Object.defineProperty(t,"handleTextPaste",{enumerable:!0,get:function(){return b.default}});var E=n(5673);Object.defineProperty(t,"retrieveMetadataFromClipboard",{enumerable:!0,get:function(){return E.default}});var C=n(5216);Object.defineProperty(t,"sanitizePasteContent",{enumerable:!0,get:function(){return C.default}});var S=n(351);Object.defineProperty(t,"getPasteType",{enumerable:!0,get:function(){return S.default}});var T=n(246);Object.defineProperty(t,"Browser",{enumerable:!0,get:function(){return T.Browser}}),Object.defineProperty(t,"getBrowserInfo",{enumerable:!0,get:function(){return T.getBrowserInfo}});var P=n(5400);Object.defineProperty(t,"applyFormat",{enumerable:!0,get:function(){return P.default}});var _=n(4984);Object.defineProperty(t,"changeElementTag",{enumerable:!0,get:function(){return _.default}});var w=n(8053);Object.defineProperty(t,"collapseNodes",{enumerable:!0,get:function(){return w.default}});var O=n(8655);Object.defineProperty(t,"contains",{enumerable:!0,get:function(){return O.default}});var M=n(3598);Object.defineProperty(t,"findClosestElementAncestor",{enumerable:!0,get:function(){return M.default}});var D=n(5023);Object.defineProperty(t,"fromHtml",{enumerable:!0,get:function(){return D.default}});var A=n(7695);Object.defineProperty(t,"getComputedStyles",{enumerable:!0,get:function(){return A.default}}),Object.defineProperty(t,"getComputedStyle",{enumerable:!0,get:function(){return A.getComputedStyle}});var L=n(3764);Object.defineProperty(t,"getPendableFormatState",{enumerable:!0,get:function(){return L.default}}),Object.defineProperty(t,"PendableFormatCommandMap",{enumerable:!0,get:function(){return L.PendableFormatCommandMap}});var R=n(3408);Object.defineProperty(t,"getTagOfNode",{enumerable:!0,get:function(){return R.default}});var I=n(5499);Object.defineProperty(t,"isBlockElement",{enumerable:!0,get:function(){return I.default}});var N=n(1657);Object.defineProperty(t,"isNodeEmpty",{enumerable:!0,get:function(){return N.default}});var x=n(8235);Object.defineProperty(t,"isVoidHtmlElement",{enumerable:!0,get:function(){return x.default}});var k=n(844);Object.defineProperty(t,"matchLink",{enumerable:!0,get:function(){return k.default}});var j=n(8471);Object.defineProperty(t,"queryElements",{enumerable:!0,get:function(){return j.default}});var B=n(9381);Object.defineProperty(t,"splitParentNode",{enumerable:!0,get:function(){return B.default}}),Object.defineProperty(t,"splitBalancedNodeRange",{enumerable:!0,get:function(){return B.splitBalancedNodeRange}});var F=n(82);Object.defineProperty(t,"unwrap",{enumerable:!0,get:function(){return F.default}});var H=n(4251);Object.defineProperty(t,"wrap",{enumerable:!0,get:function(){return H.default}});var z=n(2513);Object.defineProperty(t,"getNextLeafSibling",{enumerable:!0,get:function(){return z.getNextLeafSibling}}),Object.defineProperty(t,"getPreviousLeafSibling",{enumerable:!0,get:function(){return z.getPreviousLeafSibling}});var U=n(4061);Object.defineProperty(t,"getFirstLeafNode",{enumerable:!0,get:function(){return U.getFirstLeafNode}}),Object.defineProperty(t,"getLastLeafNode",{enumerable:!0,get:function(){return U.getLastLeafNode}});var K=n(7409);Object.defineProperty(t,"splitTextNode",{enumerable:!0,get:function(){return K.default}});var W=n(5203);Object.defineProperty(t,"normalizeRect",{enumerable:!0,get:function(){return W.default}});var V=n(5924);Object.defineProperty(t,"safeInstanceOf",{enumerable:!0,get:function(){return V.default}});var G=n(3126);Object.defineProperty(t,"readFile",{enumerable:!0,get:function(){return G.default}});var q=n(4746);Object.defineProperty(t,"getInnerHTML",{enumerable:!0,get:function(){return q.default}});var Z=n(7727);Object.defineProperty(t,"setColor",{enumerable:!0,get:function(){return Z.default}});var Y=n(5010);Object.defineProperty(t,"matchesSelector",{enumerable:!0,get:function(){return Y.default}});var X=n(6935);Object.defineProperty(t,"createElement",{enumerable:!0,get:function(){return X.default}}),Object.defineProperty(t,"KnownCreateElementData",{enumerable:!0,get:function(){return X.KnownCreateElementData}});var Q=n(1473);Object.defineProperty(t,"moveChildNodes",{enumerable:!0,get:function(){return Q.default}});var $=n(3798);Object.defineProperty(t,"getIntersectedRect",{enumerable:!0,get:function(){return $.default}});var J=n(6997);Object.defineProperty(t,"isNodeAfter",{enumerable:!0,get:function(){return J.default}});var ee=n(8121);Object.defineProperty(t,"parseColor",{enumerable:!0,get:function(){return ee.default}});var te=n(8094);Object.defineProperty(t,"VTable",{enumerable:!0,get:function(){return te.default}});var ne=n(8570);Object.defineProperty(t,"isWholeTableSelected",{enumerable:!0,get:function(){return ne.default}});var re=n(64);Object.defineProperty(t,"VList",{enumerable:!0,get:function(){return re.default}});var oe=n(711);Object.defineProperty(t,"VListItem",{enumerable:!0,get:function(){return oe.default}});var ie=n(7909);Object.defineProperty(t,"createVListFromRegion",{enumerable:!0,get:function(){return ie.default}});var ae=n(4327);Object.defineProperty(t,"VListChain",{enumerable:!0,get:function(){return ae.default}});var le=n(6692);Object.defineProperty(t,"convertDecimalsToAlpha",{enumerable:!0,get:function(){return le.default}});var se=n(4321);Object.defineProperty(t,"convertDecimalsToRoman",{enumerable:!0,get:function(){return se.default}});var ue=n(3339);Object.defineProperty(t,"setListItemStyle",{enumerable:!0,get:function(){return ue.default}});var de=n(4711);Object.defineProperty(t,"getTableFormatInfo",{enumerable:!0,get:function(){return de.getTableFormatInfo}});var ce=n(3606);Object.defineProperty(t,"saveTableCellMetadata",{enumerable:!0,get:function(){return ce.saveTableCellMetadata}});var fe=n(3606);Object.defineProperty(t,"getTableCellMetadata",{enumerable:!0,get:function(){return fe.getTableCellMetadata}});var pe=n(8394);Object.defineProperty(t,"getRegionsFromRange",{enumerable:!0,get:function(){return pe.default}});var ve=n(531);Object.defineProperty(t,"getSelectedBlockElementsInRegion",{enumerable:!0,get:function(){return ve.default}});var he=n(6688);Object.defineProperty(t,"collapseNodesInRegion",{enumerable:!0,get:function(){return he.default}});var ge=n(4794);Object.defineProperty(t,"isNodeInRegion",{enumerable:!0,get:function(){return ge.default}});var me=n(4539);Object.defineProperty(t,"getSelectionRangeInRegion",{enumerable:!0,get:function(){return me.default}});var ye=n(2799);Object.defineProperty(t,"mergeBlocksInRegion",{enumerable:!0,get:function(){return ye.default}});var be=n(4630);Object.defineProperty(t,"Position",{enumerable:!0,get:function(){return be.default}});var Ee=n(8831);Object.defineProperty(t,"createRange",{enumerable:!0,get:function(){return Ee.default}});var Ce=n(5473);Object.defineProperty(t,"getPositionRect",{enumerable:!0,get:function(){return Ce.default}});var Se=n(1431);Object.defineProperty(t,"isPositionAtBeginningOf",{enumerable:!0,get:function(){return Se.default}});var Te=n(8805);Object.defineProperty(t,"getSelectionPath",{enumerable:!0,get:function(){return Te.default}});var Pe=n(9372);Object.defineProperty(t,"getHtmlWithSelectionPath",{enumerable:!0,get:function(){return Pe.default}});var _e=n(4477);Object.defineProperty(t,"setHtmlWithSelectionPath",{enumerable:!0,get:function(){return _e.default}}),Object.defineProperty(t,"setHtmlWithMetadata",{enumerable:!0,get:function(){return _e.setHtmlWithMetadata}}),Object.defineProperty(t,"extractContentMetadata",{enumerable:!0,get:function(){return _e.extractContentMetadata}});var we=n(5537);Object.defineProperty(t,"addRangeToSelection",{enumerable:!0,get:function(){return we.default}});var Oe=n(3680);Object.defineProperty(t,"addSnapshot",{enumerable:!0,get:function(){return Oe.default}}),Object.defineProperty(t,"addSnapshotV2",{enumerable:!0,get:function(){return Oe.addSnapshotV2}});var Me=n(3205);Object.defineProperty(t,"canMoveCurrentSnapshot",{enumerable:!0,get:function(){return Me.default}});var De=n(5892);Object.defineProperty(t,"clearProceedingSnapshots",{enumerable:!0,get:function(){return De.default}}),Object.defineProperty(t,"clearProceedingSnapshotsV2",{enumerable:!0,get:function(){return De.clearProceedingSnapshotsV2}});var Ae=n(5105);Object.defineProperty(t,"moveCurrentSnapshot",{enumerable:!0,get:function(){return Ae.default}}),Object.defineProperty(t,"moveCurrentSnapsnot",{enumerable:!0,get:function(){return Ae.moveCurrentSnapsnot}});var Le=n(7424);Object.defineProperty(t,"createSnapshots",{enumerable:!0,get:function(){return Le.default}});var Re=n(6687);Object.defineProperty(t,"canUndoAutoComplete",{enumerable:!0,get:function(){return Re.default}});var Ie=n(8488);Object.defineProperty(t,"HtmlSanitizer",{enumerable:!0,get:function(){return Ie.default}});var Ne=n(623);Object.defineProperty(t,"getInheritableStyles",{enumerable:!0,get:function(){return Ne.default}});var xe=n(4834);Object.defineProperty(t,"createDefaultHtmlSanitizerOptions",{enumerable:!0,get:function(){return xe.default}});var ke=n(585);Object.defineProperty(t,"chainSanitizerCallback",{enumerable:!0,get:function(){return ke.default}});var je=n(8839);Object.defineProperty(t,"commitEntity",{enumerable:!0,get:function(){return je.default}});var Be=n(3726);Object.defineProperty(t,"getEntityFromElement",{enumerable:!0,get:function(){return Be.default}});var Fe=n(4965);Object.defineProperty(t,"getEntitySelector",{enumerable:!0,get:function(){return Fe.default}});var He=n(3032);Object.defineProperty(t,"createEntityPlaceholder",{enumerable:!0,get:function(){return He.createEntityPlaceholder}}),Object.defineProperty(t,"moveContentWithEntityPlaceholders",{enumerable:!0,get:function(){return He.moveContentWithEntityPlaceholders}}),Object.defineProperty(t,"restoreContentWithEntityPlaceholder",{enumerable:!0,get:function(){return He.restoreContentWithEntityPlaceholder}});var ze=n(996);Object.defineProperty(t,"cacheGetEventData",{enumerable:!0,get:function(){return ze.default}});var Ue=n(2924);Object.defineProperty(t,"clearEventDataCache",{enumerable:!0,get:function(){return Ue.default}});var Ke=n(1045);Object.defineProperty(t,"isModifierKey",{enumerable:!0,get:function(){return Ke.default}});var We=n(7254);Object.defineProperty(t,"isCharacterValue",{enumerable:!0,get:function(){return We.default}});var Ve=n(5188);Object.defineProperty(t,"isCtrlOrMetaPressed",{enumerable:!0,get:function(){return Ve.default}});var Ge=n(359);Object.defineProperty(t,"getStyles",{enumerable:!0,get:function(){return Ge.default}});var qe=n(6092);Object.defineProperty(t,"setStyles",{enumerable:!0,get:function(){return qe.default}});var Ze=n(9130);Object.defineProperty(t,"removeImportantStyleRule",{enumerable:!0,get:function(){return Ze.default}});var Ye=n(8182);Object.defineProperty(t,"setGlobalCssStyles",{enumerable:!0,get:function(){return Ye.default}});var Xe=n(4136);Object.defineProperty(t,"removeGlobalCssStyle",{enumerable:!0,get:function(){return Xe.default}});var Qe=n(2738);Object.defineProperty(t,"adjustInsertPosition",{enumerable:!0,get:function(){return Qe.default}});var $e=n(3030);Object.defineProperty(t,"deleteSelectedContent",{enumerable:!0,get:function(){return $e.default}});var Je=n(8606);Object.defineProperty(t,"getTextContent",{enumerable:!0,get:function(){return Je.default}});var et=n(2373);Object.defineProperty(t,"validate",{enumerable:!0,get:function(){return et.default}});var tt=n(681);Object.defineProperty(t,"createNumberDefinition",{enumerable:!0,get:function(){return tt.createNumberDefinition}}),Object.defineProperty(t,"createBooleanDefinition",{enumerable:!0,get:function(){return tt.createBooleanDefinition}}),Object.defineProperty(t,"createStringDefinition",{enumerable:!0,get:function(){return tt.createStringDefinition}}),Object.defineProperty(t,"createArrayDefinition",{enumerable:!0,get:function(){return tt.createArrayDefinition}}),Object.defineProperty(t,"createObjectDefinition",{enumerable:!0,get:function(){return tt.createObjectDefinition}});var nt=n(7570);Object.defineProperty(t,"getMetadata",{enumerable:!0,get:function(){return nt.getMetadata}}),Object.defineProperty(t,"setMetadata",{enumerable:!0,get:function(){return nt.setMetadata}}),Object.defineProperty(t,"removeMetadata",{enumerable:!0,get:function(){return nt.removeMetadata}});var rt=n(8605);Object.defineProperty(t,"arrayPush",{enumerable:!0,get:function(){return rt.default}});var ot=n(4709);Object.defineProperty(t,"getObjectKeys",{enumerable:!0,get:function(){return ot.default}});var it=n(8375);Object.defineProperty(t,"toArray",{enumerable:!0,get:function(){return it.default}});var at=n(6433);Object.defineProperty(t,"getPasteSource",{enumerable:!0,get:function(){return at.default}})},8251:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.position=e,this.parentBlock=t}return e.prototype.getTextContent=function(){return""},e.prototype.getContainerNode=function(){return this.position.node},e.prototype.getParentBlock=function(){return this.parentBlock},e.prototype.getStartPosition=function(){return this.position},e.prototype.getEndPosition=function(){return this.position},e.prototype.isAfter=function(e){return e&&this.position.isAfter(e.getEndPosition())},e.prototype.isTextualInlineElement=function(){return!1},e.prototype.contains=function(e){return!1},e.prototype.applyStyle=function(e){},e}();t.default=n},271:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7582),o=function(e){function t(t,n){return e.call(this,t,n)||this}return(0,r.__extends)(t,e),t}(n(8797).default);t.default=o},5672:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7582),o=function(e){function t(t,n){return e.call(this,t,n)||this}return(0,r.__extends)(t,e),t}(n(8797).default);t.default=o},8797:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(140),o=n(6997),i=n(4630),a=function(){function e(e,t){this.containerNode=e,this.parentBlock=t}return e.prototype.getTextContent=function(){return(3==this.containerNode.nodeType?this.containerNode.nodeValue:this.containerNode.textContent)||""},e.prototype.getContainerNode=function(){return this.containerNode},e.prototype.getParentBlock=function(){return this.parentBlock},e.prototype.getStartPosition=function(){return new i.default(this.containerNode,0).normalize()},e.prototype.getEndPosition=function(){return new i.default(this.containerNode,-1).normalize()},e.prototype.isTextualInlineElement=function(){return this.containerNode&&3==this.containerNode.nodeType},e.prototype.isAfter=function(e){return e&&(0,o.default)(this.containerNode,e.getContainerNode())},e.prototype.contains=function(e){var t=this.getStartPosition(),n=this.getEndPosition();return e&&e.isAfter(t)&&n.isAfter(e)},e.prototype.applyStyle=function(e){(0,r.default)(this.containerNode,e)},e}();t.default=a},5269:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(140),o=n(8831),i=n(4630),a=n(2513),l=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this.inlineElement=e,this.start=t,this.end=n}return e.prototype.getDecoratedInline=function(){return this.inlineElement},e.prototype.getContainerNode=function(){return this.inlineElement.getContainerNode()},e.prototype.getParentBlock=function(){return this.inlineElement.getParentBlock()},e.prototype.getTextContent=function(){return(0,o.default)(this.getStartPosition(),this.getEndPosition()).toString()},e.prototype.getStartPosition=function(){return this.start||this.inlineElement.getStartPosition()},e.prototype.getEndPosition=function(){return this.end||this.inlineElement.getEndPosition()},Object.defineProperty(e.prototype,"nextInlineElement",{get:function(){return this.end?new e(this.inlineElement,this.end):null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousInlineElement",{get:function(){return this.start?new e(this.inlineElement,void 0,this.start):null},enumerable:!1,configurable:!0}),e.prototype.contains=function(e){return e&&e.isAfter(this.getStartPosition())&&this.getEndPosition().isAfter(e)},e.prototype.isTextualInlineElement=function(){return this.inlineElement&&this.inlineElement.isTextualInlineElement()},e.prototype.isAfter=function(e){var t=this.getStartPosition(),n=e&&e.getEndPosition();return n&&(t.isAfter(n)||t.equalTo(n))},e.prototype.applyStyle=function(e){var t=this.getStartPosition().normalize(),n=this.getEndPosition().normalize(),o=this.getContainerNode();if(t.isAtEnd){var l=(0,a.getNextLeafSibling)(o,t.node);t=l?new i.default(l,0):null}if(0==n.offset){var s=(0,a.getPreviousLeafSibling)(o,n.node);n=s?new i.default(s,-1):null}(0,r.default)(o,e,t||void 0,n||void 0)},e}();t.default=l},140:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3408),o=n(4630),i=n(5924),a=n(7409),l=n(4251),s=n(2513),u=n(9381),d="SPAN,B,I,U,EM,STRONG,STRIKE,S,SMALL,SUP,SUB".split(",");function c(e,t){e&&1==e.nodeType&&t(e,!0)}t.default=function(e,t,n,f){void 0===n&&(n=new o.default(e,0).normalize()),void 0===f&&(f=new o.default(e,-1).normalize());for(var p=[],v=n,h=f;v&&h&&h.isAfter(v);){var g=v.node,m=(0,r.default)(g.parentNode),y=(0,s.getNextLeafSibling)(e,g);3==g.nodeType&&["TR","TABLE"].indexOf(m)<0&&(g!=h.node||h.isAtEnd||(g=(0,a.default)(g,h.offset,!0)),v.offset>0&&(g=(0,a.default)(g,v.offset,!1)),p.push(g)),v=y&&new o.default(y,0)}if(p.length>0){if(p.every((function(e){return e.parentNode==p[0].parentNode}))){var b=p.shift();p.forEach((function(e){var t,n=(b.nodeValue||"")+(e.nodeValue||"");b.nodeValue=n,null===(t=e.parentNode)||void 0===t||t.removeChild(e)})),p=[b]}p.forEach((function(e){for(var n=e;n&&"SPAN"!=(0,r.default)(n)&&d.indexOf((0,r.default)(n.parentNode))>=0;)c(n,t),n=(0,u.splitBalancedNodeRange)(n);n&&"SPAN"!=(0,r.default)(n)&&(c(n,t),n=(0,l.default)(n,"SPAN")),(0,i.default)(n,"HTMLElement")&&t(n)}))}}},7229:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLastInlineElement=t.getFirstInlineElement=void 0;var r=n(8153),o=n(4061);t.getFirstInlineElement=function(e){var t=(0,o.getFirstLeafNode)(e);return t?(0,r.default)(e,t):null},t.getLastInlineElement=function(e){var t=(0,o.getLastLeafNode)(e);return t?(0,r.default)(e,t):null}},8153:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7070),o=n(3408),i=n(271),a=n(5672),l=n(8797),s=n(5924);t.default=function(e,t){var n=(0,s.default)(e,"Node")?(0,r.default)(e,t):e;return t&&n&&function(e,t){for(var n,r=[e],s=e.parentNode;s&&t.contains(s);s=s.parentNode)r.push(s);for(var u=r.length-1;u>=0&&!n;u--){var d=r[u],c=(0,o.default)(d);"A"==c?n=new a.default(d,t):"IMG"==c&&(n=new i.default(d,t))}return n||new l.default(e,t)}(t,n)}},2571:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getInlineElementBeforeAfter=t.getInlineElementAfter=t.getInlineElementBefore=void 0;var r=n(8153),o=n(5269),i=n(1630),a=n(2513);function l(e,t,n){if(!e||!t||!t.node)return null;var l=(t=t.normalize()).offset,s=t.isAtEnd,u=t.node,d=!1;!n&&0==l&&!s||n&&s?u=(0,a.getLeafSibling)(e,u,n):3==u.nodeType&&(!n&&!s||n&&l>0)&&(d=!0),u&&(0,i.default)(u)&&(u=(0,a.getLeafSibling)(e,u,n));var c=(0,r.default)(e,u);return c&&(d||c.contains(t))&&(c=n?new o.default(c,t,void 0):new o.default(c,void 0,t)),c}t.getInlineElementBefore=function(e,t){return l(e,t,!1)},t.getInlineElementAfter=function(e,t){return l(e,t,!0)},t.getInlineElementBeforeAfter=l},8605:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){Array.prototype.push.apply(e,t)}},4709:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return Object.keys(e)}},8375:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return[].slice.call(e)}},64:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7582),o=n(4984),i=n(2042),a=n(3408),l=n(5499),s=n(1657),u=n(4630),d=n(8471),c=n(5924),f=n(9381),p=n(8375),v=n(82),h=n(711),g=n(4251),m=n(7570),y=function(){function e(e){if(this.rootList=e,this.items=[],!e)throw new Error("rootList must not be null");b(this.rootList),(0,d.default)(this.rootList,"ol,ul",b),(0,d.default)(this.rootList,"li",E),this.populateItems(this.rootList)}return e.prototype.contains=function(e){return this.items.some((function(t){return t.contains(e)}))},e.prototype.getLastItemNumber=function(){var e=this.getStart();return void 0===e?e:e-1+this.items.filter((function(e){return 1==e.getListType()&&1==e.getLevel()&&!e.isDummy()})).length},e.prototype.writeBack=function(e,t){var n=this;if(!this.rootList)throw new Error("rootList must not be null");var r,o=this.rootList.ownerDocument,i=[o.createDocumentFragment()],a=o.createTextNode(""),l=this.getStart()||1;this.rootList.parentNode.replaceChild(a,this.rootList),this.items.forEach((function(o){var a=o.getNewListStart();a&&a!=l&&(i.splice(1,i.length-1),l=a),o.writeBack(i,n.rootList,e);var s=i[1];o.applyListStyle(n.rootList,l),(0,c.default)(s,"HTMLOListElement")&&(r!=s&&(1==l?s.removeAttribute("start"):s.start=l),1!=o.getLevel()||o.isDummy()||t||l++),r=s})),a.parentNode.replaceChild(i[0],a)},e.prototype.split=function(e,t){if(!this.rootList)throw new Error("rootList must not be null");for(var n=0;n<this.items.length;n++)if(this.items[n].getNode()==e)return void this.items[n].setNewListStart(t)},e.prototype.setIndentation=function(e,t,n,r,o){var i=this;void 0===o&&(o=!1);var a=!1;if(this.findListItems(e,t,(function(e){a=a||0==i.items.indexOf(e),1==n?r&&!e.isDummy()?e.setIsDummy(!0):e.outdent(o):e.indent()})),a&&o)for(var l=0;l<this.items.length;l++)this.items[l].addNegativeMargins()},e.prototype.setAlignment=function(e,t,n){this.rootList.style.display="flex",this.rootList.style.flexDirection="column",this.findListItems(e,t,(function(e){var t="start";1==n?t="center":2==n&&(t="end"),e.getNode().style.alignSelf=t}))},e.prototype.removeMargins=function(){this.rootList.style.marginTop||this.rootList.style.marginBottom||(this.rootList.style.marginTop="0px",this.rootList.style.marginBottom="0px")},e.prototype.changeListType=function(e,t,n){var r=!1;this.findListItems(e,t,(function(e){r=r||e.getListType()!=n})),this.findListItems(e,t,(function(e){return r?e.changeListType(n):e.outdent()}))},e.prototype.setListStyleType=function(e,t){var n=function(e,t,n){return{orderedStyleType:C(t,null==e?void 0:e.orderedStyleType,1),unorderedStyleType:C(n,null==e?void 0:e.unorderedStyleType,1)}}((0,m.getMetadata)(this.rootList,h.ListStyleDefinitionMetadata),e,t);(0,m.setMetadata)(this.rootList,n,h.ListStyleDefinitionMetadata)},e.prototype.appendItem=function(e,t){var n=(0,a.default)(e);"DIV"==n?e=(0,o.default)(e,"LI"):"LI"!=n&&(e=(0,g.default)(e,"LI")),this.items.push(0==t?new h.default(e):new h.default(e,t))},e.prototype.mergeVList=function(e){var t,n=this;e&&e!=this&&(e.items.forEach((function(e){return n.items.push(e)})),e.items.splice(0,e.items.length),null===(t=e.rootList.parentNode)||void 0===t||t.removeChild(e.rootList))},e.prototype.getListItemIndex=function(e){if(this.items)for(var t=(this.getStart()||1)-1,n=0;n<this.items.length;n++){var r=this.items[n];if(1!=r.getLevel()||r.isDummy()||t++,r.getNode()==e)return t}return-1},e.prototype.getStart=function(){return(0,c.default)(this.rootList,"HTMLOListElement")?this.rootList.start:void 0},e.prototype.findListItems=function(e,t,n){if(0==this.items.length)return[];var r=new u.default(this.items[0].getNode(),0),o=new u.default(this.items[this.items.length-1].getNode(),-1),i=r.isAfter(e)?0:-1,a=this.items.length-(t.isAfter(o)?1:0);this.items.forEach((function(n,r){i=n.contains(e.node)?r:i,a=n.contains(t.node)?r:a})),i=a<this.items.length?Math.max(0,i):i,a=i>=0?Math.min(this.items.length-1,a):a;var l=i<=a?this.items.slice(i,a+1):[];return n&&l.forEach(n),l},e.prototype.populateItems=function(e,t){var n=this;void 0===t&&(t=[]);var o=(0,i.default)(e);(0,p.default)(e.childNodes).forEach((function(e){var a=(0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(t),!1),[o],!1);(0,i.isListElement)(e)?n.populateItems(e,a):3==e.nodeType&&""==(e.nodeValue||"").trim()||n.items.push(new(h.default.bind.apply(h.default,(0,r.__spreadArray)([void 0,e],(0,r.__read)(a),!1))))}))},e}();function b(e){var t=null;(0,p.default)(e.childNodes).forEach((function(e){"LI"==(0,a.default)(e)?t=e:(0,i.isListElement)(e)?t=null:t&&!(0,s.default)(e,!0)&&t.appendChild((0,l.default)(e)?e:(0,g.default)(e))}))}function E(e){for(;!(0,i.isListElement)(e.parentNode);){(0,f.default)(e,!0);var t=(0,p.default)(e.parentNode.childNodes).slice(1);t.length>0&&((0,l.default)(t[0])||(t=[(0,g.default)(t)]),t.forEach((function(t){return e.appendChild(t)}))),(0,v.default)(e.parentNode)}}function C(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.filter((function(e){return void 0!==e}))[0]}t.default=y},4327:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8605),o=n(6133),i=n(6997),a=n(4794),l=n(8471),s=n(64),u="listchain",d="listchainafter",c=0,f=function(){function e(e,t){this.region=e,this.name=t,this.lastNumber=0,this.lastNumberBeforeCursor=0}return e.createListChains=function(t,n,a){var s=Array.isArray(t)?t:t?[t]:[],u=[];return s.forEach((function(t){var s,d=[];(0,l.default)(t.rootNode,"ol",(function(r){var l=(0,o.default)(t,"ol",r);if(s!=l){var u=d.filter((function(e){return e.canAppendToTail(l)}))[0]||new e(t,(a||p)()),c=d.indexOf(u),f=!!n&&(0,i.default)(l,n);f?c<0&&d.push(u):(c>=0&&d.splice(c,1),d.unshift(u)),u.append(l,f),s=l}})),(0,r.default)(u,d)})),u},e.prototype.canAppendAtCursor=function(e){return e>1&&this.lastNumberBeforeCursor+1==e},e.prototype.createVListAtBlock=function(e,t){if(e&&e.parentNode){var n=e.ownerDocument.createElement("ol");n.start=t,this.applyChainName(n),e.parentNode.insertBefore(n,e);var r=new s.default(n);return r.appendItem(e,0),r}return null},e.prototype.commit=function(e,t){for(var n=this.getLists(),r=0,o=0;o<n.length;o++){var i=n[o];t||(i.start>1?i.start=i.start===r?r+1:i.start:i.start=r+1);var a=new s.default(i);r=a.getLastItemNumber()||0,delete i.dataset[u],delete i.dataset[d],a.writeBack(e)}},e.prototype.canAppendToTail=function(e){return this.lastNumber+1==e.start},e.prototype.append=function(e,t){this.applyChainName(e),this.lastNumber=new s.default(e).getLastItemNumber()||0,t?e.dataset[d]="true":this.lastNumberBeforeCursor=this.lastNumber},e.prototype.applyChainName=function(e){e.dataset[u]=this.name},e.prototype.getLists=function(){var e=this;return(0,l.default)(this.region.rootNode,"ol[data-"+u+"="+this.name+"]").filter((function(t){return(0,a.default)(e.region,t)}))},e}();function p(){return"__List_Chain_"+c++}t.default=f},711:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ListStyleDefinitionMetadata=void 0;var r=n(7582),o=n(8655),i=n(2042),a=n(359),l=n(3408),s=n(5499),u=n(1473),d=n(5924),c=n(3848),f=n(3339),p=n(8275),v=n(6092),h=n(8375),g=n(82),m=n(4251),y=n(681),b=n(7570),E=[null,"lower-alpha","lower-roman"],C=["disc","circle","square"],S="-.25in",T=["font-size","font-family","color"],P=["data-ogsc","data-ogsb","data-ogac","data-ogab"];t.ListStyleDefinitionMetadata=(0,y.createObjectDefinition)({orderedStyleType:(0,y.createNumberDefinition)(!0,void 0,1,20),unorderedStyleType:(0,y.createNumberDefinition)(!0,void 0,1,9)},!0,!0);var _=function(){function e(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(this.newListStart=void 0,!e)throw new Error("node must not be null");this.node=(0,d.default)(e,"HTMLLIElement")?e:(0,m.default)(e,4);var o=this.node.style.display;this.dummy="list-item"!=o&&""!=o,this.listTypes=(0,r.__spreadArray)([0],(0,r.__read)(t),!1)}return e.prototype.getListType=function(){return this.listTypes[this.listTypes.length-1]},e.prototype.getLevel=function(){return this.listTypes.length-1},e.prototype.getNode=function(){return this.node},e.prototype.getNewListStart=function(){return this.newListStart},e.prototype.contains=function(e){return(0,o.default)(this.node,e,!0)},e.prototype.isDummy=function(){return this.dummy},e.prototype.isOrphanItem=function(){return!1},e.prototype.canMerge=function(e){return!(!(null==e?void 0:e.isOrphanItem())||this.listTypes.length!=e.listTypes.length)&&this.listTypes.every((function(t,n){return e.listTypes[n]==t}))},e.prototype.mergeItems=function(e){var t=this;O((null==e?void 0:e.map((function(e){return e.node})))||[],!0,!1).forEach((function(e){return t.node.appendChild(e)}))},e.prototype.indent=function(){if(this.node.style.marginLeft==S)return this.node.style.margin="",void(this.node.style.marginLeft="");var e=this.getListType();0!=e&&this.listTypes.push(e)},e.prototype.outdent=function(e){void 0===e&&(e=!1);var t=e?2:1;this.listTypes.length>t&&this.listTypes.pop()},e.prototype.addNegativeMargins=function(){this.node.style.margin="0in 0in 0in 0.5in",this.node.style.marginLeft=S},e.prototype.changeListType=function(e){0==e?this.listTypes=[e]:(this.outdent(),this.listTypes.push(e))},e.prototype.setIsDummy=function(e){this.dummy=e},e.prototype.setNewListStart=function(e){this.newListStart=e},e.prototype.applyListStyle=function(e,n){var r=(0,b.getMetadata)(e,t.ListStyleDefinitionMetadata),o=this.listTypes.length<3;r&&(o&&2===this.listTypes[1]&&r.unorderedStyleType?(0,c.default)(this.node,r.unorderedStyleType):o&&1===this.listTypes[1]&&r.orderedStyleType?(0,p.default)(this.node,r.orderedStyleType,n):this.node.style.removeProperty("list-style-type"))},e.prototype.writeBack=function(e,t,n){var o,s=this;void 0===n&&(n=!1);var u,c,p=1;if(n){e.length>this.listTypes.length&&e.splice(this.listTypes.length);var y=e.length-1;y===this.listTypes.length-1&&(0,i.default)(e[y])!==this.listTypes[y]&&e.splice(y),p=e.length}else for(;p<e.length;p++)if((0,i.default)(e[p])!==this.listTypes[p]){e.splice(p);break}for(;p<this.listTypes.length;p++){var b=e.length-1,E=w(e[0],this.listTypes[p],p,t);if(e[b].appendChild(E),e.push(E),this.getDeepChildIndex(t)==b){var C=null===(o=this.node.parentElement)||void 0===o?void 0:o.style.listStyleType;C&&(0,l.default)(this.node.parentElement)===(0,l.default)(E)&&(E.style.listStyleType=C)}}if(e[e.length-1].appendChild(this.node),this.node.style.setProperty("display",this.dummy?"block":null),this.listTypes.length>1&&((0,f.default)(this.node,T,!0),(0,f.default)(this.node,P,!1)),this.listTypes.length<=1){var S="LI"==(0,l.default)(this.node),_=S?{"font-family":this.node.style.fontFamily,"font-size":this.node.style.fontSize,color:this.node.style.color}:void 0,M=S?(u=this.node,c=(0,h.default)(u.childNodes),(0,g.default)(u),c):[this.node];if(_)for(var D=function(e){(0,d.default)(M[e],"Text")&&(M[e]=(0,m.default)(M[e],"span"));var t=M[e];if((0,d.default)(t,"HTMLElement")){var n=(0,r.__assign)((0,r.__assign)({},_),(0,a.default)(t));(0,v.default)(t,n),P.forEach((function(e){var n=s.node.getAttribute(e);n&&t.setAttribute(e,n)}))}},A=0;A<M.length;A++)D(A);O(M,!0,!0)}},e.prototype.getDeepChildIndex=function(e){var t=this.node.parentElement;if(e&&t){for(var n=0;t&&t!=e;)n++,t=(null==t?void 0:t.parentElement)||null;return n}return-1},e}();function w(e,n,r,a){var l,s=e.ownerDocument;if(1==r&&a&&n==(0,i.default)(a)?(0,o.default)(e,a)?(l=a.cloneNode(!1)).removeAttribute("id"):((0,u.default)(a),l=a):l=s.createElement(1==n?"ol":"ul"),"0px"==(null==a?void 0:a.style.marginTop)&&"0px"==(null==a?void 0:a.style.marginBottom)&&(l.style.marginTop="0px",l.style.marginBottom="0px"),a&&1==r&&n!=(0,i.default)(a)){var d=(0,b.getMetadata)(a,t.ListStyleDefinitionMetadata);d&&(0,b.setMetadata)(l,d,t.ListStyleDefinitionMetadata)}return 1==n&&r>1&&l.style.setProperty("list-style-type",E[(r-1)%E.length]),2==n&&r>1&&l.style.setProperty("list-style-type",C[(r-1)%C.length]),l}function O(e,t,n){return!(e.length>0)||t&&(0,s.default)(e[0])||n&&(0,s.default)(e[e.length])||(e=[(0,m.default)(e)]),e}t.default=_},6692:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={0:"A",1:"B",2:"C",3:"D",4:"E",5:"F",6:"G",7:"H",8:"I",9:"J",10:"K",11:"L",12:"M",13:"N",14:"O",15:"P",16:"Q",17:"R",18:"S",19:"T",20:"U",21:"V",22:"W",23:"X",24:"Y",25:"Z"};t.default=function(e,t){for(var r="";e>=0;)r=n[e%26]+r,e=Math.floor(e/26)-1;return t?r.toLowerCase():r}},4321:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7582),o=n(4709),i={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1};t.default=function(e,t){var n,a,l="";try{for(var s=(0,r.__values)((0,o.default)(i)),u=s.next();!u.done;u=s.next()){var d=u.value,c=Math.floor(e/i[d]);e-=c*i[d],l+=d.repeat(c)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}return t?l.toLocaleLowerCase():l}},7909:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6935),o=n(6133),i=n(531),a=n(4794),l=n(4630),s=n(5924),u=n(1630),d=n(8375),c=n(64),f=n(4251),p=n(2513),v=n(2042),h="ol,ul";function g(e,t,n){var r=t[n?t.length-1:0];r=(0,p.getLeafSibling)(e.rootNode,r,n,e.skipTags,!0),r=(0,o.default)(e,h,r),(0,a.default)(e,r)&&(0,v.isListElement)(r)&&(n?(0,s.default)(r,"HTMLOListElement")&&1!=r.start||t.push(r):t.unshift(r))}t.default=function(e,t,n){if(!e)return null;var a=[];if(n){var p=(0,o.default)(e,h,n);p&&a.push(p)}else{if((0,i.default)(e,void 0,!0).forEach((function(n){var r=(0,o.default)(e,h,n.getStartNode());r?(a[a.length-1]!=r&&a.push(r),1==a.length&&(0,s.default)(r,"HTMLOListElement")&&r.start>1&&(t=!1)):a.push(n.collapseToSingleElement())})),0==a.length&&!e.rootNode.firstChild){var m=(0,r.default)(1,e.rootNode.ownerDocument);e.rootNode.appendChild(m),a.push(m),e.fullSelectionStart=new l.default(m,0),e.fullSelectionEnd=new l.default(m,-1)}t&&(g(e,a,!1),g(e,a,!0)),a=a.filter((function(e){return!(0,u.default)(e,!0)}))}var y=null;if(a.length>0){var b=a.shift()||null;(y=(0,v.isListElement)(b)?new c.default(b):b?function(e){var t=(0,d.default)(e.childNodes),n=1==t.length?t[0]:(0,f.default)(t,"SPAN"),r=e.ownerDocument.createElement("ol");e.appendChild(r);var o=new c.default(r);return o.appendItem(n,0),o}(b):null)&&a.forEach((function(e){(0,v.isListElement)(e)?y.mergeVList(new c.default(e)):y.appendItem(e,0)}))}return y}},2042:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isListElement=void 0;var r=n(3408);function o(e){switch((0,r.default)(e)){case"OL":return 1;case"UL":return 2;default:return 0}}t.default=o,t.isListElement=function(e){return 0!=o(e)}},6133:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3598);t.default=function(e,t,n){var o=e&&(0,r.default)(n,e.rootNode,t);if(o)for(var i=void 0;i=(0,r.default)(o.parentNode,e.rootNode,t);)o=i;return o}},3848:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=r[t],o=1===t;e.style.listStyleType=o?n:'"'+n+'"'};var r=((n={})[1]="disc",n[3]="∎ ",n[2]="- ",n[5]="➔ ",n[8]="➔ ",n[4]="➢ ",n[6]="➪ ",n[7]="— ",n)},3339:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6754),o=n(3598),i=n(5924);t.default=function(e,t,n){void 0===n&&(n=!0);var a=function(e,t,n){for(var a,l,s=[],u=r.default.createBodyTraverser(e),d=null,c=function(){var r=(null==(d=u.currentInlineElement)?void 0:d.getContainerNode())||null,c=null;r=r?(0,o.default)(r):null;for(var f=function(){var e=r;t.forEach((function(t){var r=n?e.style.getPropertyValue(t):e.getAttribute(t);c||(c={}),r&&!c[t]&&(c[t]=r)})),r=1===(null===(l=null==r?void 0:r.parentNode)||void 0===l?void 0:l.childNodes.length)?r.parentNode:null};r&&r!==e&&(0,i.default)(r,"HTMLElement")&&(0==s.length||((null===(a=r.textContent)||void 0===a?void 0:a.trim().length)||0)>0);)f();c&&s.push(c),u.getNextInlineElement()};u.currentInlineElement!=d;)c();return s}(e,t,n);t.forEach((function(t){var r=a.map((function(e){return void 0!==e[t]?e[t]:""}));r&&(1==r.length||1==new Set(r).size)&&r[0]&&(n?e.style.setProperty(t,r[0]):e.setAttribute(t,r[0]))}))}},8275:(e,t,n)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0});var o,i=n(6692),a=n(4321);!function(e){e[e.Decimal=0]="Decimal",e[e.Roman=1]="Roman",e[e.Alpha=2]="Alpha"}(o||(o={})),t.default=function(e,t,n){var r=l[t],s=r.markerSeparator,u=r.markerSecondSeparator,d=r.markerType,c=r.lowerCase,f=n.toString();d===o.Roman?f=(0,a.default)(n,c):d===o.Alpha&&(f=(0,i.default)(n-1,c));var p=u?u+f+s:f+s;e.style.listStyleType='"'+p+'"'};var l=((r={})[1]={markerType:o.Decimal,markerSeparator:". "},r[2]={markerType:o.Decimal,markerSeparator:"- "},r[3]={markerType:o.Decimal,markerSeparator:") "},r[4]={markerType:o.Decimal,markerSeparator:") ",markerSecondSeparator:"("},r[5]={markerType:o.Alpha,markerSeparator:". ",lowerCase:!0},r[8]={markerType:o.Alpha,markerSeparator:"- ",lowerCase:!0},r[6]={markerType:o.Alpha,markerSeparator:") ",lowerCase:!0},r[7]={markerType:o.Alpha,markerSeparator:") ",markerSecondSeparator:"(",lowerCase:!0},r[9]={markerType:o.Alpha,markerSeparator:". "},r[12]={markerType:o.Alpha,markerSeparator:"- "},r[10]={markerType:o.Alpha,markerSeparator:") "},r[11]={markerType:o.Alpha,markerSeparator:") ",markerSecondSeparator:"("},r[13]={markerType:o.Roman,markerSeparator:". ",lowerCase:!0},r[16]={markerType:o.Roman,markerSeparator:"- ",lowerCase:!0},r[14]={markerType:o.Roman,markerSeparator:") ",lowerCase:!0},r[15]={markerType:o.Roman,markerSeparator:") ",markerSecondSeparator:"(",lowerCase:!0},r[17]={markerType:o.Roman,markerSeparator:". "},r[20]={markerType:o.Roman,markerSeparator:"- "},r[18]={markerType:o.Roman,markerSeparator:") "},r[19]={markerType:o.Roman,markerSeparator:") ",markerSecondSeparator:"("},r)},681:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createObjectDefinition=t.createArrayDefinition=t.createStringDefinition=t.createBooleanDefinition=t.createNumberDefinition=void 0,t.createNumberDefinition=function(e,t,n,r,o){return{type:1,isOptional:e,value:t,maxValue:r,minValue:n,allowNull:o}},t.createBooleanDefinition=function(e,t,n){return{type:0,isOptional:e,value:t,allowNull:n}},t.createStringDefinition=function(e,t,n){return{type:2,isOptional:e,value:t,allowNull:n}},t.createArrayDefinition=function(e,t,n,r,o){return{type:3,isOptional:t,itemDef:e,minLength:n,maxLength:r,allowNull:o}},t.createObjectDefinition=function(e,t,n){return{type:4,isOptional:t,propertyDef:e,allowNull:n}}},7570:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeMetadata=t.setMetadata=t.getMetadata=void 0;var r=n(2373),o="editingInfo";function i(e,t,n){var i,a=e.dataset[o];try{i=a?JSON.parse(a):null}catch(e){}if(void 0!==i){if(!t)return i;if((0,r.default)(i,t))return i}return n||null}t.getMetadata=i,t.setMetadata=function(e,t,n){return!(n&&!(0,r.default)(t,n)||(e.dataset[o]=JSON.stringify(t),0))},t.removeMetadata=function(e,t){if(t){var n=i(e);n&&(delete n[t],e.dataset[o]=JSON.stringify(n))}else delete e.dataset[o]}},2373:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4709);t.default=function e(t,n){var o,i,a=!1;if(n.isOptional&&void 0===t||n.allowNull&&null===t)a=!0;else{if(!n.isOptional&&void 0===t||!n.allowNull&&null===t)return!1;switch(n.type){case 2:a="string"==typeof t&&(void 0===n.value||t===n.value);break;case 1:a="number"==typeof t&&(void 0===n.value||(o=n.value,i=t,Math.abs(o-i)<.001))&&(void 0===n.minValue||t>=n.minValue)&&(void 0===n.maxValue||t<=n.maxValue);break;case 0:a="boolean"==typeof t&&(void 0===n.value||t===n.value);break;case 3:a=Array.isArray(t)&&(void 0===n.minLength||t.length>=n.minLength)&&(void 0===n.maxLength||t.length<=n.maxLength)&&t.every((function(t){return e(t,n.itemDef)}));break;case 4:a="object"==typeof t&&(0,r.default)(n.propertyDef).every((function(r){return e(t[r],n.propertyDef[r])}));break;case 5:a=n.validator(t)}}return a}},2881:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EXCEL_DESKTOP_ATTRIBUTE_NAME=t.PROG_ID_NAME=t.GOOGLE_SHEET_NODE_NAME=void 0,t.GOOGLE_SHEET_NODE_NAME="google-sheets-html-origin",t.PROG_ID_NAME="ProgId",t.EXCEL_DESKTOP_ATTRIBUTE_NAME="xmlns:x"},7477:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n='ul[class^="BulletListStyle"]>.OutlineElement,ol[class^="NumberListStyle"]>.OutlineElement,span.WACImageContainer,'+["TableInsertRowGapBlank","TableColumnResizeHandle","TableCellTopBorderHandle","TableCellLeftBorderHandle","TableHoverColumnHandle","TableHoverRowHandle"].map((function(e){return'table div[class^="'+e+'"]'})).join(",");t.default=function(e){return!!e.fragment.querySelector(n)}},6433:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7477),o=n(2586),i=n(4675),a=n(3810),l=n(7050),s=n(8064),u=n(8773),d=new Map([[0,s.default],[1,o.default],[2,i.default],[3,l.default],[5,r.default],[4,a.default],[7,u.default]]);t.default=function(e,t){var n=e.htmlAttributes,r=e.clipboardData,o=e.fragment,i=null,a={htmlAttributes:n,fragment:o,shouldConvertSingleImage:t,clipboardData:r};return d.forEach((function(e,t){!i&&e(a)&&(i=t)})),null!=i?i:6}},2586:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2881);t.default=function(e){return"urn:schemas-microsoft-com:office:excel"==e.htmlAttributes[r.EXCEL_DESKTOP_ATTRIBUTE_NAME]}},4675:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2881);t.default=function(e){var t=e.htmlAttributes;return"Excel.Sheet"==t[r.PROG_ID_NAME]&&null==t[r.EXCEL_DESKTOP_ATTRIBUTE_NAME]}},3810:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2881);t.default=function(e){return!!e.fragment.querySelector(r.GOOGLE_SHEET_NODE_NAME)}},7050:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2881);t.default=function(e){return"PowerPoint.Slide"==e.htmlAttributes[r.PROG_ID_NAME]}},8064:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2881);t.default=function(e){var t=e.htmlAttributes;return"urn:schemas-microsoft-com:office:word"==t["xmlns:w"]||"Word.Document"==t[r.PROG_ID_NAME]}},8773:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,n=e.shouldConvertSingleImage,r=e.clipboardData;return n&&1==(null===(t=r.htmlFirstLevelChildTags)||void 0===t?void 0:t.length)&&"IMG"==r.htmlFirstLevelChildTags[0]}},6688:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8053),o=n(4794),i=n(5924);t.default=function(e,t){if(!t||0==t.length)return[];var n=(0,i.default)(t[0],"Node")?t:[t[0].getStartNode(),t[t.length-1].getEndNode()],a=(n=n&&n.filter((function(t){return(0,o.default)(e,t)})))[0],l=n[n.length-1];return(0,o.default)(e,a)&&(0,o.default)(e,l)?(0,r.default)(e.rootNode,a,l,!0):[]}},8394:(e,t,n)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.getRegionCreator=void 0;var o=n(7582),i=n(8655),a=n(3598),l=n(4630),s=n(8471),u=n(2513),d=((r={})[0]={skipTags:["TABLE"],outerSelector:"table",innerSelector:"td,th"},r);function c(e,t){var n=l.default.getStart(e).normalize(),r=l.default.getEnd(e).normalize();return function(e,o,a){return function(e,t,n,r){if(e){var o=t&&(0,u.getNextLeafSibling)(e,t,r),a=n&&(0,u.getPreviousLeafSibling)(e,n,r),l=!t||(0,i.default)(e,t)&&(0,i.default)(e,o),s=!n||(0,i.default)(e,n)&&(0,i.default)(e,a),d=!(t&&n&&((0,i.default)(t,n,!0)||(0,i.default)(t,a,!0)||(0,i.default)(n,t,!0)||(0,i.default)(n,o,!0)));return l&&s&&d}return!1}(e,o,a,t)?{rootNode:e,nodeBefore:o,nodeAfter:a,skipTags:t,fullSelectionStart:n,fullSelectionEnd:r}:null}}function f(e,t,n,r,i){var a;i=i||t.innerNode==n;var l=!1,s=t.children,u=t.innerNode,d=[];if(0==s.length)(p=e(u))&&d.push(p);else for(var c=0;c<=s.length&&!l;c++){var p,v=s[c]||{},h=v.outerNode,g=v.boundaries,m=null===(a=s[c-1])||void 0===a?void 0:a.outerNode;i&&(p=e(u,m,h))&&d.push(p),null==g||g.forEach((function(t){var a,s;s=(a=(0,o.__read)(f(e,t,n,r,i),3))[0],i=a[1],l=a[2],d=d.concat(s)}))}return[d,i,l||u==r]}t.default=function(e,t,n){var r=[];if(e&&t){var l=d[n],u=l.innerSelector,p=l.skipTags,v=function(e,t,n){var r=[{innerNode:e,children:[]}],o=d[n],l=o.outerSelector,u=o.innerSelector,c=(0,s.default)(e,l,null,2,t);return(0,s.default)(e,u,(function(t){var n=(0,a.default)(t,e,l);if(n&&c.indexOf(n)<0){for(var o={innerNode:t,children:[]},s=r.length-1;s>=0;s--){var u=r[s],d=u.innerNode,f=u.children;if((0,i.default)(d,n)){var p=f.filter((function(e){return e.outerNode==n}))[0];p||(p={outerNode:n,boundaries:[]},f.push(p)),p.boundaries.push(o);break}}r.push(o)}}),1,t),r[0]}(e,t,n),h=(0,a.default)(t.startContainer,e,u)||e,g=(0,a.default)(t.endContainer,e,u)||e,m=c(t,p);r=(0,o.__read)(f(m,v,h,g),1)[0]}return r.filter((function(e){return!!e}))},t.getRegionCreator=c},531:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6754),o=n(6935),i=n(7070),a=n(4539),l=n(1630);t.default=function(e,t,n){var s=(0,a.default)(e),u=[];if(s){for(var d=e.rootNode,c=e.skipTags,f=r.default.createSelectionTraverser(d,s,c),p=null==f?void 0:f.currentBlockElement;p;p=f.getNextBlockElement())u.push(p);u=u.filter((function(e){var t,n=e.getStartNode();return n!=e.getEndNode()||!(0,l.default)(n,!0)||(null===(t=n.parentNode)||void 0===t||t.removeChild(n),!1)}))}if(0==u.length&&e&&!e.rootNode.firstChild&&t){var v=(0,o.default)(1,e.rootNode.ownerDocument);e.rootNode.appendChild(v),(p=(0,i.default)(e.rootNode,v))&&u.push(p)}return u}},4539:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8831),o=n(4630),i=n(2513);t.default=function(e){if(!e)return null;var t=e.nodeBefore,n=e.nodeAfter,a=e.rootNode,l=e.skipTags,s=t?(0,i.getNextLeafSibling)(e.rootNode,t,e.skipTags):a.firstChild,u=n?(0,i.getPreviousLeafSibling)(a,n,l):a.lastChild,d=s&&u&&(0,r.default)(s,u);if(!function(e){var t=e;return!!t.fullSelectionEnd&&!!t.fullSelectionStart}(e))return d;if(d){var c=o.default.getStart(d).normalize(),f=o.default.getEnd(d).normalize(),p=e.fullSelectionEnd,v=e.fullSelectionStart;if(!v.isAfter(f)&&!c.isAfter(p)){var h=v.isAfter(c)?v:c,g=p.isAfter(f)?f:p;return(0,r.default)(h,g)}}return null}},4794:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8655);t.default=function(e,t){return!(!e||!(0,r.default)(e.rootNode,t)||e.nodeBefore&&4!=e.nodeBefore.compareDocumentPosition(t)||e.nodeAfter&&2!=e.nodeAfter.compareDocumentPosition(t))}},2799:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7582),o=n(4984),i=n(8655),a=n(7070),l=n(4869),s=n(359),u=n(4794),d=n(5924),c=n(6092),f=n(8053);t.default=function(e,t,n){var p,v,h,g;if((0,u.default)(e,t)&&(0,u.default)(e,n)&&(g=(0,a.default)(e.rootNode,n))&&!g.contains(t)){for(var m=g.collapseToSingleElement(),y=(0,f.collapse)(e.rootNode,m,t,!1,!0),b=m;(0,i.default)(y,b);){var E=b.parentNode;if((0,d.default)(E,"HTMLElement")){var C=(0,r.__assign)((0,r.__assign)((0,r.__assign)({},(0,l.default)(E)||{}),(0,s.default)(E)),(0,s.default)(m));(0,c.default)(m,C)}b=E}var S=null,T=1==m.childNodes.length&&0==m.attributes.length?m.firstChild:(0,o.default)(m,"SPAN");for(b=T;(0,i.default)(y,b)&&1==(null===(p=b.parentNode)||void 0===p?void 0:p.childNodes.length);b=b.parentNode)S=b.parentNode;null===(v=t.parentNode)||void 0===v||v.insertBefore(T,t.nextSibling),null===(h=null==S?void 0:S.parentNode)||void 0===h||h.removeChild(S)}}},4630:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3598),o=n(6997),i=function(){function e(e,t,n){switch(void 0===t&&(t=0),this.isFromEndOfRange=n,e.node?(this.node=e.node,t=e.offset):this.node=e,t){case-2:this.offset=a(this.node),this.node=this.node.parentNode,this.isAtEnd=!1;break;case-3:this.offset=a(this.node)+1,this.isAtEnd=!this.node.nextSibling,this.node=this.node.parentNode;break;case-1:this.offset=l(this.node),this.isAtEnd=!0;break;default:var o=l(this.node);this.offset=Math.max(0,Math.min(t,o)),this.isAtEnd=t>0&&t>=o}this.element=(0,r.default)(this.node)}return e.prototype.normalize=function(){if(3==this.node.nodeType||!this.node.firstChild)return this;for(var t=this.node,n=this.isAtEnd?-1:this.offset;1==t.nodeType||11==t.nodeType;){var r=this.isFromEndOfRange?-1==n?t.lastChild:t.childNodes[n-1]:0==n?t.firstChild:-1==n?t.lastChild:t.childNodes[n];if(!r)break;t=r,n=this.isAtEnd||this.isFromEndOfRange?-1:0}return new e(t,n,this.isFromEndOfRange)},e.prototype.equalTo=function(e){return e&&(this==e||this.node==e.node&&this.offset==e.offset&&this.isAtEnd==e.isAtEnd)},e.prototype.isAfter=function(e){return this.node==e.node?this.isAtEnd&&!e.isAtEnd||this.offset>e.offset:(0,o.default)(this.node,e.node)},e.prototype.move=function(t){return new e(this.node,Math.max(this.offset+t,0))},e.getStart=function(t){return new e(t.startContainer,t.startOffset)},e.getEnd=function(t){return t.collapsed?e.getStart(t):new e(t.endContainer,t.endOffset,!0)},e}();function a(e){for(var t=0;e=(null==e?void 0:e.previousSibling)||null;)t++;return t}function l(e){var t;return 3==e.nodeType?(null===(t=e.nodeValue)||void 0===t?void 0:t.length)||0:1==e.nodeType||11==e.nodeType?e.childNodes.length:1}t.default=i},5537:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(246);t.default=function(e,t){var n,o,i,a=null===(i=null===(o=null===(n=null==e?void 0:e.commonAncestorContainer)||void 0===n?void 0:n.ownerDocument)||void 0===o?void 0:o.defaultView)||void 0===i?void 0:i.getSelection();if(a){var l=!0;if(a.rangeCount>0)try{var s=null;(t||r.Browser.isEdge)&&(s=1==a.rangeCount?a.getRangeAt(0):null)&&s.startContainer==e.startContainer&&s.startOffset==e.startOffset&&s.endContainer==e.endContainer&&s.endOffset==e.endOffset?l=!1:a.removeAllRanges()}catch(e){}l&&a.addRange(e)}}},8831:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8235),o=n(4630),i=n(5924);function a(e){return 1==e.node.nodeType&&(0,r.default)(e.node)?new o.default(e.node,e.isAtEnd?-3:-2):e}function l(e){return e&&e.node}function s(e,t){if(!e||!t)return null;for(var n=0,r=0;r<t.length&&(n=t[r],r<t.length-1&&e&&1==e.nodeType&&e.childNodes.length>n);r++)e=e.childNodes[n];return new o.default(e,n)}t.default=function(e,t,n,r){var u,d=null,c=null;if(l(e)?(d=e,c=l(t)?t:null):(0,i.default)(e,"Node")&&(Array.isArray(t)?(d=s(e,t),c=Array.isArray(n)?s(e,n):null):"number"==typeof t?(d=new o.default(e,t),c=(0,i.default)(n,"Node")?new o.default(n,r):null):!(0,i.default)(t,"Node")&&t||(d=new o.default(e,-2),c=new o.default(t||e,-3))),null===(u=null==d?void 0:d.node)||void 0===u?void 0:u.ownerDocument){var f=d.node.ownerDocument.createRange();return d=a(d),c=a(c||d),f.setStart(d.node,d.offset),f.setEnd(c.node,c.offset),f}return null}},9372:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4746),o=n(8805);t.default=function(e,t){if(!e)return"";var n=(0,r.default)(e),i=t&&(0,o.default)(e,t);return i?n+"\x3c!--"+JSON.stringify(i)+"--\x3e":n}},5473:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6935),o=n(8831),i=n(5203);t.default=function(e){var t;if(!e)return null;var n=(0,o.default)(e),a=n.getBoundingClientRect&&(0,i.default)(n.getBoundingClientRect());if(a)return a;e=e.normalize();var l=n.getClientRects&&n.getClientRects();if(a=l&&1==l.length?(0,i.default)(l[0]):null)return a;if(3==e.node.nodeType&&e.node.ownerDocument){var s=(0,r.default)({tag:"span",children:["​"]},e.node.ownerDocument);if((n=(0,o.default)(e)).insertNode(s),a=s.getBoundingClientRect&&(0,i.default)(s.getBoundingClientRect()),null===(t=s.parentNode)||void 0===t||t.removeChild(s),a)return a}var u=e.element;return u&&u.getBoundingClientRect&&(a=(0,i.default)(u.getBoundingClientRect()))?a:null}},8805:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8655),o=n(4630);function i(e,t){var n,o;if(!e||!t)return[];var i,a=e.node,l=e.offset,s=[];if(!(0,r.default)(t,a,!0))return[];if(3==a.nodeType){for(i=a.parentNode;a.previousSibling&&3==a.previousSibling.nodeType;)l+=(null===(n=a.previousSibling.nodeValue)||void 0===n?void 0:n.length)||0,a=a.previousSibling;s.unshift(l)}else i=a,a=a.childNodes[l];do{l=0;for(var u=!1,d=(null==i?void 0:i.firstChild)||null;d&&d!=a;d=d.nextSibling){if(3==d.nodeType){if(0===(null===(o=d.nodeValue)||void 0===o?void 0:o.length)||u)continue;u=!0}else u=!1;l++}s.unshift(l),a=i,i=(null==i?void 0:i.parentNode)||null}while(a&&a!=t);return s}t.default=function(e,t){return t?{start:i(o.default.getStart(t),e),end:i(o.default.getEnd(t),e)}:null}},1431:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8655),o=n(3408),i=n(1657);function a(e){for(;e.previousSibling;)if(e=e.previousSibling,"BR"==(0,o.default)(e)||!(0,i.default)(e))return!1;return!0}t.default=function(e,t){if(e){var n=(e=e.normalize()).node;if(0==e.offset){for(;n&&(0,r.default)(t,n)&&a(n);)n=(null==n?void 0:n.parentNode)||null;return n==t}}return!1}},4477:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extractContentMetadata=t.setHtmlWithMetadata=void 0;var r=n(8831),o=n(5924),i=n(2373),a=n(681),l=(0,a.createArrayDefinition)((0,a.createNumberDefinition)()),s=(0,a.createObjectDefinition)({x:(0,a.createNumberDefinition)(),y:(0,a.createNumberDefinition)()}),u=(0,a.createBooleanDefinition)(!0),d=(0,a.createObjectDefinition)({type:(0,a.createNumberDefinition)(!0,0),isDarkMode:u,start:l,end:l}),c=(0,a.createObjectDefinition)({type:(0,a.createNumberDefinition)(!1,1),isDarkMode:u,tableId:(0,a.createStringDefinition)(),firstCell:s,lastCell:s}),f=(0,a.createObjectDefinition)({type:(0,a.createNumberDefinition)(!1,2),isDarkMode:u,imageId:(0,a.createStringDefinition)()});function p(e,t,n){if(e)return t=t||"",e.innerHTML=(null==n?void 0:n(t))||t,v(e)}function v(e){var t=e.lastChild;if((0,o.default)(t,"Comment"))try{var n=JSON.parse(t.nodeValue||"");if((0,i.default)(n,d)||(0,i.default)(n,c)||(0,i.default)(n,f))return e.removeChild(t),n.type=void 0===n.type?0:n.type,n.isDarkMode=n.isDarkMode||!1,n}catch(e){}}t.default=function(e,t,n){var o=p(e,t,n);return 0==(null==o?void 0:o.type)?(0,r.default)(e,o.start,o.end):null},t.setHtmlWithMetadata=p,t.extractContentMetadata=v},3680:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addSnapshotV2=void 0;var r=n(5892);function o(e,t,n,o,i){o=o||function(e){var t;return(null===(t=e)||void 0===t?void 0:t.length)||0},i=i||a;var l=e.snapshots[e.currentIndex],s=l&&i(l,t);if(e.currentIndex<0||!l||!s){(0,r.default)(e,o),e.snapshots.push(t),e.currentIndex++,e.totalSize+=o(t);for(var u=0;u<e.snapshots.length&&e.totalSize>e.maxSize;)e.totalSize-=o(e.snapshots[u]),u++;u>0&&(e.snapshots.splice(0,u),e.currentIndex-=u,e.autoCompleteIndex-=u),n&&(e.autoCompleteIndex=e.currentIndex)}else s&&e.snapshots.splice(e.currentIndex,1,t)}function i(e,t){return e.html==t.html&&!e.entityStates&&!t.entityStates}function a(e,t){return e==t}t.default=o,t.addSnapshotV2=function(e,t,n){o(e,t,n,(function(e){var t;return(null===(t=e.html)||void 0===t?void 0:t.length)||0}),i)}},3205:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.currentIndex+t;return n>=0&&n<e.snapshots.length}},6687:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.autoCompleteIndex>=0&&e.currentIndex-e.autoCompleteIndex==1}},5892:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearProceedingSnapshotsV2=void 0;var r=n(3205);function o(e,t){if(t=t||function(e){var t;return(null===(t=e)||void 0===t?void 0:t.length)||0},(0,r.default)(e,1)){for(var n=0,o=e.currentIndex+1;o<e.snapshots.length;o++)n+=t(e.snapshots[o]);e.snapshots.splice(e.currentIndex+1),e.totalSize-=n,e.autoCompleteIndex=-1}}t.default=o,t.clearProceedingSnapshotsV2=function(e){o(e,(function(e){var t;return(null===(t=e.html)||void 0===t?void 0:t.length)||0}))}},7424:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{snapshots:[],totalSize:0,currentIndex:-1,autoCompleteIndex:-1,maxSize:e}}},5105:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.moveCurrentSnapsnot=void 0;var r=n(3205);function o(e,t){return(0,r.default)(e,t)?(e.currentIndex+=t,e.autoCompleteIndex=-1,e.snapshots[e.currentIndex]):null}t.default=o,t.moveCurrentSnapsnot=o},359:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};return((null==e?void 0:e.getAttribute("style"))||"").split(";").forEach((function(e){var n=e.indexOf(":"),r=e.slice(0,n),o=e.slice(n+1);r&&o&&(t[r.trim()]=o.trim())})),t}},4136:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n,r=e.getElementById(t);r&&(null===(n=r.parentNode)||void 0===n||n.removeChild(r))}},9130:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(359),o=n(6092);t.default=function(e,t){var n=(0,r.default)(e),i=0;t.forEach((function(e){var t;if((null===(t=n[e])||void 0===t?void 0:t.indexOf("!important"))>-1){var r=n[e].indexOf("!");n[e]=n[e].substring(0,r),i++}})),i>0&&(0,o.default)(e,n)}},8182:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var r;if(t){var o=e.getElementById(n);o||((o=e.createElement("style")).id=n,e.head.appendChild(o)),null===(r=o.sheet)||void 0===r||r.insertRule(t)}}},6092:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4709);t.default=function(e,t){if(e){var n=(0,r.default)(t||{}).map((function(e){var n=t[e],r=e?e.trim():null,o=n?n.trim():null;return r&&o?r+":"+o:null})).filter((function(e){return e})).join(";");n?e.setAttribute("style",n):e.removeAttribute("style")}}},8094:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7582),o=n(6160),i=n(3408),a=n(1473),l=n(5203),s=n(5924),u=n(8375),d=n(3606),c=n(4711),f=n(7570),p={topBorderColor:"#ABABAB",bottomBorderColor:"#ABABAB",verticalBorderColor:"#ABABAB",hasHeaderRow:!1,hasFirstColumn:!1,hasBandedRows:!1,hasBandedColumns:!1,bgColorEven:null,bgColorOdd:"#ABABAB20",headerRowColor:"#ABABAB",tableBorderFormat:0,keepCellShade:!1,verticalAlign:null},v=function(){function e(e,t,n){var r=this;if(this.cells=null,this.formatInfo=null,this.trs=[],this.tableSelection=null,this.table=(0,s.default)(e,"HTMLTableElement")?e:function(e){for(var t=e;t&&"TABLE"!=t.tagName;t=t.parentElement);return t}(e),this.table){var o=(0,s.default)(e,"HTMLTableElement")?null:e,i=(0,u.default)(this.table.rows);this.cells=i.map((function(e){return[]})),i.forEach((function(e,t){var n;r.trs[t%2]=e;for(var i=0,a=0;i<e.cells.length;i++){for(;r.cells[t][a];a++);var l=e.cells[i];l==o&&(r.col=a,r.row=t);for(var s=0;s<l.colSpan;s++,a++)for(var u=0;u<l.rowSpan;u++){var d=s+u==0,c=l.getBoundingClientRect();(null===(n=r.cells)||void 0===n?void 0:n[t+u])&&(r.cells[t+u][a]={td:d?l:null,spanLeft:s>0,spanAbove:u>0,width:d?c.width:void 0,height:d?c.height:void 0})}}for(var f=0;f<r.cells[t].length;f++)r.cells[t][f]||(r.cells[t][f]={td:null,spanLeft:!1,spanAbove:!1,width:void 0,height:void 0})})),this.formatInfo=(0,c.getTableFormatInfo)(this.table),t&&this.normalizeSize("number"==typeof n?function(e){return e/n}:n)}}return Object.defineProperty(e.prototype,"selection",{get:function(){return this.tableSelection||null},set:function(e){if(e){var t=e.firstCell;this.row=null==t?void 0:t.y,this.col=null==t?void 0:t.x}this.tableSelection=e},enumerable:!1,configurable:!0}),e.prototype.writeBack=function(e,t){var n,r=this;this.cells?((0,a.default)(this.table),this.cells.forEach((function(e,t){var n=m(r.trs[t%2]||r.trs[0]);n&&(r.table.appendChild(n),e.forEach((function(e,o){e.td&&(r.recalculateSpans(t,o),r.recalculateCellHeight(e.td),n.appendChild(e.td))})))})),this.formatInfo&&!e&&((0,c.saveTableInfo)(this.table,this.formatInfo),(0,o.default)(this.table,this.cells,this.formatInfo,t))):this.table&&(null===(n=this.table.parentNode)||void 0===n||n.removeChild(this.table))},e.prototype.recalculateCellHeight=function(e){if(this.isEmptyCell(e)&&e.rowSpan>1)for(var t=1;t<e.rowSpan;t++){var n=document.createElement("br");e.appendChild(n)}},e.prototype.applyFormat=function(e){this.table&&(this.formatInfo=(0,r.__assign)((0,r.__assign)((0,r.__assign)({},p),this.formatInfo||{}),e||{}),this.formatInfo.keepCellShade||this.deleteCellShadeDataset(this.cells))},e.prototype.deleteCellShadeDataset=function(e){null==e||e.forEach((function(e){e.forEach((function(e){e.td&&(0,f.removeMetadata)(e.td,"bgColorOverride")}))}))},e.prototype.edit=function(e){var t,n,r=this;if(this.table&&this.cells&&void 0!==this.row&&null!=this.col){var o=this.cells[this.row],i=o[this.col],a=this.selection?this.selection.firstCell.y:this.row,l=this.selection?this.selection.lastCell.y:this.row,s=this.selection?this.selection.firstCell.x:this.col,u=this.selection?this.selection.lastCell.x:this.col;switch(e){case 0:for(var d=a;d<=l;d++)this.cells.splice(a,0,o.map(g));break;case 1:var c=function(e){var t=l+f.countSpanAbove(l,f.col);f.cells.splice(t,0,f.cells[t-1].map((function(e,n){var o=r.getCell(t,n);if(o.spanAbove)return g(o);if(e.spanLeft){var i=g(e);return i.spanAbove=!1,i}return{td:m(r.getTd(r.row,n))}})))},f=this;for(d=a;d<=l;d++)c();break;case 2:var p=function(e){v.forEachCellOfCurrentColumn((function(t,n){n.splice(e,0,g(t))}))},v=this;for(d=s;d<=u;d++)p(d);break;case 3:var h=function(e){var t=u+y.countSpanLeft(y.row,u);y.forEachCellOfColumn(t-1,(function(e,n,o){var i,a=r.getCell(o,t);a.spanLeft?i=g(a):e.spanAbove?(i=g(e)).spanLeft=!1:i={td:m(r.getTd(o,r.col))},n.splice(t,0,i)}))},y=this;for(d=s;d<=u;d++)h();break;case 6:for(var b=function(e){E.forEachCellOfRow(e,(function(t,n){var o=r.getCell(e+1,n);t.td&&t.td.rowSpan>1&&o.spanAbove&&(o.td=t.td)}))},E=this,C=a;C<=l;C++)b(C);var S=this.selection?this.selection.lastCell.y-this.selection.firstCell.y:0;this.cells.splice(a,S+1),0===this.cells.length&&(this.cells=null);break;case 5:for(var T=0,P=function(e){_.forEachCellOfColumn(e,(function(t,n,o){var i=r.getCell(o,e+1);t.td&&t.td.colSpan>1&&i.spanLeft&&(i.td=t.td);var a=r.selection?e-T:r.col;n.splice(a,1)})),T++},_=this,w=s;w<=u;w++)P(w);(0===(null===(t=this.cells)||void 0===t?void 0:t.length)||(null===(n=this.cells)||void 0===n?void 0:n.every((function(e){return 0===e.length}))))&&(this.cells=null);break;case 7:case 8:var O=7==e?-1:1;for(C=this.row+O;C>=0&&C<this.cells.length;C+=O)if((I=this.getCell(C,this.col)).td&&!I.spanAbove){var M=C<this.row?I:i,D=C<this.row?i:I;this.mergeCells(M,D);break}break;case 9:case 10:var A=9==e?-1:1;for(w=this.col+A;w>=0&&w<this.cells[this.row].length;w+=A)if((I=this.getCell(this.row,w)).td&&!I.spanLeft){var L=w<this.col?I:i,R=w<this.col?i:I;this.mergeCells(L,R,!0);break}break;case 11:for(w=s;w<=u;w++)for(C=a+1;C<=l;C++){var I=this.getCell(a,w),N=this.getCell(C,w);this.mergeCells(I,N)}for(w=s+1;w<=u;w++){I=this.getCell(a,s);var x=this.getCell(a,w);this.mergeCells(I,x,!0)}break;case 4:this.cells=null;break;case 13:if(i.td&&i.td.rowSpan>1)this.getCell(this.row+1,this.col).td=m(i.td);else{var k=o.map((function(e){return{td:e==i?m(e.td):null,spanAbove:e!=i,spanLeft:e.spanLeft}}));this.cells.splice(this.row+1,0,k)}break;case 12:i.td&&i.td.colSpan>1?this.getCell(this.row,this.col+1).td=m(i.td):this.forEachCellOfCurrentColumn((function(e,t){t.splice(r.col+1,0,{td:t==o?m(e.td):null,spanAbove:e.spanAbove,spanLeft:t!=o})}));break;case 14:this.table.style.marginLeft="auto",this.table.style.marginRight="auto";break;case 15:this.table.style.marginLeft="",this.table.style.marginRight="auto";break;case 16:this.table.style.marginLeft="auto",this.table.style.marginRight="";break;case 18:this.setAlignmentToSelectedCells(a,l,s,u,"center");break;case 17:this.setAlignmentToSelectedCells(a,l,s,u,"left");break;case 19:this.setAlignmentToSelectedCells(a,l,s,u,"right");break;case 20:this.setAlignmentToSelectedCells(a,l,s,u,"top",!0);break;case 21:this.setAlignmentToSelectedCells(a,l,s,u,"middle",!0);break;case 22:this.setAlignmentToSelectedCells(a,l,s,u,"bottom",!0)}}},e.prototype.setAlignmentToSelectedCells=function(e,t,n,o,i,a){for(var l,s,u=e;u<=t;u++)for(var c=n;c<=o;c++)if(this.cells){var f=this.cells[u][c].td;if(a&&f){null===(l=f.style)||void 0===l||l.setProperty("vertical-align",i);var p=(0,d.getTableCellMetadata)(f);(0,d.saveTableCellMetadata)(f,(0,r.__assign)((0,r.__assign)({},p),{vAlignOverride:!0}))}else f&&(null===(s=f.style)||void 0===s||s.setProperty("text-align",i))}},e.prototype.mergeCells=function(e,t,n){var r,o,i,a,l=n?(null===(r=e.td)||void 0===r?void 0:r.rowSpan)===(null===(o=t.td)||void 0===o?void 0:o.rowSpan)&&!e.spanLeft:(null===(i=e.td)||void 0===i?void 0:i.colSpan)===(null===(a=t.td)||void 0===a?void 0:a.colSpan)&&!e.spanAbove;e.td&&t.td&&l&&(this.mergeCellContents(e.td,t.td),t.td=null,n?t.spanLeft=!0:t.spanAbove=!0)},e.prototype.isEmptyCell=function(e){return 1===e.childElementCount&&"BR"===(0,i.default)(e.firstChild)},e.prototype.mergeCellContents=function(e,t){if(this.isEmptyCell(t))(0,a.default)(e,t,!1);else{var n=document.createElement("br");e.appendChild(n),(0,a.default)(e,t,!0)}},e.prototype.forEachCellOfCurrentColumn=function(e){this.forEachCellOfColumn(this.col,e)},e.prototype.getCellsWithBorder=function(e,t){for(var n=[],r=0;this.cells&&r<this.cells.length;r++)for(var o=0;o<this.cells[r].length;o++){var i=this.getCell(r,o);if(i.td){var a=(0,l.default)(i.td.getBoundingClientRect());if(a){var s=!1;if(t){if(a.right==e)s=!0,n.push(i.td);else if(s)break}else if(a.left==e)s=!0,n.push(i.td);else if(s)break}}}return n},e.prototype.forEachCellOfCurrentRow=function(e){this.forEachCellOfRow(this.row,e)},e.prototype.getCell=function(e,t){return this.cells&&this.cells[e]&&this.cells[e][t]||{}},e.prototype.getCurrentTd=function(){return this.getTd(this.row,this.col)},e.prototype.getTd=function(e,t){if(this.cells&&void 0!==e&&void 0!==t&&(e=Math.min(this.cells.length-1,e),t=this.cells[e]?Math.min(this.cells[e].length-1,t):t,!isNaN(e)&&!isNaN(t)))for(;e>=0&&t>=0;){var n=this.getCell(e,t);if(n.td)return n.td;if(n.spanLeft)t--;else{if(!n.spanAbove)break;e--}}return null},e.prototype.forEachCellOfColumn=function(e,t){if(void 0!==e)for(var n=0;this.cells&&n<this.cells.length;n++)t(this.getCell(n,e),this.cells[n],n)},e.prototype.forEachCellOfRow=function(e,t){if(void 0!==e)for(var n=0;this.cells&&n<this.cells[e].length;n++)t(this.getCell(e,n),n)},e.prototype.recalculateSpans=function(e,t){var n=this.getCell(e,t).td;n&&(n.colSpan=this.countSpanLeft(e,t),n.rowSpan=this.countSpanAbove(e,t),1==n.colSpan&&n.removeAttribute("colSpan"),1==n.rowSpan&&n.removeAttribute("rowSpan"))},e.prototype.countSpanLeft=function(e,t){for(var n=1,r=t+1;this.cells&&r<this.cells[e].length;r++){var o=this.getCell(e,r);if(o.td||!o.spanLeft)break;n++}return n},e.prototype.countSpanAbove=function(e,t){for(var n=1,r=e+1;this.cells&&r<this.cells.length;r++){var o=this.getCell(r,t);if(o.td||!o.spanAbove)break;n++}return n},e.prototype.normalizeEmptyTableCells=function(){for(var e=0,t=void 0;t=this.table.rows[e];e++)for(var n=0,r=void 0;r=t.cells[n];n++)r&&(r.innerHTML&&r.innerHTML.trim()||r.appendChild(document.createElement("br")))},e.prototype.normalizeTableCellSize=function(e){for(var t=0,n=void 0;n=this.table.rows[t];t++)n.removeAttribute("width"),n.style.setProperty("width",null),n.removeAttribute("height"),n.style.setProperty("height",null);for(t=0;this.cells&&t<this.cells.length;t++)for(var r=0;r<this.cells[t].length;r++){var o=this.cells[t][r];if(o){var i="number"==typeof e?function(t){return t/e}:e,a=o.width||0,l=o.height||0;h(o.td,(null==i?void 0:i(a))||a,(null==i?void 0:i(l))||l)}}},e.prototype.normalizeSize=function(e){this.normalizeEmptyTableCells(),this.normalizeTableCellSize(e);var t=this.table.getBoundingClientRect();h(this.table,(null==e?void 0:e(t.width))||t.width,(null==e?void 0:e(t.height))||t.height)},e}();function h(e,t,n){e&&(e.removeAttribute("width"),e.removeAttribute("height"),e.style.boxSizing="border-box",e.style.width=t+"px",e.style.height=n+"px")}function g(e){return{td:m(e.td),spanAbove:e.spanAbove,spanLeft:e.spanLeft}}function m(e){var t=e?e.cloneNode(!1):null;return(0,s.default)(t,"HTMLTableCellElement")&&(t.removeAttribute("id"),t.firstChild||t.appendChild(e.ownerDocument.createElement("br"))),t}t.default=v},6160:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4984),o=n(7727),i=n(3606),a="transparent";function l(e){var t;return!!e.td&&!!(null===(t=(0,i.getTableCellMetadata)(e.td))||void 0===t?void 0:t.bgColorOverride)}function s(e){return"solid 1px "+(e||"transparent")}t.default=function(e,t,n,u){n&&(e.style.borderCollapse="collapse",function(e,t){e.forEach((function(n,r){n.forEach((function(o,l){o.td&&!function(e){var t;return!!e.td&&!!(null===(t=(0,i.getTableCellMetadata)(e.td))||void 0===t?void 0:t.borderOverride)}(o)&&function(e,t,n,r,o,i){switch(function(e,t){e.style.borderTop=s(t.topBorderColor),e.style.borderLeft=s(t.verticalBorderColor),e.style.borderRight=s(t.verticalBorderColor),e.style.borderBottom=s(t.bottomBorderColor)}(t,e),e.tableBorderFormat){case 0:return;case 1:o||(t.style.borderLeftColor=a),i||(t.style.borderRightColor=a);break;case 4:n||(t.style.borderTopColor=a),r||n||(t.style.borderBottomColor=a),o||(t.style.borderLeftColor=a),i||o||(t.style.borderRightColor=a),o&&n&&(t.style.borderRightColor=a);break;case 2:n&&(t.style.borderTopColor=a,t.style.borderRightColor=a,t.style.borderLeftColor=a),o&&(t.style.borderLeftColor=a),i&&(t.style.borderRightColor=a);break;case 3:o&&(t.style.borderLeftColor=a),i&&(t.style.borderRightColor=a);break;case 5:n&&(t.style.borderRightColor=a,t.style.borderLeftColor=a),o&&(t.style.borderBottomColor=a,t.style.borderTopColor=a),n&&o&&(t.style.borderLeftColor=e.verticalBorderColor||a,t.style.borderBottomColor=e.bottomBorderColor||a,t.style.borderTopColor=e.topBorderColor||a);break;case 6:n&&(t.style.borderRightColor=a,t.style.borderLeftColor=a),o&&(t.style.borderBottomColor=a,t.style.borderTopColor=a),n&&o&&(t.style.borderLeftColor=e.verticalBorderColor||a,t.style.borderBottomColor=e.bottomBorderColor||a,t.style.borderTopColor=e.topBorderColor||a),n||o||(t.style.borderLeftColor=a,t.style.borderBottomColor=a,t.style.borderTopColor=a,t.style.borderRightColor=a);break;case 7:n&&(t.style.borderLeftColor=a,t.style.borderTopColor=a,t.style.borderRightColor=a),o&&(t.style.borderLeftColor=a,t.style.borderTopColor=a,t.style.borderBottomColor=a),n||o||(t.style.borderLeftColor=a,t.style.borderBottomColor=a,t.style.borderTopColor=a,t.style.borderRightColor=a),n&&o&&(t.style.borderBottomColor=e.bottomBorderColor||a)}}(t,o.td,0===r,r===e.length-1,0===l,l===n.length-1)}))}))}(t,n),function(e,t,n){var r=function(e){return e%2==0?t.bgColorEven:t.bgColorOdd},s=t.hasBandedRows,u=t.hasBandedColumns,d=t.bgColorOdd,c=t.bgColorEven,f=!s&&d===c;e.forEach((function(e,u){e.forEach((function(e){if(e.td){if(!l(e))if(s){var d=r(u);(0,o.default)(e.td,d||a,!0,void 0,!0,n)}else f?(0,o.default)(e.td,t.bgColorOdd||a,!0,void 0,!0,n):(0,o.default)(e.td,a,!0,void 0,!0,n);t.verticalAlign&&!function(e){var t;return!!e.td&&!!(null===(t=(0,i.getTableCellMetadata)(e.td))||void 0===t?void 0:t.vAlignOverride)}(e)&&(e.td.style.verticalAlign=t.verticalAlign)}}))})),u&&e.forEach((function(e){e.forEach((function(e,t){var i=r(t);e.td&&i&&!l(e)&&(0,o.default)(e.td,i,!0,void 0,!0,n)}))}))}(t,n,u),function(e,t){t.hasFirstColumn?e.forEach((function(t,n){t.forEach((function(t,i){t.td&&0===i&&(0===n||l(t)||(t.td.style.borderTopColor=a,(0,o.default)(t.td,a,!0,void 0,!0)),n!==e.length-1&&0!==n&&(t.td.style.borderBottomColor=a),t.td=(0,r.default)(t.td,"TH"),t.td.scope="col")}))})):e.forEach((function(e){e.forEach((function(e,t){e.td&&0===t&&(e.td=(0,r.default)(e.td,"TD"),e.td.scope="")}))}))}(t,n),function(e,t,n){var i,a;t.hasHeaderRow?null===(a=e[0])||void 0===a||a.forEach((function(e){e.td&&t.headerRowColor&&(l(e)||(0,o.default)(e.td,t.headerRowColor,!0,void 0,!0,n),e.td.style.borderRightColor=t.headerRowColor,e.td.style.borderLeftColor=t.headerRowColor,e.td.style.borderTopColor=t.headerRowColor,e.td=(0,r.default)(e.td,"TH"),e.td.scope="row")})):null===(i=e[0])||void 0===i||i.forEach((function(e){e.td&&(e.td=(0,r.default)(e.td,"TD"),e.td.scope="")}))}(t,n,u))}},7146:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7582),o=n(3606);t.default=function(e,t){var n=t.getAttribute("style");if(n){e.setAttribute("style",n);var i=(0,o.getTableCellMetadata)(t);i&&(0,o.saveTableCellMetadata)(e,(0,r.__assign)({},i))}}},8570:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(!t||!e.cells)return!1;var n=t.firstCell,r=t.lastCell,o=e.cells.length-1,i=e.cells[o];if(!i)return!1;var a=i.length-1,l=n.x,s=n.y,u=r.x,d=r.y;return 0==l&&0==s&&u==a&&d==o}},4731:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7146),o=n(1473),i=n(8094);t.default=function(e,t,n,a){var l,s,u,d,c=new i.default(t),f=new i.default(e),p=f.row,v=f.col,h=null!==(s=p+(null===(l=c.cells)||void 0===l?void 0:l.length))&&void 0!==s?s:0,g=null!==(d=v+(null===(u=c.cells)||void 0===u?void 0:u[0].length))&&void 0!==d?d:0;for(f.row=f.cells.length-1;f.cells.length<h;)f.edit(1);for(f.col=f.cells[0].length-1;f.cells[0].length<g;)f.edit(3);for(var m=p;m<h;m++)for(var y=v;y<g;y++){var b=f.getCell(m,y),E=c.getTd(m-p,y-v);b.td&&E?((0,o.default)(b.td,E),(0,r.default)(b.td,E)):b.td=document.createElement("td")}f.writeBack()}},3606:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.saveTableCellMetadata=t.getTableCellMetadata=void 0;var r=n(681),o=n(7570),i=(0,r.createBooleanDefinition)(!0,void 0,!0),a=(0,r.createObjectDefinition)({bgColorOverride:i,vAlignOverride:i,borderOverride:i},!1,!0);t.getTableCellMetadata=function(e){return(0,o.getMetadata)(e,a)},t.saveTableCellMetadata=function(e,t){e&&t&&(0,o.setMetadata)(e,t,a)}},4711:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.saveTableInfo=t.getTableFormatInfo=void 0;var r=n(7570),o=n(681),i=(0,o.createStringDefinition)(!1,void 0,!0),a=(0,o.createBooleanDefinition)(!1),l=(0,o.createObjectDefinition)({topBorderColor:i,bottomBorderColor:i,verticalBorderColor:i,hasHeaderRow:a,headerRowColor:i,hasFirstColumn:a,hasBandedColumns:a,hasBandedRows:a,bgColorEven:i,bgColorOdd:i,tableBorderFormat:(0,o.createNumberDefinition)(!1,void 0,0,8),keepCellShade:(0,o.createBooleanDefinition)(!0),verticalAlign:i},!1,!0);t.getTableFormatInfo=function(e){return(0,r.getMetadata)(e,l)},t.saveTableInfo=function(e,t){e&&t&&(0,r.setMetadata)(e,t,l)}},246:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Browser=t.getBrowserInfo=void 0;var n=/android/i;function r(e,t,r){var o,i=-1!=e.indexOf("rv:")&&-1!=e.indexOf("Trident"),a=-1!=e.indexOf("MSIE")||i,l=!1,s=!1,u=!1,d=!1,c=-1!=e.indexOf("WebKit"),f=!1;return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(o=e||r||"")||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(o.substr(0,4)))&&(f=!0),a||(l=-1!=e.indexOf("Chrome"),s=-1!=e.indexOf("Firefox"),-1!=e.indexOf("Safari")&&(u=-1==e.indexOf("Chrome")&&-1==e.indexOf("Android")),(d=-1!=e.indexOf("Edge"))&&(c=l=s=!1)),{isMac:-1!=t.indexOf("Mac"),isWin:-1!=t.indexOf("Win")||-1!=t.indexOf("NT"),isWebKit:c,isIE:a,isIE11OrGreater:i,isSafari:u,isChrome:l,isFirefox:s,isEdge:d,isIEOrEdge:a||d,isAndroid:n.test(e),isMobileOrTablet:f}}t.getBrowserInfo=r,t.Browser="undefined"!=typeof window&&window?r(window.navigator.userAgent,window.navigator.appVersion,window.navigator.vendor):{}},5400:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7727);t.default=function(e,t,n,o){if(t){var i=e.style,a=t.fontFamily,l=t.fontSize,s=t.textColor,u=t.textColors,d=t.backgroundColor,c=t.backgroundColors,f=t.bold,p=t.italic,v=t.underline;a&&(i.fontFamily=a),l&&(i.fontSize=l),u?(0,r.default)(e,u,!1,n,!1,o):s&&(0,r.default)(e,s,!1,n,!1,o),c?(0,r.default)(e,c,!0,n,!1,o):d&&(0,r.default)(e,d,!0,n,!1,o),f&&(i.fontWeight="bold"),p&&(i.fontStyle="italic"),v&&(i.textDecoration="underline")}}},4984:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7582),o=n(7695),i=n(3408),a=n(1473);t.default=function(e,t){var n;if(!e||!t)return null;var l=(0,i.default)(e);if(l==t.toUpperCase())return e;for(var s=e.ownerDocument.createElement(t),u=0;u<e.attributes.length;u++){var d=e.attributes[u];s.setAttribute(d.name,d.value)}return(0,a.default)(s,e),"P"!=l&&"P"!=(0,i.default)(s)||(n=(0,r.__read)((0,o.default)(e,["margin-top","margin-bottom"]),2),s.style.marginTop=n[0],s.style.marginBottom=n[1]),e.parentNode&&e.parentNode.replaceChild(s,e),s}},8053:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.collapse=void 0;var r=n(8655),o=n(9381),i=n(8375);function a(e,t,n,i,a){for(;t.parentNode!=e&&!(0,r.default)(t.parentNode,n);){if(i&&t.previousSibling||!i&&t.nextSibling){if(!a)break;(0,o.default)(t,i)}if(!t.parentNode)break;t=t.parentNode}return t}t.default=function(e,t,n,o){var l;if(!(0,r.default)(e,t)||!(0,r.default)(e,n))return[];if(t=a(e,t,n,!0,o),n=a(e,n,t,!1,o),(0,r.default)(t,n,!0))return[t];if((0,r.default)(n,t))return[n];if(t.parentNode==n.parentNode){var s=t.parentNode?(0,i.default)(null===(l=t.parentNode)||void 0===l?void 0:l.childNodes):[],u=s.indexOf(t),d=s.indexOf(n);return s.slice(u,d+1)}return[t,n]},t.collapse=a},8655:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5924);t.default=function(e,t,n){return!(!e||!t)&&(!(!n||e!=t)||((0,r.default)(t,"Range")&&(t=t&&t.commonAncestorContainer,n=!0),t&&3==t.nodeType&&(t=t.parentNode,n=!0),1!=e.nodeType&&11!=e.nodeType?!!n&&e==t:!(!n&&e==t)&&function(e,t){if(e.contains)return e.contains(t);for(;t;){if(t==e)return!0;t=t.parentNode}return!1}(e,t)))}},6935:(e,t,n)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.KnownCreateElementData=void 0;var o=n(4709),i=n(5924),a=n(246);t.KnownCreateElementData=((r={})[0]={tag:""},r[1]=a.Browser.isEdge?{tag:"div",children:[{tag:"span",children:[{tag:"br"}]}]}:{tag:"div",children:[{tag:"br"}]},r[2]={tag:"blockquote",style:"margin-top:0;margin-bottom:0"},r[3]={tag:"div",style:"width: 600px; height: 1px; overflow: hidden; position: fixed; top: 0; left; 0; -webkit-user-select: text",attributes:{contenteditable:"true"}},r[4]={tag:"li",style:"display:block"},r[5]={tag:"div",style:"position: fixed; width: 0; height: 0"},r[6]={tag:"span",style:"max-width:100%;position:relative",children:[{tag:"div",style:"width:100%;height:100%;position:relative;overflow:hidden"}]},r[7]={tag:"div",style:"position: fixed; cursor: row-resize; user-select: none"},r[8]={tag:"div",style:"position: fixed; cursor: col-resize; user-select: none"},r[9]={tag:"div",style:"position: fixed; cursor: nw-resize; user-select: none; border: 1px solid #808080"},r[10]={tag:"div",style:"position: fixed; cursor: ne-resize; user-select: none; border: 1px solid #808080"},r[11]={tag:"div",style:"position: fixed; cursor: all-scroll; user-select: none; border: 1px solid #808080"},r[12]={tag:"div",children:[{tag:"span",children:[{tag:"br"}]}]},r),t.default=function e(n,r){if("number"==typeof n&&(n=t.KnownCreateElementData[n]),!n||!n.tag)return null;var a=n.tag,l=n.namespace,s=n.className,u=n.style,d=n.dataset,c=n.attributes,f=n.children,p=l?r.createElementNS(l,a):r.createElement(a);return u&&p.setAttribute("style",u),s&&(p.className=s),d&&(0,i.default)(p,"HTMLElement")&&(0,o.default)(d).forEach((function(e){p.dataset[e]=d[e]})),c&&(0,o.default)(c).forEach((function(e){p.setAttribute(e,c[e])})),f&&f.forEach((function(t){if("string"==typeof t)p.appendChild(r.createTextNode(t));else if(t){var n=e(t,r);n&&p.appendChild(n)}})),p}},3598:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8655),o=n(5010);t.default=function(e,t,n){var i=(e=e?1==e.nodeType?e:e.parentNode:null)&&1==e.nodeType?e:null;if(i&&n)if(i.closest)i=i.closest(n);else for(;i&&i!=t&&!(0,o.default)(i,n);)i=i.parentElement;return!t||(0,r.default)(t,i)?i:null}},5023:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8375);t.default=function(e,t){var n=t.createElement("DIV");return n.innerHTML=e,(0,r.default)(n.childNodes)}},7695:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getComputedStyle=void 0;var r=n(7582),o=n(3598);function i(e,t){var n,i;void 0===t&&(t=["font-family","font-size","color","background-color"]);var a,l=(0,o.default)(e),s=[];if(t=Array.isArray(t)?t:[t],l){var u=(l.ownerDocument.defaultView||window).getComputedStyle(l);if(u)try{for(var d=(0,r.__values)(t),c=d.next();!c.done;c=d.next()){var f=c.value,p=u.getPropertyValue(f)||"";p="font-family"!=f?p.toLowerCase():p,p="font-size"==f?(a=p)&&a.indexOf("px")==a.length-2?Math.round(75*parseFloat(a)+.05)/100+"pt":a:p,s.push(p)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}}return s}t.default=i,t.getComputedStyle=function(e,t){return i(e,t)[0]||""}},4746:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5924);t.default=function(e){if((0,r.default)(e,"HTMLElement"))return e.innerHTML;if(e){var t=e.ownerDocument.createElement("span");return t.appendChild(e.cloneNode(!0)),t.innerHTML}return""}},3798:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7582),o=n(5203);t.default=function(e,t){void 0===t&&(t=[]);var n=e.map((function(e){return(0,o.default)(e.getBoundingClientRect())})).concat(t).filter((function(e){return!!e})),i={top:Math.max.apply(Math,(0,r.__spreadArray)([],(0,r.__read)(n.map((function(e){return e.top}))),!1)),bottom:Math.min.apply(Math,(0,r.__spreadArray)([],(0,r.__read)(n.map((function(e){return e.bottom}))),!1)),left:Math.max.apply(Math,(0,r.__spreadArray)([],(0,r.__read)(n.map((function(e){return e.left}))),!1)),right:Math.min.apply(Math,(0,r.__spreadArray)([],(0,r.__read)(n.map((function(e){return e.right}))),!1))};return i.top<i.bottom&&i.left<i.right?i:null}},4061:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLastLeafNode=t.getFirstLeafNode=void 0;var r=n(1630),o=n(2513);function i(e,t){for(var n=function(e){return t?e.firstChild:e.lastChild},i=n(e);i&&n(i);)i=n(i);return i&&(0,r.default)(i)&&(i=(0,o.getLeafSibling)(e,i,t)),i}t.getFirstLeafNode=function(e){return i(e,!0)},t.getLastLeafNode=function(e){return i(e,!1)}},2513:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPreviousLeafSibling=t.getNextLeafSibling=t.getLeafSibling=void 0;var r=n(8655),o=n(3408),i=n(1630);function a(e,t,n,a,l){var s=null,u=n?function(e){return(null==e?void 0:e.nextSibling)||null}:function(e){return(null==e?void 0:e.previousSibling)||null},d=n?function(e){return e.firstChild}:function(e){return e.lastChild};if((0,r.default)(e,t))for(var c=t,f=!0;f;){var p=(null==c?void 0:c.parentNode)||null;for(c=u(c);!c&&p!=e;)c=u(p),p=(null==p?void 0:p.parentNode)||null;for(;c&&(!a||a.indexOf((0,o.default)(c))<0)&&d(c);)c=d(c);if(!(f=!!c&&(0,i.default)(c,l))){s=c;break}}return s}t.getLeafSibling=a,t.getNextLeafSibling=function(e,t,n){return a(e,t,!0,n)},t.getPreviousLeafSibling=function(e,t,n){return a(e,t,!1,n)}},3764:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PendableFormatCommandMap=void 0;var r=n(4709);t.PendableFormatCommandMap={isBold:"bold",isItalic:"italic",isUnderline:"underline",isStrikeThrough:"strikeThrough",isSubscript:"subscript",isSuperscript:"superscript"},t.default=function(e){return(0,r.default)(t.PendableFormatCommandMap).reduce((function(n,r){return n[r]=e.queryCommandState(t.PendableFormatCommandMap[r]),n}),{})}},3408:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e&&1==e.nodeType?e.tagName.toUpperCase():""}},5499:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3408),o="ADDRESS,ARTICLE,ASIDE,BLOCKQUOTE,CANVAS,DD,DIV,DL,DT,FIELDSET,FIGCAPTION,FIGURE,FOOTER,FORM,H1,H2,H3,H4,H5,H6,HEADER,HR,LI,MAIN,NAV,NOSCRIPT,OL,OUTPUT,P,PRE,SECTION,TABLE,TD,TH,TFOOT,UL,VIDEO".split(","),i=["block","list-item","table-cell"];t.default=function(e){var t=(0,r.default)(e);return!(!t||!(i.indexOf(e.style.display)>=0||o.indexOf(t)>=0))}},6997:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return!(!e||!t||4!=(4&t.compareDocumentPosition(e)))}},1657:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3408),o=["IMG"],i=["TABLE","IMG","LI"].join(","),a=/\u200b/g;function l(e,t){return e=e.replace(a,""),t?e.trim():e}t.default=function(e,t,n){if(!e)return!1;if(3==e.nodeType)return""==l(e.nodeValue||"",t);if(1==e.nodeType){var a=e,s=l(a.textContent||"",t),u=n?i+",BR":i;if(""!=s||o.indexOf((0,r.default)(a))>=0||a.querySelectorAll(u)[0])return!1}return!0}},8235:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3408),o="AREA,BASE,BR,COL,COMMAND,EMBED,HR,IMG,INPUT,KEYGEN,LINK,META,PARAM,SOURCE,TRACK,WBR".split(",");t.default=function(e){return!!e&&o.indexOf((0,r.default)(e))>=0}},844:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7582),o=n(4709),i=/^[^?]+%[^0-9a-f]+|^[^?]+%[0-9a-f][^0-9a-f]+|^[^?]+%00|^[^?]+%$|^https?:\/\/[^?\/]+@|^www\.[^?\/]+@/i,a="[a-z0-9](?:[a-z0-9-]*[a-z0-9])?",l="(?:"+a+"\\.)*"+a+"(?:\\:[0-9]+)?(?:[\\/\\?]\\S*)?",s={http:{match:new RegExp("^(?:microsoft-edge:)?http:\\/\\/"+l+"|www\\."+l,"i"),except:i,normalizeUrl:function(e){return new RegExp("^(?:microsoft-edge:)?http:\\/\\/","i").test(e)?e:"http://"+e}},https:{match:new RegExp("^(?:microsoft-edge:)?https:\\/\\/"+l,"i"),except:i},mailto:{match:new RegExp("^mailto:\\S+@\\S+\\.\\S+","i")},notes:{match:new RegExp("^notes:\\/\\/\\S+","i")},file:{match:new RegExp("^file:\\/\\/\\/?\\S+","i")},unc:{match:new RegExp("^\\\\\\\\\\S+","i")},ftp:{match:new RegExp("^ftp:\\/\\/"+l+"|ftp\\."+l,"i"),normalizeUrl:function(e){return new RegExp("^ftp:\\/\\/","i").test(e)?e:"ftp://"+e}},news:{match:new RegExp("^news:(\\/\\/)?"+l,"i")},telnet:{match:new RegExp("^telnet:(\\/\\/)?"+l,"i")},gopher:{match:new RegExp("^gopher:\\/\\/"+l,"i")},wais:{match:new RegExp("^wais:(\\/\\/)?"+l,"i")}};t.default=function(e){var t,n;if(e)try{for(var i=(0,r.__values)((0,o.default)(s)),a=i.next();!a.done;a=i.next()){var l=a.value,u=s[l],d=e.match(u.match);if(d&&d[0]==e&&(!u.except||!u.except.test(e)))return{scheme:l,originalUrl:e,normalizedUrl:u.normalizeUrl?u.normalizeUrl(e):e}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return null}},5010:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5924);t.default=function(e,t){return(0,r.default)(e,"HTMLElement")&&(e.matches||e.msMatchesSelector).call(e,t)}},1473:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(e){for(;!n&&e.firstChild;)e.removeChild(e.firstChild);for(;null==t?void 0:t.firstChild;)e.appendChild(t.firstChild)}}},5203:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e||{left:0,right:0,top:0,bottom:0},n=t.left,r=t.right,o=t.top,i=t.bottom;return 0===n&&0===r&&0===o&&0===i?null:{left:Math.round(n),right:Math.round(r),top:Math.round(o),bottom:Math.round(i)}}},8121:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=/^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/,r=/^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/,o=/^rgb\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*\)$/,i=/^rgba\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*\)$/;t.default=function(e){var t;return(t=(e=(e||"").trim()).match(n))?[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]:(t=e.match(r))?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:(t=e.match(o)||e.match(i))?[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]:null}},8471:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8375);function o(e,t){return t.some((function(t){return 0==t?0==e:(e&t)==t}))}t.default=function(e,t,n,i,a){if(void 0===i&&(i=0),!e||!t)return[];var l=(0,r.default)(e.querySelectorAll(t));if(0!=i&&a){var s=a.startOffset,u=a.endOffset,d=a.startContainer,c=a.endContainer;if(1==d.nodeType&&d.firstChild){var f=d.childNodes[s];d=f||d.lastChild}c=1==c.nodeType&&c.firstChild&&u>0?c.childNodes[u-1]:c,l=l.filter((function(e){return n=d,r=c,a=2==i,l=(t=e).compareDocumentPosition(n),s=t.compareDocumentPosition(r),u=[0,8],a||u.push(16),o(l,u)||o(s,u)||o(l,[2])&&o(s,[4])&&!o(s,[16]);var t,n,r,a,l,s,u}))}return n&&l.forEach(n),l}},3126:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e){var n=new FileReader;n.onload=function(){t(n.result)},n.onerror=function(){t(null)},n.readAsDataURL(e)}}},5924:(e,t)=>{"use strict";function n(e){var t=e&&(e.ownerDocument||("[object HTMLDocument]"==Object.prototype.toString.apply(e)?e:null));return t&&(t.defaultView||window)}Object.defineProperty(t,"__esModule",{value:!0}),t.getTargetWindow=void 0,t.getTargetWindow=n,t.default=function(e,t){var r;if("Range"==t)return"[object Range]"==Object.prototype.toString.apply(e)&&!!(null===(r=e)||void 0===r?void 0:r.commonAncestorContainer);var o=n(e),i=o&&o[t],a=window,l=a&&a[t];return l&&e instanceof l||i&&e instanceof i}},7727:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(8121),i="#ffffff";!function(e){e[e.BRIGHT=0]="BRIGHT",e[e.DARK=1]="DARK",e[e.NONE=2]="NONE"}(r||(r={}));t.default=function e(t,n,r,a,l,s){var u="string"==typeof n?n.trim():"",d="string"==typeof n?null:n,c=r?"background-color":"color";if(u||d){if(s){var f=s.registerColor((null==d?void 0:d.lightModeColor)||u,!!a,null==d?void 0:d.darkModeColor);t.style.setProperty(c,f)}r&&l&&function(t,n,r,a){if(n&&"transparent"!==n)switch(function(e){var t=function(e){var t=(0,o.default)(e);if(t){var n=t[0]/255,r=t[1]/255,i=t[2]/255;return 50*(Math.max(n,r,i)+Math.min(n,r,i))}return 255}(e);return t<20?1:t>80?0:2}(n)){case 1:e(t,{lightModeColor:i,darkModeColor:"#333333"},!1,r,!1,a);break;case 0:e(t,{lightModeColor:"#000000",darkModeColor:i},!1,r,!1,a)}}(t,(null==d?void 0:d.lightModeColor)||u,a,s)}}},1630:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3408),o=n(7695),i=/^[\r\n]+$/g,a=/[\t\r\n\u0020\u200B]/gm;t.default=function e(t,n){if(3==t.nodeType)return!(t.nodeValue&&""!=t.textContent&&!i.test(t.nodeValue)&&(!n||""!=t.nodeValue.replace(a,"")));if(1==t.nodeType){if("none"==(0,o.getComputedStyle)(t,"display"))return!0;var l=(0,r.default)(t);if("DIV"==l||"SPAN"==l){for(var s=t.firstChild;s;s=s.nextSibling)if(!e(s,n))return!1;return!0}return!1}return!0}},9381:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitBalancedNodeRange=void 0;var r=n(6997);function o(e,t){var n;if(!e||!e.parentNode)return null;var r=e.parentNode,o=r.cloneNode(!1);if(o.removeAttribute("id"),t)for(;r.firstChild&&r.firstChild!=e;)o.appendChild(r.firstChild);else for(;e.nextSibling;)o.appendChild(e.nextSibling);return o.firstChild&&""!=o.innerHTML?null===(n=r.parentNode)||void 0===n||n.insertBefore(o,t?r:r.nextSibling):o=null,o}t.default=o,t.splitBalancedNodeRange=function(e){var t=Array.isArray(e)?e[0]:e,n=Array.isArray(e)?e[e.length-1]:e,i=t&&n&&t.parentNode==n.parentNode?t.parentNode:null;if(i){if((0,r.default)(t,n)){var a=n;n=t,t=a}o(t,!0),o(n,!1)}return i}},7409:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var r,o,i,a=(null===(r=e.nodeValue)||void 0===r?void 0:r.substring(0,t))||"",l=(null===(o=e.nodeValue)||void 0===o?void 0:o.substring(t))||"",s=e.ownerDocument.createTextNode(n?a:l);return e.nodeValue=n?l:a,null===(i=e.parentNode)||void 0===i||i.insertBefore(s,n?e:e.nextSibling),s}},82:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e?e.parentNode:null;if(!t)return null;for(;e.firstChild;)t.insertBefore(e.firstChild,e);return t.removeChild(e),t}},4251:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7582),o=n(6935),i=n(5023),a=n(5924);t.default=function(e,t){var n,l;if(0==(e=e?(0,a.default)(e,"Node")?[e]:e:[]).length||!e[0]||!e[0].ownerDocument)return null;if(t||(t="div"),!(0,a.default)(t,"HTMLElement")){var s=e[0].ownerDocument;t="string"==typeof t?/^\w+$/.test(t)?s.createElement(t):(0,i.default)(t,s)[0]:(0,o.default)(t,s)}var u=e[0].parentNode;u&&u.insertBefore(t,e[0]);try{for(var d=(0,r.__values)(e),c=d.next();!c.done;c=d.next()){var f=c.value;t.appendChild(f)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(l=d.return)&&l.call(d)}finally{if(n)throw n.error}}return t}},2080:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(0,n(7582).__exportStar)(n(7190),t)},4730:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(0,n(7582).__exportStar)(n(3381),t)},1184:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(0,n(7582).__exportStar)(n(9025),t)},8801:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(0,n(7582).__exportStar)(n(936),t)},4165:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(0,n(7582).__exportStar)(n(7030),t)},3106:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(0,n(7582).__exportStar)(n(8854),t)},7099:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(0,n(7582).__exportStar)(n(5061),t)},9082:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(0,n(7582).__exportStar)(n(872),t)},2151:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(0,n(7582).__exportStar)(n(9835),t)},3775:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(0,n(7582).__exportStar)(n(2184),t)},941:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(0,n(7582).__exportStar)(n(8833),t)},7037:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(0,n(7582).__exportStar)(n(7311),t)},2125:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(0,n(7582).__exportStar)(n(9963),t)},7019:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(0,n(7582).__exportStar)(n(2939),t)},4739:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7582);(0,r.__exportStar)(n(1184),t),(0,r.__exportStar)(n(8801),t),(0,r.__exportStar)(n(4165),t),(0,r.__exportStar)(n(3106),t),(0,r.__exportStar)(n(7099),t),(0,r.__exportStar)(n(9082),t),(0,r.__exportStar)(n(2151),t),(0,r.__exportStar)(n(3775),t),(0,r.__exportStar)(n(941),t),(0,r.__exportStar)(n(2125),t),(0,r.__exportStar)(n(7019),t),(0,r.__exportStar)(n(7037),t),(0,r.__exportStar)(n(4730),t),(0,r.__exportStar)(n(2080),t)},4296:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7582),o=n(6344),i={MOUSEDOWN:"mousedown",MOUSEMOVE:"mousemove",MOUSEUP:"mouseup",getPageXY:function(e){return[e.pageX,e.pageY]}},a={MOUSEDOWN:"touchstart",MOUSEMOVE:"touchmove",MOUSEUP:"touchend",getPageXY:function(e){var t=0,n=0;if(e.targetTouches&&e.targetTouches.length>0){var r=e.targetTouches[0];t=r.pageX,n=r.pageY}return[t,n]}};var l=function(){function e(e,t,n,l,s,u){var d=this;this.trigger=e,this.context=t,this.onSubmit=n,this.handler=l,this.zoomScale=s,this.initX=0,this.initY=0,this.initValue=void 0,this.onMouseDown=function(e){var t,n,o;e.preventDefault(),e.stopPropagation(),d.addDocumentEvents(),t=(0,r.__read)(d.dndMouse.getPageXY(e),2),d.initX=t[0],d.initY=t[1],d.initValue=null===(o=(n=d.handler).onDragStart)||void 0===o?void 0:o.call(n,d.context,e)},this.onMouseMove=function(e){var t,n,o;e.preventDefault();var i=(0,r.__read)(d.dndMouse.getPageXY(e),2),a=i[0],l=i[1],s=(a-d.initX)/d.zoomScale,u=(l-d.initY)/d.zoomScale;d.initValue&&(null===(n=(t=d.handler).onDragging)||void 0===n?void 0:n.call(t,d.context,e,d.initValue,s,u))&&(null===(o=d.onSubmit)||void 0===o||o.call(d,d.context,d.trigger))},this.onMouseUp=function(e){var t,n,r;e.preventDefault(),d.removeDocumentEvents(),(null===(n=(t=d.handler).onDragEnd)||void 0===n?void 0:n.call(t,d.context,e,d.initValue))&&(null===(r=d.onSubmit)||void 0===r||r.call(d,d.context,d.trigger))},this.dndMouse=u||o.Browser.isMobileOrTablet?a:i,e.addEventListener(this.dndMouse.MOUSEDOWN,this.onMouseDown)}return e.prototype.dispose=function(){this.trigger.removeEventListener(this.dndMouse.MOUSEDOWN,this.onMouseDown),this.removeDocumentEvents()},Object.defineProperty(e.prototype,"mouseType",{get:function(){return this.dndMouse==a?"touch":"mouse"},enumerable:!1,configurable:!0}),e.prototype.addDocumentEvents=function(){var e=this.trigger.ownerDocument;e.addEventListener(this.dndMouse.MOUSEMOVE,this.onMouseMove,!0),e.addEventListener(this.dndMouse.MOUSEUP,this.onMouseUp,!0)},e.prototype.removeDocumentEvents=function(){var e=this.trigger.ownerDocument;e.removeEventListener(this.dndMouse.MOUSEMOVE,this.onMouseMove,!0),e.removeEventListener(this.dndMouse.MOUSEUP,this.onMouseUp,!0)},e}();t.default=l},5938:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6344);t.default=function(e,t){if((0,r.safeInstanceOf)(t,"HTMLLIElement")){if(t&&(0,r.safeInstanceOf)(e,"HTMLOListElement")){var n=new r.VList(e).getListItemIndex(t),o=-1==n?"":n.toString();switch(e.style.listStyleType){case"lower-alpha":case"lower-latin":case"upper-alpha":case"upper-latin":o=(0,r.convertDecimalsToAlpha)(n-1);break;case"lower-roman":case"upper-roman":o=(0,r.convertDecimalsToRoman)(n)}return{defaultStrings:1,formatStrings:[o]}}return(0,r.safeInstanceOf)(e,"HTMLUListElement")?{defaultStrings:2}:void 0}}},633:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7140),o=n(6344),i=function(){function e(e,t,n){void 0===t&&(t=[]),this.stringsMapOrGetter=e,this.lastFocusedElement=null,this.features=(0,o.getObjectKeys)(r.AnnounceFeatures).map((function(e){if(-1==t.indexOf(e))return r.AnnounceFeatures[e]})).filter((function(e){return!!e})).concat(n||[])}return e.prototype.getName=function(){return"Announce"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){var e,t;for(null===(t=null===(e=this.ariaLiveElement)||void 0===e?void 0:e.parentElement)||void 0===t||t.removeChild(this.ariaLiveElement),this.ariaLiveElement=void 0,this.stringsMapOrGetter=void 0,this.lastFocusedElement=null;this.features.length>0;)this.features.pop();this.editor=void 0},e.prototype.onPluginEvent=function(e){var t;if(this.editor&&7==e.eventType&&(null===(t=e.additionalData)||void 0===t?void 0:t.getAnnounceData)){var n=e.additionalData.getAnnounceData();n&&this.announce(n,this.editor)}0==e.eventType&&this.editor&&this.handleFeatures(e,this.editor)},e.prototype.handleFeatures=function(e,t){var n=this;t.runAsync((function(t){n.features.filter((function(t){return t.keys.indexOf(e.rawEvent.which)>-1})).some((function(e){var r=e.shouldHandle(t,n.lastFocusedElement);return r&&n.announce(r,t),!!r})),n.lastFocusedElement=t.getElementAtCursor()}))},e.prototype.announce=function(e,t){var n,r,i,a=e.text,l=e.defaultStrings,s=e.formatStrings,u=void 0===s?[]:s,d=function(e,t){return null==e||t.forEach((function(t,n){e=null==e?void 0:e.replace("{"+n+"}",t)})),e}(this.getString(l)||a,u);d&&(this.ariaLiveElement&&d!=(null===(n=this.ariaLiveElement)||void 0===n?void 0:n.textContent)||(null===(i=null===(r=this.ariaLiveElement)||void 0===r?void 0:r.parentElement)||void 0===i||i.removeChild(this.ariaLiveElement),this.ariaLiveElement=function(e){var t=(0,o.createElement)({tag:"div",style:"clip: rect(0px, 0px, 0px, 0px); clip-path: inset(100%); height: 1px; overflow: hidden; position: absolute; white-space: nowrap; width: 1px;",attributes:{"aria-live":"assertive"}},e);return e.body.appendChild(t),t}(t.getDocument())),this.ariaLiveElement&&(this.ariaLiveElement.textContent=d))},e.prototype.getString=function(e){if(null!=this.stringsMapOrGetter&&null!=e)return"function"==typeof this.stringsMapOrGetter?this.stringsMapOrGetter(e):this.stringsMapOrGetter.get(e)},e.prototype.getAriaLiveElement=function(){return this.ariaLiveElement},e}();t.default=i},7140:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnnounceFeatures=void 0;var r=n(3104),o=n(2971);t.AnnounceFeatures={announceNewListItem:r.default,announceWarningOnLastTableCell:o.default}},3104:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5938),o={keys:[13],shouldHandle:function(e){var t=e.getElementAtCursor("LI"),n=e.getElementAtCursor("OL,UL");return!(!n||!t)&&(0,r.default)(n,t)||!1}};t.default=o},2971:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6344),o="td,th",i={shouldHandle:function(e,t){var n=e.getSelectionRangeEx();return 0==(null==n?void 0:n.type)&&n.areAllCollapsed&&1===n.ranges.length&&!(0,r.contains)(t,n.ranges[0].startContainer,!0)&&function(){var t=e.getElementAtCursor("table");if((0,r.safeInstanceOf)(t,"HTMLTableElement")){var n=t.querySelectorAll(o);return e.getElementAtCursor(o)==n.item(n.length-1)}return!1}()&&{defaultStrings:3}},keys:[9,38,40,37,39]};t.default=i},7190:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Announce=void 0;var r=n(633);Object.defineProperty(t,"Announce",{enumerable:!0,get:function(){return r.default}})},3904:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=/[`!@#$%^&*()_+\=\[\]{};':"\\|,.<>\/?~]/,r=function(){function e(){this.editor=null,this.lastKeyTyped=null}return e.prototype.getName=function(){return"AutoFormat"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null,this.lastKeyTyped=null},e.prototype.onPluginEvent=function(e){var t=this;if(this.editor&&(7!==e.eventType&&5!==e.eventType&&6!==e.eventType||(this.lastKeyTyped=""),1===e.eventType)){var r=e.rawEvent.key;if(r&&r.length>1&&(this.lastKeyTyped=""),"-"!==this.lastKeyTyped||n.test(r)||"-"===r)this.lastKeyTyped=r;else{var o=this.editor.getContentSearcherOfCursor(e),i=null==o?void 0:o.getSubStringBefore(3),a=null==o?void 0:o.getSubStringBefore(2);if("-"===(null==i?void 0:i[0])||" --"==i&&" "!==r||" --"!==i&&" "===r||"string"==typeof i&&n.test(i[0])||"--"!==a)return;var l=null==o?void 0:o.getRangeFromText(a,!0),s=" --"===i&&" "===r?document.createTextNode("–"):document.createTextNode("—");this.editor.addUndoSnapshot((function(){l&&(l.deleteContents(),l.insertNode(s),t.editor.select(s,-1))}),"Format",!0,{formatApiName:"autoHyphen"}),this.lastKeyTyped=null}}},e}();t.default=r},3381:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutoFormat=void 0;var r=n(3904);Object.defineProperty(t,"AutoFormat",{enumerable:!0,get:function(){return r.default}})},678:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(692),o=n(6344),i=function(){function e(e,t){this.settingsOverride=e,this.additionalFeatures=t,this.editor=void 0,this.features=[]}return e.prototype.getName=function(){return"ContentEdit"},e.prototype.initialize=function(e){var t=this;this.editor=e;var n=(0,r.default)();(0,o.getObjectKeys)(n).forEach((function(e){var r,o=n[e],i=t.settingsOverride&&void 0!==t.settingsOverride[e];(i&&(null===(r=t.settingsOverride)||void 0===r?void 0:r[e])||!i&&!o.defaultDisabled)&&t.features.push(o)})),this.features=this.features.concat(this.additionalFeatures||[]),this.features.forEach((function(e){var n;return null===(n=t.editor)||void 0===n?void 0:n.addContentEditFeature(e)}))},e.prototype.disposeFeatures=function(){var e=this;this.editor&&this.features.forEach((function(t){return e.editor.removeContentEditFeature(t)})),this.features=[]},e.prototype.dispose=function(){this.disposeFeatures(),this.editor=void 0},e}();t.default=i},7539:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutoLinkFeatures=void 0;var r=n(4548),o=n(6344),i=/[.+=\s:;"',>]+$/i,a={keys:[13,32,257],shouldHandleEvent:s,handleEvent:function(e,t){var n=s(e,t);if(n){var i=t.getDocument().createElement("a"),a=t.getContentSearcherOfCursor();i.textContent=n.originalUrl,i.href=n.normalizedUrl,t.runAsync((function(t){t.addUndoSnapshot((function(){return(0,r.replaceWithNode)(t,n.originalUrl,i,!1,null!=a?a:void 0),(0,o.clearEventDataCache)(e),i}),"AutoLink",!0)}))}}},l={keys:[8],shouldHandleEvent:function(e,t){var n=t.getContentSearcherOfCursor(e);return(null==n?void 0:n.getInlineElementBefore())instanceof o.LinkInlineElement},handleEvent:function(e,t){e.rawEvent.preventDefault(),(0,r.removeLink)(t)},defaultDisabled:!0};function s(e,t){return 0==e.eventType||7==e.eventType&&"Paste"==e.source?(0,o.cacheGetEventData)(e,"LINK_DATA",(function(){var n=7==e.eventType&&"Paste"==e.source&&e.data||null,r=(0,o.matchLink)(((null==n?void 0:n.text)||"").trim()),a=t.getContentSearcherOfCursor(e);if(r&&(null==a?void 0:a.getRangeFromText(r.originalUrl,!1)))return r;var l=a&&a.getWordBefore();if(l&&l.length>5){var s=(l.match(i)||[])[0]||"",u=l.substring(0,l.length-s.length);return["()","{}","[]"].forEach((function(e){u[u.length-1]==e[1]&&u.indexOf(e[0])<0&&(u=u.substr(0,u.length-1))})),(0,o.matchLink)(u)}return null})):null}t.AutoLinkFeatures={autoLink:a,unlinkWhenBackspaceAfterLink:l}},2056:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CodeFeatures=void 0;var r=n(6344),o={keys:[13],shouldHandleEvent:function(e,t){var n=a(e,t);return n&&(0,r.isNodeEmpty)(n)},handleEvent:function(e,t){e.rawEvent.preventDefault(),t.addUndoSnapshot((function(){l(e,t)}),void 0,!0)}},i={keys:[8],shouldHandleEvent:function(e,t){var n=a(e,t);return n&&(0,r.isNodeEmpty)(n)&&!n.previousSibling},handleEvent:function(e,t){e.rawEvent.preventDefault(),t.addUndoSnapshot((function(){return l(e,t)}))}};function a(e,t){return(0,r.cacheGetEventData)(e,"CODE_CHILD",(function(){var e,n=null!==(e=t.getElementAtCursor("code"))&&void 0!==e?e:t.queryElements("code",1)[0];if(n){var o=t.getFocusedPosition(),i=o&&t.getBlockElementAtNode(o.normalize().node);if(i){var a=i.getStartNode()==n.parentNode?i.getStartNode():i.collapseToSingleElement();return(0,r.isNodeEmpty)(a)?a:null}}return null}))}function l(e,t){var n=a(e,t);if((0,r.safeInstanceOf)(n,"HTMLElement")){var o=n.querySelector("code");if(o)(0,r.unwrap)(o);else{var i=(0,r.splitBalancedNodeRange)(n);if(i&&(0,r.unwrap)(i),(0,r.safeInstanceOf)(n.parentElement,"HTMLPreElement")){var l=(0,r.splitBalancedNodeRange)(n);l&&(0,r.unwrap)(l)}}t.select(n,0)}}t.CodeFeatures={removeCodeWhenEnterOnEmptyLine:o,removeCodeWhenBackspaceOnEmptyFirstLine:i}},7167:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CursorFeatures=void 0;var r=n(6344),o={keys:[37,39],allowFunctionKeys:!0,shouldHandleEvent:function(e,t,n){var o,i=null;if(!(n&&(i=t.getSelectionRange())&&i.collapsed&&(o=r.Position.getStart(i))&&t.isPositionAtBeginning(o)))return!1;var a="rtl"==(0,r.getComputedStyle)(o.element,"direction"),l=e.rawEvent;return!a&&37==l.which||a&&39==l.which},handleEvent:function(e){e.rawEvent.preventDefault()},defaultDisabled:!r.Browser.isChrome};t.CursorFeatures={noCycleCursorMove:o}},4397:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EntityFeatures=void 0;var r=n(7582),o=n(6344),i={keys:[13],shouldHandleEvent:function(e,t){return l(e,t)},handleEvent:function(e,t){l(e,t,1)}},a={keys:[27],shouldHandleEvent:function(e,t){return l(e,t)},handleEvent:function(e,t){l(e,t,3)}};function l(e,t,n){var r=(0,o.cacheGetEventData)(e,"READONLY_ENTITY_ELEMENT",(function(){var n=e.rawEvent.target,r=n&&t.getElementAtCursor((0,o.getEntitySelector)(),n);return r&&!r.isContentEditable?r:null}));if(r&&void 0!==n){var i=(0,o.getEntityFromElement)(r);i&&t.triggerPluginEvent(15,{operation:n,rawEvent:e.rawEvent,entity:i})}return r}var s={keys:[13],shouldHandleEvent:function(e,t){return c(e,t,!0,!1)},handleEvent:function(e,t){var n,r,i;e.rawEvent.preventDefault();var a=t.getSelectionRange();if(a){var l=o.Position.getEnd(a).normalize().node,s=t.getDocument().createElement("BR");null===(n=l.parentNode)||void 0===n||n.insertBefore(s,l.nextSibling);var u,d=t.getBlockElementAtNode(l);d&&(u=d.collapseToSingleElement(),null===(r=s.parentNode)||void 0===r||r.removeChild(s)),null===(i=t.getSelectionRange())||void 0===i||i.deleteContents(),(null==u?void 0:u.nextSibling)&&t.select(u.nextSibling,0)}}},u={keys:[8],shouldHandleEvent:function(e,t){return c(e,t,!1,!0)},handleEvent:function(e,t){c(e,t,!1,!0,5)}},d={keys:[46],shouldHandleEvent:function(e,t){return c(e,t,!0,!0)},handleEvent:function(e,t){c(e,t,!0,!0,4)}};function c(e,t,n,r,i){var a=(0,o.cacheGetEventData)(e,"NEIGHBOR_ENTITY_ELEMENT_"+n+"_"+r,(function(){var e,i=t.getSelectionRange();if(!i||r&&!i.collapsed)return null;var a=null===(e=t.getSelectedRegions()[0])||void 0===e?void 0:e.rootNode;i.commonAncestorContainer.normalize();var l=o.Position.getEnd(i).normalize(),s=null;if((0==l.offset||l.isAtEnd)&&a){var u=o.ContentTraverser.createBodyTraverser(a,l.node),d=n?0==l.offset?u.currentInlineElement:u.getNextInlineElement():l.isAtEnd?u.currentInlineElement:u.getPreviousInlineElement(),c=d&&d.getContainerNode();if(!r){var f=t.getBlockElementAtNode(l.node);(!f||c&&!f.contains(c))&&(c=null)}s=c&&t.getElementAtCursor((0,o.getEntitySelector)(),c)}return s}));if(a&&void 0!==i){var l=(0,o.getEntityFromElement)(a);l&&y(l,t,i,e)}return a}var f={keys:[39,37],allowFunctionKeys:!0,shouldHandleEvent:function(e,t){if(e.rawEvent.altKey)return!1;var n=t.getElementAtCursor();return!!n&&v(e,t,"rtl"===(0,o.getComputedStyle)(n,"direction")==(37===e.rawEvent.which))},handleEvent:function(e,t){var n=b(e),r=g(e,n);if(r){var i=E(r,n,t),a=i.delimiterPair,l=i.entity;a&&l&&(0,o.matchesSelector)(l,(0,o.getEntitySelector)())&&(e.rawEvent.preventDefault(),t.runAsync((function(){var r=n?e.rawEvent.shiftKey?-3:-1:-2,i=new o.Position(a,r);if(e.rawEvent.shiftKey){var l=a.ownerDocument.getSelection();null==l||l.extend(i.node,i.offset)}else t.select(i)})))}}},p={keys:[8,46],shouldHandleEvent:function(e,t){var n=t.getSelectionRange();if(!(null==n?void 0:n.collapsed))return!1;var r=46===e.rawEvent.which;if(v(e,t,r)){var o=g(e,r);return!!m(e,t,r,r?null==o?void 0:o.nextElementSibling:null==o?void 0:o.previousElementSibling)}return!1},handleEvent:function(e,t){var n=46===e.rawEvent.which;m(e,t,n,null,n?4:5)}};function v(e,t,n){var r,o=null===(r=t.getFocusedPosition())||void 0===r?void 0:r.normalize();if(b(e,n),!o)return!1;var i=3==o.node.nodeType?o.node:o.node==o.element?o.element.childNodes.item(o.offset):o.element,a=n?{class:"entityDelimiterBefore",pairClass:"entityDelimiterAfter",isAtEndOrBeginning:o.isAtEnd}:{class:"entityDelimiterAfter",pairClass:"entityDelimiterBefore",isAtEndOrBeginning:0==o.offset},l=function(e,t,n){var r=h(e,t);if(r){for(var o,i=r.currentInlineElement;i&&i.getContainerNode()===t;)o=r,i=n?o.getNextInlineElement():o.getPreviousInlineElement();return null==i?void 0:i.getContainerNode()}}(t,i,n);if(a.isAtEndOrBeginning&&l){var s=t.getElementAtCursor("."+a.class,l);if(s&&u(s))return!0}return!!u(i&&t.getElementAtCursor("."+a.class,i));function u(r){if(!r)return!1;var o=E(r,n,t).delimiterPair;return o&&(o.className||"").indexOf(a.pairClass)>-1&&g(e,n,r)}}function h(e,t){var n;if(t){var r=null===(n=e.getBlockElementAtNode(t))||void 0===n?void 0:n.getStartNode();if(r&&(0,o.isBlockElement)(r))return o.ContentTraverser.createBodyTraverser(r,t)}}function g(e,t,n){return(0,o.cacheGetEventData)(e,"delimiter_cache_key_"+t,(function(){return n}))}function m(e,t,n,r,i){var a=(0,o.cacheGetEventData)(e,"entity_delimiter_cache_key_"+n,(function(){return r&&t.getElementAtCursor((0,o.getEntitySelector)(),r)}));if(a&&void 0!==i){var l=(0,o.getEntityFromElement)(a);l&&y(l,t,i,e)}return a}function y(e,t,n,i){var a=e.wrapper,l=a.nextElementSibling,s=a.previousElementSibling;t.triggerPluginEvent(15,{operation:n,rawEvent:i.rawEvent,entity:e}),e.isReadonly&&!(0,o.isBlockElement)(e.wrapper)&&(i.rawEvent.defaultPrevented?t.runAsync((function(){if(t.contains(e.wrapper)){var n=(0,r.__read)((0,o.addDelimiters)(e.wrapper),1)[0];n&&t.select(n,-3)}else!function(e,t){[e,t].forEach((function(e){var t;(0,o.getDelimiterFromElement)(e)&&(null===(t=null==e?void 0:e.parentElement)||void 0===t||t.removeChild(e))}))}(l,s)})):(0,o.getDelimiterFromElement)(l)&&(0,o.getDelimiterFromElement)(s)&&t.select((0,o.createRange)(s,l)))}function b(e,t){return!!(0,o.cacheGetEventData)(e,"Check_Before",(function(){return t}))}function E(e,t,n){var r=null,i=null,a=h(n,e);if(!a)return{delimiterPair:i,entity:r};for(var l,s="."+(t?"entityDelimiterAfter":"entityDelimiterBefore"),u=function(e,t){var r,o=null==e?void 0:e.getContainerNode();return null!==(r=o&&n.getElementAtCursor(t,o))&&void 0!==r?r:null},d=(0,o.getEntitySelector)(),c=a.currentInlineElement;c&&(!r||!i);){if(r=r||u(c,d),i=i||u(c,s),r){if(!i&&!u(c,d)){i=null;break}i&&!i.isContentEditable&&(i=null)}l=a,c=t?l.getNextInlineElement():l.getPreviousInlineElement()}return{entity:r,delimiterPair:i}}t.EntityFeatures={clickOnEntity:i,escapeFromEntity:a,enterBeforeReadonlyEntity:s,backspaceAfterEntity:u,deleteBeforeEntity:d,moveBetweenDelimitersFeature:f,removeEntityBetweenDelimiters:p}},7018:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ListFeatures=void 0;var r=n(5938),o=n(3279),i=n(1892),a=n(6344),l=n(4548),s="previousBlock",u="nextBlock",d=(0,a.createObjectDefinition)({orderedStyleType:(0,a.createNumberDefinition)(!0,void 0,1,20),unorderedStyleType:(0,a.createNumberDefinition)(!0,void 0,1,9)},!0,!0),c=function(e){return function(t,n){var r=t.rawEvent,o=r.keyCode,i=r.altKey,a=r.shiftKey,l=r.ctrlKey,s=r.metaKey;return!l&&!s&&(9===o?!i&&a===!e:a&&i&&o===(e?39:37))&&A(t,n)}},f=function(e){return function(t,n){var o=null,i=9!==t.rawEvent.keyCode&&(o=n.getElementAtCursor())&&"rtl"==(0,a.getComputedStyle)(o,"direction");n.addUndoSnapshot((function(){(0,l.setIndentation)(n,i==e?1:0)}),"Format",!1,{getAnnounceData:function(){return(0,r.default)(n.getElementAtCursor("OL,UL"),n.getElementAtCursor("LI"))}}),t.rawEvent.preventDefault()}},p={keys:[9],shouldHandleEvent:c(!0),handleEvent:f(!0)},v={keys:[9],shouldHandleEvent:c(!1),handleEvent:f(!1),allowFunctionKeys:!0},h={keys:[39],shouldHandleEvent:c(!0),handleEvent:f(!0),allowFunctionKeys:!0,defaultDisabled:a.Browser.isMac},g={keys:[37],shouldHandleEvent:c(!1),handleEvent:f(!1),allowFunctionKeys:!0,defaultDisabled:a.Browser.isMac},m={keys:[8],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",void 0,e),r=t.getSelectionRange();return n&&(null==r?void 0:r.collapsed)&&(0,a.isPositionAtBeginningOf)(a.Position.getStart(r),n)},handleEvent:function(e,t){var n=t.getElementAtCursor("LI",void 0,e);(null==n?void 0:n.previousSibling)?(0,l.blockFormat)(t,(function(r,o,i){var l=(0,a.createVListFromRegion)(r,!1,null!=n?n:void 0);l&&o&&i&&(l.setIndentation(o,i,1,!0),l.writeBack(t.isFeatureEnabled("ReuseAllAncestorListElements"),t.isFeatureEnabled("DisableListChain")),e.rawEvent.preventDefault())})):D(e,t)},defaultDisabled:!0},y={keys:[8],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",void 0,e);return n&&(0,a.isNodeEmpty)(n)&&!n.previousSibling&&!n.getElementsByTagName("blockquote").length},handleEvent:D},b={keys:[46],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",void 0,e),r=t.getSelectionRange();if(n||!r)return!1;var o=a.Position.getEnd(r).isAtEnd?function(e,t){var n=(0,a.cacheGetEventData)(e,"nextSibling",(function(){var e,n=t.getSelectionRange(),r=n&&a.Position.getEnd(n).normalize(),o=r&&t.getBodyTraverser(r.node);return null===(e=null==o?void 0:o.getNextBlockElement())||void 0===e?void 0:e.getStartNode()}));return n}(e,t):void 0;return t.getElementAtCursor("LI",o,e)},handleEvent:function(e,t){var n=O(t);t.runAsync((function(e){return(0,l.commitListChains)(e,n)}))}},E={keys:[13],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",void 0,e);return!e.rawEvent.shiftKey&&n&&(0,a.isNodeEmpty)(n)},handleEvent:function(e,t){t.addUndoSnapshot((function(){return D(e,t,!1)}),void 0,!0)},defaultDisabled:!a.Browser.isIE&&!a.Browser.isChrome},C={keys:[32],shouldHandleEvent:function(e,t){return!A(e,t)&&L(e,t,o.default,2)},handleEvent:function(e,t){t.insertContent("&nbsp;"),e.rawEvent.preventDefault(),t.addUndoSnapshot((function(){var e,n=t.getContentSearcherOfCursor();if(n){var r=n.getSubStringBefore(5),i=n.getRangeFromText(r,!0),a=(0,o.default)(r);i&&(M(t,i),(0,l.toggleBullet)(t,null!=a?a:void 0,"autoToggleList")),null===(e=n.getRangeFromText(r,!0))||void 0===e||e.deleteContents()}}),void 0,!0)}},S={keys:[32],shouldHandleEvent:function(e,t){return!A(e,t)&&L(e,t,i.default,1)},handleEvent:function(e,t){t.insertContent("&nbsp;"),e.rawEvent.preventDefault(),t.addUndoSnapshot((function(){var e,n,r=t.getContentSearcherOfCursor();if(r){var o=r.getSubStringBefore(5),a=r.getRangeFromText(o,!0);if(a){var s=_(o)?1:parseInt(o),u=T(t,a),d=null!==(e=(0,i.default)(o))&&void 0!==e?e:void 0;M(t,a),(0,l.toggleNumbering)(t,u&&1!==s?void 0:s,d,"autoToggleList")}null===(n=r.getRangeFromText(o,!0))||void 0===n||n.deleteContents()}}),void 0,!0)}},T=function(e,t){var n,r=e.getBodyTraverser(null==t?void 0:t.startContainer).getPreviousBlockElement(),o=null!==(n=null==r?void 0:r.getEndNode())&&void 0!==n?n:null;return"LI"===(0,a.getTagOfNode)(o)?o:void 0},P=function(e,t,n){var r=1===n?"orderedStyleType":"unorderedStyleType",o=T(e,t),i=o?(0,a.findClosestElementAncestor)(o,void 0,1===n?"ol":"ul"):null,l=i?(0,a.getMetadata)(i,d):null;return l?l[r]:null},_=function(e){var t=parseInt(e);if(t&&1===t)return 1;var n=e.replace(/\(|\)|\-|\./g,"").trim();return 1===n.length&&["i","a","I","A"].indexOf(n)>-1?1:void 0},w={keys:[13,9,46,8,258],shouldHandleEvent:function(e,t){return t.queryElements("li",1).filter((function(e){return!e.getElementsByTagName("blockquote").length})).length>0},handleEvent:function(e,t){var n=O(t);t.runAsync((function(e){return(0,l.commitListChains)(e,n)}))}};function O(e){return a.VListChain.createListChains(e.getSelectedRegions())}function M(e,t){var n,r=e.getBlockElementAtNode(t.startContainer),o=null==r?void 0:r.getEndNode();if(o&&"BR"!=(0,a.getTagOfNode)(o)){var i=e.getDocument().createElement("BR");(0,a.isBlockElement)(o)?o.appendChild(i):null===(n=o.parentNode)||void 0===n||n.insertBefore(i,o.nextSibling),e.select(t.startContainer,t.startOffset)}}function D(e,t,n){void 0===n&&(n=!0);var r=A(e,t);if(r){var o=r[0],i=(0,a.getTagOfNode)(o);"UL"!=i&&"OL"!=i||(0,l.toggleListType)(t,"UL"==i?2:1,void 0,n),t.focus(),e.rawEvent.preventDefault()}}function A(e,t){var n=t.getElementAtCursor("LI,TABLE",void 0,e),r=n&&"LI"==(0,a.getTagOfNode)(n)&&t.getElementAtCursor("UL,OL",n);return r?[r,n]:null}function L(e,t,n,r){var o=t.getContentSearcherOfCursor(e);if(!o)return!1;var i=o.getSubStringBefore(4),a=t.getBlockTraverser(),l=a&&a.currentBlockElement?a.currentBlockElement.getTextContent().slice(0,i.length):null,s=l&&l===i,u=O(t),d=o.getRangeFromText(i,!0),c=d&&P(t,d,r),f=_(i),p=n(i,u,null!=c?c:void 0),v=f||!c||c===p||2===r;return s&&!o.getNearestNonTextInlineElement()&&p&&v}var R={keys:[8],shouldHandleEvent:function(e,t){var n,r,o=t.getElementAtCursor();if(o){var i=null===(n=t.getBlockElementAtNode(o))||void 0===n?void 0:n.getStartNode(),l=null!==(r=null==i?void 0:i.previousElementSibling)&&void 0!==r?r:null;if(I(l)){var d=t.getSelectionRange(),c=t.getContentSearcherOfCursor(e),f=null==c?void 0:c.getSubStringBefore(4),p=null==c?void 0:c.getNearestNonTextInlineElement();if(d&&d.collapsed&&""===f&&!p){var v=null==i?void 0:i.nextElementSibling,h=I(v)?v:null==v?void 0:v.firstChild;if(I(h)&&(0,a.getTagOfNode)(l)==(0,a.getTagOfNode)(h)){var g=(0,a.cacheGetEventData)(e,s,(function(){return l})),m=(0,a.cacheGetEventData)(e,u,(function(){return h}));return!!g&&!!m}}}}return!1},handleEvent:function(e,t){t.runAsync((function(t){var n=(0,a.cacheGetEventData)(e,s,(function(){return null})),r=(0,a.cacheGetEventData)(e,u,(function(){return null})),o=t.getSelectionRange();if(n&&r&&o){var i=new a.VList(n);i.mergeVList(new a.VList(r));var l=t.getDocument().createElement("span");l.id="restoreRange",o.insertNode(l),i.writeBack(),(l=t.queryElements("#restoreRange")[0]).parentElement&&(t.select(new a.Position(l,-3)),l.parentElement.removeChild(l))}}))}};function I(e){return!!e&&((0,a.safeInstanceOf)(e,"HTMLOListElement")||(0,a.safeInstanceOf)(e,"HTMLUListElement"))}t.ListFeatures={autoBullet:{keys:[32],shouldHandleEvent:function(e,t){return!1},handleEvent:function(e,t){},defaultDisabled:!0},indentWhenTab:p,outdentWhenShiftTab:v,outdentWhenBackspaceOnEmptyFirstLine:y,outdentWhenEnterOnEmptyLine:E,mergeInNewLineWhenBackspaceOnFirstChar:m,maintainListChain:w,maintainListChainWhenDelete:b,autoNumberingList:S,autoBulletList:C,mergeListOnBackspaceAfterList:R,outdentWhenAltShiftLeft:g,indentWhenAltShiftRight:h}},57:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MarkdownFeatures=void 0;var r=n(6344);function o(e,t,n,o){return{keys:[e],shouldHandleEvent:function(e,n){return e.rawEvent.shiftKey===o&&!!i(e,n,t)},handleEvent:function(e,o){o.runAsync((function(o){!function(e,t,n,o){t.addUndoSnapshot((function(){var a=i(e,t,n);if(a){var l=new r.Position(a.endContainer,-1),s=a.endOffset+1<=l.offset;if(a&&s){var u=a.cloneRange();u.setStart(u.startContainer,u.startOffset+1);var d=u.extractContents().textContent,c=t.getDocument().createTextNode(null!=d?d:""),f=(0,r.wrap)(c,o);a.setEnd(a.endContainer,a.endOffset+1),a.deleteContents();var p=t.getDocument().createTextNode("​");a.insertNode(p),a.insertNode(f),t.select(p,-1)}}}),"Format",!0)}(e,o,t,n)}))}}}function i(e,t,n){return(0,r.cacheGetEventData)(e,"MARKDOWN_RANGE",(function(){var o=t.getContentSearcherOfCursor(e),i=null,a=null;return null==o||o.forEachTextInlineElement((function(e){if(a&&i)return!0;var t=e.getTextContent();if(0==t[t.length-1].trim().length)return!1;var r=e.getParentBlock().getTextContent();if(r[r.length-1].trim()===n)return!1;if(a||(a=e.getStartPosition().move(t.length)),t[0]==n)i=e.getStartPosition();else for(var o=t.length-1;o>0;o--){if(i)return!0;if(t[o]==n&&0==t[o-1].trim().length)return i=e.getStartPosition().move(o),!0}})),i&&a&&(0,r.createRange)(i,a)}))}var a=o(56,"*","b",!0),l=o(189,"_","i",!0),s=o(192,"~","s",!0),u=o(192,"`","code",!1);t.MarkdownFeatures={markdownBold:a,markdownItalic:l,markdownStrikethru:s,markdownInlineCode:u}},1495:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuoteFeatures=void 0;var r=n(4548),o=n(6344),i="BLOCKQUOTE",a=[i,"LI","TD","TH"].join(","),l={keys:[8],shouldHandleEvent:function(e,t){var n=u(e,t);return n&&(0,o.isNodeEmpty)(n)&&!n.previousSibling},handleEvent:d},s={keys:[13],shouldHandleEvent:function(e,t){var n=u(e,t);return!e.rawEvent.shiftKey&&n&&(0,o.isNodeEmpty)(n)},handleEvent:function(e,t){return t.addUndoSnapshot((function(){return d(e,t)}),void 0,!0)}};function u(e,t){return(0,o.cacheGetEventData)(e,"QUOTE_CHILD",(function(){var e=t.getElementAtCursor(a);if(e&&(0,o.getTagOfNode)(e)==i){var n=t.getFocusedPosition(),r=n&&t.getBlockElementAtNode(n.normalize().node);if(r){var l=r.getStartNode()==e?r.getStartNode():r.collapseToSingleElement();return(0,o.isNodeEmpty)(l)?l:null}}return null}))}function d(e,t){t.addUndoSnapshot((function(){var n=u(e,t);if(n){(0,o.getTagOfNode)(n)==i&&(n=(0,o.wrap)((0,o.toArray)(n.childNodes)));var a=(0,o.splitBalancedNodeRange)(n),l=!!a&&c(a),s=a&&(0,o.unwrap)(a);t.select(n,0),l&&((0,o.safeInstanceOf)(s,"HTMLLIElement")&&s.style.removeProperty("color"),(0,r.clearFormat)(t))}})),e.rawEvent.preventDefault()}var c=function(e){return!!(e&&(0,o.safeInstanceOf)(e,"HTMLQuoteElement")&&e.style.borderLeft&&e.style.borderColor&&e.style.paddingLeft&&e.style.color)};t.QuoteFeatures={unquoteWhenBackspaceOnEmptyFirstLine:l,unquoteWhenEnterOnEmptyLine:s}},9187:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShortcutFeatures=void 0;var r=n(6344),o=n(4548);function i(e,t,n,r){return void 0===r&&(r=!1),r?null:{winKey:e,macKey:t,action:n}}var a=[i(4162,8258,o.toggleBold),i(4169,8265,o.toggleItalic),i(4181,8277,o.toggleUnderline),i(4128,8224,o.clearFormat),i(4186,8282,(function(e){return e.undo()})),i(26,26,(function(e){return e.undo()}),r.Browser.isMac),i(4185,24666,(function(e){return e.redo()})),i(4286,8382,o.toggleBullet),i(4287,8383,o.toggleNumbering),i(20670,24766,(function(e){return(0,o.changeFontSize)(e,0)})),i(20668,24764,(function(e){return(0,o.changeFontSize)(e,1)}))].filter((function(e){return!!e})),l={allowFunctionKeys:!0,keys:[66,73,85,89,90,188,190,191,32,8],shouldHandleEvent:s,handleEvent:function(e,t){var n=s(e);n&&(n.action(t),e.rawEvent.preventDefault(),e.rawEvent.stopPropagation())}};function s(e){return(0,r.cacheGetEventData)(e,"DEFAULT_SHORT_COMMAND",(function(){var t=e.rawEvent,n=0!=e.eventType||t.getModifierState("AltGraph")?0:t.which|(t.metaKey&&8192)|(t.shiftKey&&16384)|(t.ctrlKey&&4096)|(t.altKey&&18);return n&&a.filter((function(e){return(r.Browser.isMac?e.macKey:e.winKey)==n}))[0]}))}t.ShortcutFeatures={defaultShortcut:l}},2828:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StructuredNodeFeatures=void 0;var r=n(6344),o={TD:"TABLE",TH:"TABLE",LI:"OL,UL"},i=(0,r.getObjectKeys)(o).join(","),a={keys:[13],shouldHandleEvent:l,handleEvent:function(e,t){var n=l(e,t),o=(0,r.createElement)(1,t.getDocument());t.addUndoSnapshot((function(){var e;null===(e=null==n?void 0:n.parentNode)||void 0===e||e.insertBefore(o,n),"TABLE"==(0,r.getTagOfNode)(n)&&t.select(new r.Position(o,0).normalize())})),e.rawEvent.preventDefault()},defaultDisabled:!0};function l(e,t){return(0,r.cacheGetEventData)(e,"FIRST_STRUCTURE",(function(){var n=e.rawEvent.shiftKey?null:t.getElementAtCursor(i);if(n){var a=t.getSelectionRange();if(a&&a.collapsed&&(0,r.isPositionAtBeginningOf)(r.Position.getStart(a),n)&&!t.getBodyTraverser(n).getPreviousBlockElement())return t.getElementAtCursor(o[(0,r.getTagOfNode)(n)])}return null}))}t.StructuredNodeFeatures={insertLineBeforeStructuredNodeFeature:a}},4683:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableFeatures=void 0;var r=n(4548),o=n(6344),i={keys:[9],shouldHandleEvent:function(e,t){return u(e,t)&&!d(e,t)},handleEvent:function(e,t){var n,i,a,l=e.rawEvent.shiftKey,s=u(e,t);if(s){for(var d=c(e,s),f=l?-1:1,p=null!==(n=d.row)&&void 0!==n?n:0,v=(null!==(i=d.col)&&void 0!==i?i:0)+f;;v+=f){var h=null!==(a=d.cells)&&void 0!==a?a:[];if(v<0||v>=h[p].length){if((p+=f)<0){t.select(d.table,-2);break}if(p>=h.length){(0,r.editTable)(t,1);break}v=l?h[p].length-1:0}var g=d.getCell(p,v);if(g.td){var m=new o.Position(g.td,0).normalize();t.select(m);break}}e.rawEvent.preventDefault()}}},a={keys:[9],shouldHandleEvent:function(e,t){return u(e,t)&&d(e,t)},handleEvent:function(e,t){e.rawEvent.preventDefault(),t.addUndoSnapshot((function(){var n=e.rawEvent.shiftKey,o=t.getSelectionRangeEx(),i=u(e,t);if(i){var a=c(e,i);n&&t.getElementAtCursor("blockquote",a.table,e)?(0,r.setIndentation)(t,1):n||(0,r.setIndentation)(t,0),o.coordinates&&t.select(o.table,o.coordinates)}}))}},l={keys:[38,40],shouldHandleEvent:function(e,t){return u(e,t)&&!d(e,t)},handleEvent:function(e,t){var n,r,i,a=u(e,t);if(a){var l=new o.VTable(a),s=38==e.rawEvent.which,d=s?-1:1,c=e.rawEvent.shiftKey,f=null===(n=t.getDocument().defaultView)||void 0===n?void 0:n.getSelection(),p=null;if(f){for(var v=f.anchorNode,h=f.anchorOffset,g=null!==(r=l.row)&&void 0!==r?r:0;g>=0&&l.cells&&g<l.cells.length;g+=d){var m=l.getCell(g,null!==(i=l.col)&&void 0!==i?i:0);if(m.td&&m.td!=a){p=m.td;break}}t.runAsync((function(e){var t,n=e.getElementAtCursor();if((0,o.contains)(l.table,n)&&!(0,o.contains)(a,n,!0)){var r=p?new o.Position(p,0):new o.Position(l.table,s?-2:-3);if(c){r=1==r.node.nodeType&&(0,o.isVoidHtmlElement)(r.node)?new o.Position(r.node,r.isAtEnd?-3:-2):r;var i=null===(t=e.getDocument().defaultView)||void 0===t?void 0:t.getSelection();v&&(null==i||i.setBaseAndExtent(v,h,r.node,r.offset))}else e.select(r.normalize())}}))}}}},s={keys:[8],shouldHandleEvent:function(e,t){return t.isFeatureEnabled("DeleteTableWithBackspace")&&d(e,t)},handleEvent:function(e,t){var n=u(e,t);if(n){var r=new o.VTable(n);r.edit(4),r.writeBack()}}};function u(e,t){return(0,o.cacheGetEventData)(e,"TABLE_CELL_FOR_TABLE_FEATURES",(function(){var e=t.getFocusedPosition(),n=e&&t.getElementAtCursor("TD,TH,LI",e.node);return n&&("LI"==(0,o.getTagOfNode)(n)?null:n)}))}function d(e,t){return(0,o.cacheGetEventData)(e,"WHOLE_TABLE_SELECTED_FOR_FEATURES",(function(){var n=u(e,t);if(!n)return!1;var r=c(e,n),i=t.getSelectionRangeEx();return 1==i.type&&i.coordinates&&(0,o.isWholeTableSelected)(r,i.coordinates)}))}function c(e,t){return(0,o.cacheGetEventData)(e,"VTABLE_FOR_TABLE_FEATURES",(function(){return new o.VTable(t)}))}t.TableFeatures={tabInTable:i,upDownInTable:l,indentTableOnTab:a,deleteTableWithBackspace:s}},3171:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextFeatures=void 0;var r=n(4548),o=n(6344),i={keys:[9],shouldHandleEvent:function(e,t){if(t.isFeatureEnabled("TabKeyTextFeatures")&&!e.rawEvent.shiftKey){var n=t.getDocument().activeElement,r=t.getElementAtCursor("LI,TABLE",void 0,e),i=t.getElementAtCursor((0,o.getEntitySelector)(),void 0,e);return!r&&(i?i.isContentEditable:n.isContentEditable)}return!1},handleEvent:function(e,t){var n=t.getSelectionRangeEx();0==n.type&&(t.addUndoSnapshot((function(){if(n.areAllCollapsed)u(t,e);else{var i=n.ranges,a=i[0];if(l(t,a))(0,r.setIndentation)(t,0);else{var s=(0,o.createRange)(a.startContainer,a.startOffset);i.forEach((function(e){return e.deleteContents()})),t.select(s),u(t,e)}}})),e.rawEvent.preventDefault())}},a={keys:[9],shouldHandleEvent:function(e,t){if(e.rawEvent.shiftKey&&t.isFeatureEnabled("TabKeyTextFeatures")){var n=t.getSelectionRangeEx();return 0==n.type&&!n.areAllCollapsed&&t.getElementAtCursor("blockquote",void 0,e)&&!t.getElementAtCursor("LI,TABLE",void 0,e)&&l(t,n.ranges[0])}return!1},handleEvent:function(e,t){t.addUndoSnapshot((function(){return(0,r.setIndentation)(t,1)})),e.rawEvent.preventDefault()}};function l(e,t){var n=!1,r=o.Position.getStart(t),i=o.Position.getEnd(t),a=e.getBlockElementAtNode(r.node),l=e.getBlockElementAtNode(i.node);if(!a||!l)return!1;if(a.equals(l)){var u=new o.Position(a.getStartNode(),0),d=new o.Position(a.getEndNode(),-1),c=(0,o.createRange)(u,o.Position.getStart(t)),f=(0,o.createRange)(o.Position.getEnd(t),d);return!n&&s(c)&&s(f)&&(n=!0),n}return!0}function s(e){return""==e.toString()&&0==(0,o.queryElements)(e.commonAncestorContainer,"img,table,ul,ol",null,2,e).length}function u(e,t){var n=e.getDocument().createElement("span"),r=e.getContentSearcherOfCursor(t);if(r){for(var i=6-r.getSubStringBefore(Number.MAX_SAFE_INTEGER).length%6,a=null,l="",s=0;s<i;s++)l+="&ensp;";e.insertNode(n),n.nextElementSibling&&"A"==(0,o.getTagOfNode)(n.nextElementSibling)&&((a=e.getDocument().createElement("span")).textContent=" ",e.insertNode(a),e.select((0,o.createRange)(a,-2))),e.insertContent(l,{position:5,range:(0,o.createRange)(n,0),updateCursor:!1}),e.select((0,o.createRange)(n,-3)),a&&e.deleteNode(a)}}t.TextFeatures={indentWhenTabText:i,outdentWhenTabText:a,autoHyphen:{keys:[],shouldHandleEvent:function(e,t){return!1},handleEvent:function(e,t){return!1},defaultDisabled:!0}}},692:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7582),o=n(7539),i=n(2056),a=n(7167),l=n(4397),s=n(7018),u=n(57),d=n(1495),c=n(9187),f=n(2828),p=n(4683),v=n(3171),h=(0,r.__assign)((0,r.__assign)((0,r.__assign)((0,r.__assign)((0,r.__assign)((0,r.__assign)((0,r.__assign)((0,r.__assign)((0,r.__assign)((0,r.__assign)((0,r.__assign)({},s.ListFeatures),d.QuoteFeatures),p.TableFeatures),f.StructuredNodeFeatures),o.AutoLinkFeatures),c.ShortcutFeatures),a.CursorFeatures),u.MarkdownFeatures),l.EntityFeatures),v.TextFeatures),i.CodeFeatures);t.default=function(){return h}},9025:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAllFeatures=t.ContentEdit=void 0;var r=n(678);Object.defineProperty(t,"ContentEdit",{enumerable:!0,get:function(){return r.default}});var o=n(692);Object.defineProperty(t,"getAllFeatures",{enumerable:!0,get:function(){return o.default}})},4239:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.toLocaleLowerCase();if(t){var n=t.length-1;return 26*n+t.charCodeAt(n)-96}return null}},3279:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={"*":1,"-":2,"--":3,"->":5,"--\x3e":8,"=>":6,">":4,"—":7};t.default=function(e){var t=e.trim();return n[t]||null}},1892:(e,t,n)=>{"use strict";var r,o,i,a,l,s;Object.defineProperty(t,"__esModule",{value:!0});var u,d,c=n(4239);!function(e){e[e.Decimal=1]="Decimal",e[e.LowerAlpha=2]="LowerAlpha",e[e.UpperAlpha=3]="UpperAlpha",e[e.LowerRoman=4]="LowerRoman",e[e.UpperRoman=5]="UpperRoman"}(u||(u={})),function(e){e[e.Dot=1]="Dot",e[e.Dash=2]="Dash",e[e.Parenthesis=3]="Parenthesis",e[e.DoubleParenthesis=4]="DoubleParenthesis"}(d||(d={}));var f={".":1,"-":2,")":3},p=[13,16,15,14],v=[17,20,19,18],h=["1","a","A","I","i"],g=["i","v","x","l","c","d","m"],m=["I","V","X","L","C","D","M"],y=((r={})[1]=function(e){return T[e]||null},r[2]=function(e){return S[e]||null},r[3]=function(e){return C[e]||null},r[4]=function(e){return E[e]||null},r[5]=function(e){return b[e]||null},r),b=((o={})[1]=17,o[2]=20,o[3]=18,o[4]=19,o),E=((i={})[1]=13,i[2]=16,i[3]=14,i[4]=15,i),C=((a={})[1]=9,a[2]=12,a[3]=10,a[4]=11,a),S=((l={})[1]=5,l[2]=8,l[3]=6,l[4]=7,l),T=((s={})[1]=1,s[2]=2,s[3]=3,s[4]=4,s);t.default=function(e,t,n){var r,o=e.trim(),i="("===o[0]&&")"===o[o.length-1],a=i?o.slice(1,-1):o.slice(0,-1),l=parseInt(a),s=isNaN(l)?(0,c.default)(a):l;return!s||s<1||t&&s>1&&(t.length<1&&h.indexOf(a)<0||(null==t?void 0:t.length)>0&&!(null===(r=t[t.length-1])||void 0===r?void 0:r.canAppendAtCursor(s)))?null:function(e){return Number(e)||/^[A-Za-z\s]*$/.test(e)}(a)?function(e,t,n){var r=t?4:f[e[e.length-1]];if(r){var o=function(e,t){if(!isNaN(parseInt(e)))return 1;if(/[a-z]+/g.test(e)){if(null!=t&&p.indexOf(t)>-1&&g.indexOf(e[0])>-1||!t&&"i"===e)return 4;if(t||!t&&"a"===e)return 2}else if(/[A-Z]+/g.test(e)){if(null!=t&&v.indexOf(t)>-1&&m.indexOf(e[0])>-1||!t&&"I"===e)return 5;if(t||!t&&"A"===e)return 3}}(t?e.slice(1,-1):e.slice(0,-1),n);return o?y[o](r):null}return null}(o,i,n):null}},5713:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6344),o=function(){function e(e){var t=this;this.options=e,this.container=null,this.editor=null,this.isMenuShowing=!1,this.onDismiss=function(){var e,n;t.container&&t.isMenuShowing&&(null===(n=(e=t.options).dismiss)||void 0===n||n.call(e,t.container),t.isMenuShowing=!1)}}return e.prototype.getName=function(){return"ContextMenu"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){var e;this.onDismiss(),(null===(e=this.container)||void 0===e?void 0:e.parentNode)&&(this.container.parentNode.removeChild(this.container),this.container=null),this.editor=null},e.prototype.onPluginEvent=function(e){if(16==e.eventType&&e.items.length>0){var t=e.rawEvent,n=e.items;this.onDismiss(),this.options.allowDefaultMenu||t.preventDefault(),this.initContainer(t.pageX,t.pageY)&&(this.options.render(this.container,n,this.onDismiss),this.isMenuShowing=!0)}},e.prototype.initContainer=function(e,t){var n,o;return!this.container&&this.editor&&(this.container=(0,r.createElement)(5,this.editor.getDocument()),this.editor.getDocument().body.appendChild(this.container)),null===(n=this.container)||void 0===n||n.style.setProperty("left",e+"px"),null===(o=this.container)||void 0===o||o.style.setProperty("top",t+"px"),!!this.container},e}();t.default=o},936:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContextMenu=void 0;var r=n(5713);Object.defineProperty(t,"ContextMenu",{enumerable:!0,get:function(){return r.default}})},2522:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7582),o=function(e,t,n,r){return{sourceString:e,replacementHTML:t,matchSourceCaseSensitive:n,shouldReplace:r}},i=[o(":)","🙂",!0),o(";)","😉",!0),o(":O","😲",!0),o(":o","😯",!0),o("<3","❤️",!0)],a=function(){function e(e){void 0===e&&(e=i),this.longestReplacementLength=null,this.editor=null,this.replacements=null,this.replacementEndCharacters=null,this.updateReplacements(e)}return e.prototype.updateReplacements=function(e){var t;this.replacements=e,this.longestReplacementLength=(t=this.replacements,Math.max.apply(null,t.map((function(e){return e.sourceString.length})))),this.replacementEndCharacters=function(e){var t,n,o=new Set;try{for(var i=(0,r.__values)(e),a=i.next();!a.done;a=i.next()){var l=a.value,s=l.sourceString;if(0!=s.length){var u=s[s.length-1];l.matchSourceCaseSensitive?o.add(u):(o.add(u.toLocaleLowerCase()),o.add(u.toLocaleUpperCase()))}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return o}(this.replacements)},e.prototype.getName=function(){return"CustomReplace"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){var t,n=this;if(3==e.eventType&&this.editor&&!this.editor.isInIME()&&e.rawEvent.data&&(null===(t=this.replacementEndCharacters)||void 0===t?void 0:t.has(e.rawEvent.data))){var r=this.editor.getContentSearcherOfCursor(e);if(r&&null!=this.longestReplacementLength){var o=r.getSubStringBefore(this.longestReplacementLength),i=this.getMatchingReplacement(o);if(i&&(!i.shouldReplace||!r||i.shouldReplace(i,r.getWordBefore(),this.editor))){var a=r.getSubStringBefore(i.sourceString.length),l=r.getRangeFromText(a,!0),s=this.editor.getDocument().createElement("span");s.innerHTML=this.editor.getTrustedHTMLHandler()(i.replacementHTML);var u=1==s.childNodes.length?s.childNodes[0]:s;l&&this.editor.addUndoSnapshot((function(){var e;l.deleteContents(),l.insertNode(u),null===(e=n.editor)||void 0===e||e.select(u,-1)}),void 0,!0)}}}},e.prototype.getMatchingReplacement=function(e){var t,n;if(0==e.length||!this.replacements)return null;var o=e.replace(/\s/g," "),i=o.toLocaleLowerCase();try{for(var a=(0,r.__values)(this.replacements),l=a.next();!l.done;l=a.next()){var s=l.value,u=(0,r.__read)(s.matchSourceCaseSensitive?[o,s.sourceString]:[i,s.sourceString.toLocaleLowerCase()],2),d=u[0],c=u[1];if(d.substring(d.length-c.length)==c)return s}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return null},e}();t.default=a},7030:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CustomReplace=void 0;var r=n(2522);Object.defineProperty(t,"CustomReplace",{enumerable:!0,get:function(){return r.default}})},7578:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4548),o=n(6344),i=function(){function e(){var e=this;this.chains=null,this.expectedChangeSource=null,this.editor=null,this.disposer=null,this.onDrop=function(){e.cacheListChains("Drop")}}return e.prototype.getName=function(){return"CutPasteListChain"},e.prototype.initialize=function(e){this.editor=e,this.disposer=this.editor.addDomEventHandler("drop",this.onDrop)},e.prototype.dispose=function(){var e;null===(e=this.disposer)||void 0===e||e.call(this),this.disposer=null,this.editor=null},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 9:e.isCut&&this.cacheListChains("Cut");break;case 10:this.cacheListChains("Paste");break;case 7:this.chains&&this.chains.length>0&&this.expectedChangeSource==e.source&&this.editor&&((0,r.commitListChains)(this.editor,this.chains),this.chains=null,this.expectedChangeSource=null)}},e.prototype.cacheListChains=function(e){var t,n=null===(t=this.editor)||void 0===t?void 0:t.getSelectedRegions();n&&(this.chains=o.VListChain.createListChains(n),this.expectedChangeSource=e)},e}();t.default=i},8854:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CutPasteListChain=void 0;var r=n(7578);Object.defineProperty(t,"CutPasteListChain",{enumerable:!0,get:function(){return r.default}})},4039:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6344),o=function(){function e(e,t,n){var r=this;void 0===e&&(e=function(e){return e}),this.getTooltipCallback=e,this.target=t,this.onLinkClick=n,this.originalHref=null,this.trackedLink=null,this.editor=null,this.disposer=null,this.onMouse=function(e){var t,n,o=null===(t=r.editor)||void 0===t?void 0:t.getElementAtCursor("a[href]",e.target),i=o&&r.tryGetHref(o);i&&(null===(n=r.editor)||void 0===n||n.setEditorDomAttribute("title","mouseover"==e.type?r.getTooltipCallback(i,o):null))},this.onBlur=function(e){r.trackedLink&&r.updateLinkHrefIfShouldUpdate(),r.resetLinkTracking()}}return e.prototype.getName=function(){return"Hyperlink"},e.prototype.initialize=function(e){this.editor=e,this.disposer=e.addDomEventHandler({mouseover:this.onMouse,mouseout:this.onMouse,blur:this.onBlur})},e.prototype.dispose=function(){this.disposer&&(this.disposer(),this.disposer=null),this.editor=null},e.prototype.onPluginEvent=function(e){var t,n,o;if(6==e.eventType||2==e.eventType&&(!this.isContentEditValue(e.rawEvent)||32==e.rawEvent.which)||7==e.eventType){var i,a=(i=null===(t=this.editor)||void 0===t?void 0:t.getElementAtCursor("A[href]",void 0,e))&&i!==this.trackedLink||2==e.eventType||7==e.eventType;7==e.eventType&&"Keyboard"==e.source&&this.trackedLink!=i&&i&&(this.trackedLink=i),this.trackedLink&&(a||this.tryGetHref(this.trackedLink)!==this.originalHref)&&(a&&this.updateLinkHrefIfShouldUpdate(),this.resetLinkTracking()),!this.trackedLink&&i&&this.doesLinkDisplayMatchHref(i)&&(this.trackedLink=i,this.originalHref=this.tryGetHref(i))}if(6==e.eventType&&(i=null===(n=this.editor)||void 0===n?void 0:n.getElementAtCursor("A",e.rawEvent.srcElement))){if(this.onLinkClick&&!1!==this.onLinkClick(i,e.rawEvent))return;var l;if((l=this.tryGetHref(i))&&(0,r.isCtrlOrMetaPressed)(e.rawEvent)&&0===e.rawEvent.button){e.rawEvent.preventDefault();try{var s=this.target||"_blank",u=null===(o=this.editor)||void 0===o?void 0:o.getDocument().defaultView;null==u||u.open(l,s)}catch(e){}}}},e.prototype.tryGetHref=function(e){try{return e?e.href:null}catch(e){return null}},e.prototype.isContentEditValue=function(e){return(0,r.isCharacterValue)(e)||8==e.which||46==e.which},e.prototype.updateLinkHrefIfShouldUpdate=function(){this.trackedLink&&!this.doesLinkDisplayMatchHref(this.trackedLink)&&this.updateLinkHref()},e.prototype.resetLinkTracking=function(){this.trackedLink=null,this.originalHref=""},e.prototype.doesLinkDisplayMatchHref=function(e){if(e){var t=e.innerText.trim().replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),n=new RegExp("^(?:https?:\\/\\/)?"+t+"\\/?","i"),r=this.tryGetHref(e);if(null!==r)return n.test(r)}return!1},e.prototype.updateLinkHref=function(){var e,t=this;if(this.trackedLink){var n=(0,r.matchLink)(this.trackedLink.innerText.trim());null!==n&&(null===(e=this.editor)||void 0===e||e.addUndoSnapshot((function(){t.trackedLink.href=n.normalizedUrl})))}},e}();t.default=o},5061:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HyperLink=void 0;var r=n(4039);Object.defineProperty(t,"HyperLink",{enumerable:!0,get:function(){return r.default}})},9770:(e,t,n)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0});var o=n(7582),i=n(7058),a=n(971),l=n(4296),s=n(2448),u=n(2627),d=n(8755),c=n(330),f=n(2110),p=n(6344),v=n(1400),h=Math.PI,g=8,m=2*h/g,y=["nw","n","ne","e","se","s","sw","w"],b={borderColor:"#DB626C",minWidth:10,minHeight:10,preserveRatio:!1,minRotateDeg:5,imageSelector:"img",rotateIconHTML:"",disableCrop:!1,disableRotate:!1,disableSideResize:!1,onSelectState:7,applyChangesOnMouseUp:!1},E=((r={})[1]=v.getCornerResizeHTML,r[2]=v.getSideResizeHTML,r[4]=c.getRotateHTML,r[8]=u.getCropHTML,r),C=function(){function e(e,t){var n=this;this.onShowResizeHandle=t,this.editor=null,this.disposer=null,this.image=null,this.clonedImage=null,this.wrapper=null,this.editInfo=null,this.lastSrc=null,this.dndHelpers=[],this.wasResized=!1,this.shadowSpan=null,this.isCropping=!1,this.onBlur=function(){n.setEditingImage(null,!1)},this.removeWrapper=function(){var e;n.shadowSpan&&(0,p.unwrap)(n.shadowSpan),n.options.applyChangesOnMouseUp&&(null===(e=n.wrapper)||void 0===e||e.removeEventListener("mouseup",n.changesWhenMouseUp,!0)),n.wrapper=null,n.shadowSpan=null},this.changesWhenMouseUp=function(){n.editor&&n.image&&n.editInfo&&n.lastSrc&&n.clonedImage&&(0,i.default)(n.editor,n.image,n.editInfo,n.lastSrc,n.wasResized,n.clonedImage,n.options.applyChangesOnMouseUp)},this.updateWrapper=function(e){var t,r,o,i=n.wrapper;if(i&&n.editInfo&&n.image&&n.clonedImage&&n.options&&(null===(t=n.shadowSpan)||void 0===t?void 0:t.parentElement)){var a=P(i,"r_cropC"),l=P(i,"r_cropO"),u=P(i,"r_resizeH"),d=P(i,"r_rotateC")[0],f=P(i,"r_rotateH")[0],h=P(i,"r_cropH");n.isCropping=1==a.length&&4==l.length;var g=n.editInfo,m=g.angleRad,y=g.bottomPercent,b=g.leftPercent,E=g.rightPercent,C=g.topPercent,w=g.flippedHorizontal,M=g.flippedVertical,D=(0,s.default)(n.editInfo,n.isCropping),A=D.targetWidth,L=D.targetHeight,R=D.originalWidth,I=D.originalHeight,N=D.visibleWidth,x=D.visibleHeight,k=(A-N)/2,j=(L-x)/2,B=R*b,F=R*E,H=I*C,z=I*y;if(i.style.margin=j+"px "+k+"px",i.style.transform="rotate("+m+"rad)",function(e,t,n,r){if(t.style.borderStyle){var o=t.style.borderWidth?2*parseInt(t.style.borderWidth):2;return e.style.width=T(n+o),void(e.style.height=T(r+o))}e.style.width=T(n),e.style.height=T(r)}(i,n.image,N,x),i.style.textAlign=(o=n.shadowSpan.parentElement,(0,p.safeInstanceOf)(o,"HTMLElement")&&"rtl"==(0,p.getComputedStyle)(o,"direction")?"right":"left"),n.clonedImage.style.width=T(R),n.clonedImage.style.height=T(I),function(e,t,n){e&&(e.style.transform="scale("+(t?-1:1)+", "+(n?-1:1)+")")}(n.clonedImage.parentElement,w,M),n.isCropping)S(a[0],B,H,F,z,void 0,void 0),S(l[0],0,0,F,void 0,void 0,H),S(l[1],void 0,0,0,z,F,void 0),S(l[2],B,void 0,0,0,void 0,z),S(l[3],0,H,void 0,0,B,void 0),_(h,m);else{if(n.clonedImage.style.margin=-H+"px 0 0 "+-B+"px","r_resizeH"==(null==e?void 0:e.elementClass)){var U=i.clientWidth,K=i.clientHeight;n.wasResized=!0,(0,v.doubleCheckResize)(n.editInfo,n.options.preserveRatio||!1,U,K),n.updateWrapper()}var W=null===(r=n.editor)||void 0===r?void 0:r.getVisibleViewport(),V=O(A,L);f&&d&&W&&(0,c.updateRotateHandleState)(W,m,i,d,f,V),function(e,t){e.forEach((function(e){var n=e.dataset,r=n.y,o=n.x,i=["n","s","e","w"].indexOf((null!=r?r:"")+(null!=o?o:""))>-1;e.style.display=i&&t?"none":""}))}(u,V),_(u,m)}}},this.options=(0,o.__assign)((0,o.__assign)({},b),e||{}),this.allowedOperations=1|(this.options.disableCrop?0:8)|(this.options.disableRotate?0:4)|(this.options.disableSideResize?0:2)}return e.prototype.getName=function(){return"ImageEdit"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.disposer=e.addDomEventHandler({blur:function(){return t.onBlur()},dragstart:function(e){t.image&&e.preventDefault()}})},e.prototype.dispose=function(){var e;this.clearDndHelpers(),null===(e=this.disposer)||void 0===e||e.call(this),this.disposer=null,this.editor=null},e.prototype.onPluginEvent=function(e){var t;switch(e.eventType){case 22:e.selectionRangeEx&&2===e.selectionRangeEx.type&&this.options&&void 0!==this.options.onSelectState&&this.setEditingImage(e.selectionRangeEx.image,this.options.onSelectState);break;case 5:var n=e.rawEvent.target,r=e.rawEvent.button;(this.shadowSpan!==n||this.shadowSpan===n&&0!==r||this.isCropping)&&this.setEditingImage(null);break;case 6:this.editor&&this.image&&this.shadowSpan&&this.editor.select(this.image);break;case 0:this.setEditingImage(null);break;case 7:case 12:this.removeWrapper();break;case 8:(null===(t=this.options)||void 0===t?void 0:t.imageSelector)&&(0,p.toArray)(e.clonedRoot.querySelectorAll(this.options.imageSelector)).forEach((function(e){(0,d.deleteEditInfo)(e)}))}},e.prototype.isOperationAllowed=function(e){return!!(this.allowedOperations&e)},e.prototype.setEditingImage=function(e,t){var n=this,r="number"==typeof t?t:0,l="number"!=typeof t&&!!t;!e&&this.image&&this.editor&&this.editInfo&&this.lastSrc&&this.clonedImage&&(this.clearDndHelpers(),(0,i.default)(this.editor,this.image,this.editInfo,this.lastSrc,this.wasResized||this.isCropping,this.clonedImage),this.removeWrapper(),this.editor.addUndoSnapshot((function(){return n.image}),"ImageResize"),l&&this.editor.select(this.image),this.image=null,this.editInfo=null,this.lastSrc=null,this.clonedImage=null,this.isCropping=!1),!this.image&&(null==e?void 0:e.isContentEditable)&&this.editor&&(this.editor.addUndoSnapshot(),this.image=e,this.editInfo=(0,d.getEditInfoFromImage)(e),this.wasResized=function(e){var t=e.width,n=e.height,r=e.style;return!(""!==r.maxWidth&&"initial"!==r.maxWidth&&"auto"!==r.maxWidth||!(w(r.height)||w(r.width)||w(t)||w(n)))}(this.image),r=((0,a.default)(e)?r:3)&this.allowedOperations,this.createWrapper(r),this.updateWrapper(),this.dndHelpers=(0,o.__spreadArray)((0,o.__spreadArray)((0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(this.createDndHelpers("r_resizeH",v.Resizer)),!1),(0,o.__read)(this.createDndHelpers("r_rotateH",c.Rotator)),!1),(0,o.__read)(this.createDndHelpers("r_cropH",u.Cropper)),!1),(0,o.__read)(this.createDndHelpers("r_cropC",u.Cropper)),!1),this.editor.select(this.image))},e.prototype.flipImage=function(e,t){var n;this.image=e,this.editInfo=(0,d.getEditInfoFromImage)(e);var r=this.editInfo.angleRad;r>=Math.PI/2&&r<3*Math.PI/4||r<=-Math.PI/2&&r>-3*Math.PI/4?"horizontal"===t?this.editInfo.flippedVertical=!this.editInfo.flippedVertical:this.editInfo.flippedHorizontal=!this.editInfo.flippedHorizontal:"vertical"===t?this.editInfo.flippedVertical=!this.editInfo.flippedVertical:this.editInfo.flippedHorizontal=!this.editInfo.flippedHorizontal,this.createWrapper(4),this.updateWrapper(),this.setEditingImage(null),null===(n=this.editor)||void 0===n||n.select(e)},e.prototype.rotateImage=function(e,t){var n;this.image=e,this.editInfo=(0,d.getEditInfoFromImage)(e),this.editInfo.angleRad=this.editInfo.angleRad+t,this.createWrapper(4),this.updateWrapper(),this.setEditingImage(null),null===(n=this.editor)||void 0===n||n.select(e)},e.prototype.createWrapper=function(e){var t,n,r,o,i=this;if(this.image&&this.editor&&this.options&&this.editInfo){this.clonedImage=this.image.cloneNode(!0),this.clonedImage.removeAttribute("id"),this.clonedImage.style.removeProperty("max-width"),this.clonedImage.style.removeProperty("max-height"),this.clonedImage.style.width=this.editInfo.widthPx+"px",this.clonedImage.style.height=this.editInfo.heightPx+"px",this.wrapper=(0,p.createElement)(6,this.image.ownerDocument),null===(n=null===(t=this.wrapper)||void 0===t?void 0:t.firstChild)||void 0===n||n.appendChild(this.clonedImage),this.wrapper.style.display=p.Browser.isSafari?"inline-block":"inline-flex",this.lastSrc=this.image.getAttribute("src"),this.clonedImage&&(this.clonedImage.src=this.editInfo.src,this.clonedImage.style.position="absolute");var a={borderColor:(r=this.options.borderColor,o=this.editor.isDarkMode(),"string"==typeof r?r.trim():o?r.darkModeColor.trim():r.lightModeColor.trim()),rotateIconHTML:this.options.rotateIconHTML,rotateHandleBackColor:this.editor.isDarkMode()?"#333":"white",isSmallImage:O(this.editInfo.widthPx,this.editInfo.heightPx)},l=[(0,v.getResizeBordersHTML)(a)];(0,p.getObjectKeys)(E).forEach((function(t){var n=E[t](a,i.onShowResizeHandle);(e&t)==t&&n&&(0,p.arrayPush)(l,n)})),l.forEach((function(e){var t=(0,p.createElement)(e,i.image.ownerDocument);t&&i.wrapper&&i.wrapper.appendChild(t)})),this.insertImageWrapper(this.wrapper)}},e.prototype.insertImageWrapper=function(e){if(this.image&&(this.shadowSpan=(0,p.wrap)(this.image,"span"),this.shadowSpan)){var t=this.shadowSpan.attachShadow({mode:"open"});this.shadowSpan.style.verticalAlign="bottom",e.style.fontSize="24px",this.options.applyChangesOnMouseUp&&e.addEventListener("mouseup",this.changesWhenMouseUp,!0),t.appendChild(e)}},e.prototype.createDndHelpers=function(e,t){var n=this,r=this.wrapper;return r&&this.editInfo?P(r,e).map((function(r){return new l.default(r,{editInfo:n.editInfo,options:n.options,elementClass:e,x:r.dataset.x,y:r.dataset.y},n.updateWrapper,t,n.editor?n.editor.getZoomScale():1)})):[]},e.prototype.clearDndHelpers=function(){var e;null===(e=this.dndHelpers)||void 0===e||e.forEach((function(e){return e.dispose()})),this.dndHelpers=[]},e}();function S(e,t,n,r,o,i,a){e.style.left=void 0!==t?T(t):e.style.left,e.style.top=void 0!==n?T(n):e.style.top,e.style.right=void 0!==r?T(r):e.style.right,e.style.bottom=void 0!==o?T(o):e.style.bottom,e.style.width=void 0!==i?T(i):e.style.width,e.style.height=void 0!==a?T(a):e.style.height}function T(e){return e+"px"}function P(e,t){return(0,p.toArray)(e.querySelectorAll("."+t))}function _(e,t){e.forEach((function(e){var n=e.dataset,r=n.y,o=n.x;e.style.cursor=function(e,t,n){void 0===t&&(t=""),void 0===n&&(n="");var r=function(e){var t=Math.round(e/m)%g;return t<0?t+g:t}(e),o=t+n,i=y.indexOf(o),a=i>=0&&i+r;return a?y[a%g]:""}(t,r,o)+"-resize"}))}function w(e){var t="string"==typeof e?parseInt(e):e;return!isNaN(t)}function O(e,t){return!!(e&&t&&(e<f.MIN_HEIGHT_WIDTH||t<f.MIN_HEIGHT_WIDTH))}t.default=C},971:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!e)return!1;try{var t=e.ownerDocument.createElement("canvas");t.width=10,t.height=10;var n=t.getContext("2d");return!!n&&(n.drawImage(e,0,0),n.getImageData(0,0,1,1),!0)}catch(e){return!1}}},8318:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2463),o=n(8755);t.default=function(e,t,n){void 0===n&&(n=1);var i=(0,o.getEditInfoFromImage)(e),a=i.heightPx||e.height,l=i.widthPx||e.width;if(i){var s=(0,r.default)(i,t),u=s.width,d=s.height;return Math.abs(u-l)<n&&Math.abs(d-a)<n}return!1}},5801:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8755);t.default=function(e,t){e.addUndoSnapshot((function(){t.style.width="",t.style.height="",t.style.maxWidth="100%",t.removeAttribute("width"),t.removeAttribute("height"),(0,r.deleteEditInfo)(t)}),"ImageResize")}},470:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7058),o=n(2463),i=n(8318),a=n(8755);t.default=function(e,t,n,l,s){var u,d,c,f=(0,a.getEditInfoFromImage)(t);(0,i.default)(t,n)||(u=t,d=t.src,c=function(){if(!e.isDisposed()&&e.contains(t)&&f){var i=t.getAttribute("src"),a=(0,o.default)(f,n),u=a.width,d=a.height;f.widthPx=Math.max(u,l),f.heightPx=Math.max(d,s),e.addUndoSnapshot((function(){(0,r.default)(e,t,f,i||"",!0)}),"ImageResize"),e.select(t)}},u.onload=function(){u.onload=null,u.onerror=null,c()},u.onerror=function(){u.onload=null,u.onerror=null,c()},u.src=d)}},2110:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MIN_HEIGHT_WIDTH=t.YS_CROP=t.XS_CROP=t.CROP_HANDLE_WIDTH=t.CROP_HANDLE_SIZE=t.ROTATE_HANDLE_TOP=t.ROTATE_WIDTH=t.Ys=t.Xs=t.ROTATION=t.ROTATE_ICON_MARGIN=t.DEFAULT_ROTATE_HANDLE_HEIGHT=t.DEG_PER_RAD=t.ROTATE_GAP=t.ROTATE_SIZE=t.RESIZE_HANDLE_MARGIN=t.RESIZE_HANDLE_SIZE=void 0,t.RESIZE_HANDLE_SIZE=10,t.RESIZE_HANDLE_MARGIN=6,t.ROTATE_SIZE=32,t.ROTATE_GAP=15,t.DEG_PER_RAD=180/Math.PI,t.DEFAULT_ROTATE_HANDLE_HEIGHT=t.ROTATE_SIZE/2+t.ROTATE_GAP,t.ROTATE_ICON_MARGIN=8,t.ROTATION={sw:0,nw:90,ne:180,se:270},t.Xs=["w","","e"],t.Ys=["s","","n"],t.ROTATE_WIDTH=1,t.ROTATE_HANDLE_TOP=t.ROTATE_GAP+t.RESIZE_HANDLE_MARGIN,t.CROP_HANDLE_SIZE=22,t.CROP_HANDLE_WIDTH=7,t.XS_CROP=["w","e"],t.YS_CROP=["s","n"],t.MIN_HEIGHT_WIDTH=3*t.RESIZE_HANDLE_SIZE+2*t.RESIZE_HANDLE_MARGIN},7058:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6249),o=n(4081),i=n(2448),a=n(8755);t.default=function(e,t,n,l,s,u,d){var c="",f=(0,a.getEditInfoFromImage)(null!=u?u:t),p=(0,r.default)(n,f);switch(p){case 1:c=n.src;break;case 2:c=l;break;case 3:c=(0,o.default)(null!=u?u:t,n)}c!=l?c=e.triggerPluginEvent(19,{image:t,originalSrc:n.src,previousSrc:l,newSrc:c}).newSrc:d&&e.triggerPluginEvent(7,{source:"ImageResize"}),c==n.src?(0,a.deleteEditInfo)(t):(0,a.saveEditInfo)(t,n);var v=(0,i.default)(n),h=v.targetWidth,g=v.targetHeight;t.src=c,(s||3==p)&&(t.width=h,t.height=g,t.style.removeProperty("width"),t.style.removeProperty("height"),t.style.removeProperty("max-width"),t.style.removeProperty("max-height"))}},6249:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImageEditInfoState=void 0;var r,o=n(7582),i=["angleRad"],a=["leftPercent","rightPercent","topPercent","bottomPercent"],l=(0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(i),!1),(0,o.__read)(a),!1),s=(0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(l),!1),(0,o.__read)(["widthPx","heightPx"]),!1);function u(e,t){return Math.abs(e-t)<.001}(r=t.ImageEditInfoState||(t.ImageEditInfoState={}))[r.Invalid=0]="Invalid",r[r.ResizeOnly=1]="ResizeOnly",r[r.SameWithLast=2]="SameWithLast",r[r.FullyChanged=3]="FullyChanged",t.default=function(e,t){return e&&e.src&&!s.some((function(t){return!("number"==typeof e[t])}))?!l.every((function(t){return u(e[t],0)}))||e.flippedHorizontal||e.flippedVertical||t&&(!t||e.angleRad!==t.angleRad)?t&&i.every((function(t){return u(e[t],0)}))&&i.every((function(e){return u(t[e],0)}))&&a.every((function(n){return u(e[n],t[n])}))&&t.flippedHorizontal===e.flippedHorizontal&&t.flippedVertical===e.flippedVertical?2:3:1:0}},8755:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEditInfoFromImage=t.deleteEditInfo=t.saveEditInfo=void 0;var r=n(6249),o=n(6344);t.saveEditInfo=function(e,t){e&&(0,o.setMetadata)(e,t)},t.deleteEditInfo=function(e){e&&(0,o.removeMetadata)(e)},t.getEditInfoFromImage=function(e){var t=(0,o.getMetadata)(e);return t&&0!=(0,r.default)(t)?t:function(e){return{src:e.getAttribute("src")||"",widthPx:e.clientWidth,heightPx:e.clientHeight,naturalWidth:e.naturalWidth,naturalHeight:e.naturalHeight,leftPercent:0,rightPercent:0,topPercent:0,bottomPercent:0,angleRad:0}}(e)}},4081:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2448);t.default=function(e,t){var n=t.angleRad,o=t.widthPx,i=t.heightPx,a=t.bottomPercent,l=t.leftPercent,s=t.rightPercent,u=t.topPercent,d=t.naturalWidth,c=t.naturalHeight,f=d*(1-l-s),p=c*(1-u-a),v=window.devicePixelRatio||1,h=document.createElement("canvas"),g=(0,r.default)(t),m=g.targetWidth,y=g.targetHeight;h.width=m*v,h.height=y*v;var b=h.getContext("2d");return b&&(b.scale(v,v),b.translate(m/2,y/2),b.rotate(n),b.scale(t.flippedHorizontal?-1:1,t.flippedVertical?-1:1),b.drawImage(e,d*l,c*u,f,p,-o/2,-i/2,o,i)),h.toDataURL("image/png",1)}},2448:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.widthPx,r=e.heightPx,o=e.angleRad,i=n/(1-e.leftPercent-e.rightPercent),a=r/(1-e.topPercent-e.bottomPercent),l=t?i:n,s=t?a:r;return{targetWidth:Math.abs(l*Math.cos(o))+Math.abs(s*Math.sin(o)),targetHeight:Math.abs(l*Math.sin(o))+Math.abs(s*Math.cos(o)),originalWidth:i,originalHeight:a,visibleWidth:l,visibleHeight:s}}},2463:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.naturalWidth,r=e.naturalHeight,o=e.leftPercent,i=e.topPercent;return{width:n*(1-o-e.rightPercent)*t,height:r*(1-i-e.bottomPercent)*t}}},2627:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCropHTML=t.Cropper=void 0;var r=n(7582),o=n(1400),i=n(2110);function a(e,t,n,r,o){var i=n*(1-r)-o,a=n*e+t;return Math.max(Math.min(a,i),0)/n}t.Cropper={onDragStart:function(e){var t=e.editInfo;return(0,r.__assign)({},t)},onDragging:function(e,t,n,i,l){var s,u=e.editInfo,d=e.x,c=e.y,f=e.options;i=(s=(0,r.__read)((0,o.rotateCoordinate)(i,l,u.angleRad),2))[0],l=s[1];var p=u.widthPx,v=u.heightPx,h=u.leftPercent,g=u.rightPercent,m=u.topPercent,y=u.bottomPercent,b=f.minWidth,E=f.minHeight,C=1-h-g,S=1-m-y;if(C>0&&S>0&&void 0!==b&&void 0!==E){var T=p/C,P=v/S,_="e"!=d?a(n.leftPercent,i,T,g,b):h,w="w"!=d?a(n.rightPercent,-i,T,h,b):g,O="s"!=c?a(n.topPercent,l,P,y,E):m,M="n"!=c?a(n.bottomPercent,-l,P,m,E):y;return u.leftPercent=_,u.rightPercent=w,u.topPercent=O,u.bottomPercent=M,u.widthPx=T*(1-_-w),u.heightPx=P*(1-O-M),!0}return!1}},t.getCropHTML=function(){var e={tag:"div",style:"position:absolute;background-color:rgb(0,0,0,0.5);pointer-events:none",className:"r_cropO"},t={tag:"div",style:"position:absolute;overflow:hidden",className:"r_cropC",children:[]};return t&&i.XS_CROP.forEach((function(e){return i.YS_CROP.forEach((function(n){var r;return null===(r=t.children)||void 0===r?void 0:r.push(function(e,t){var n,r="w"==e?"left":"right",o="n"==t?"top":"bottom",a=i.ROTATION[t+e];return{tag:"div",className:"r_cropH",style:"position:absolute;pointer-events:auto;cursor:"+t+e+"-resize;"+r+":0;"+o+":0;width:"+i.CROP_HANDLE_SIZE+"px;height:"+i.CROP_HANDLE_SIZE+"px;transform:rotate("+a+"deg)",dataset:{x:e,y:t},children:(n=[],[0,1].forEach((function(e){return[0,1].forEach((function(t){n.push(function(e,t){return{tag:"div",style:"position:absolute;left:"+e+"px;bottom:"+e+"px;"+(0==t?"right:"+e+"px;height:"+(i.CROP_HANDLE_WIDTH-2*e)+"px;":"top:"+e+"px;width:"+(i.CROP_HANDLE_WIDTH-2*e)+"px;")+";background-color:"+(0==e?"white":"black")}}(e,t))}))})),n)}}(e,n))}))})),[t,e,e,e,e]}},1400:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getResizeBordersHTML=t.getSideResizeHTML=t.getCornerResizeHTML=t.doubleCheckResize=t.rotateCoordinate=t.Resizer=void 0;var r,o=n(7582),i=n(2110);function a(e,t,n){if(0==e&&0==t)return[0,0];var r=Math.sqrt(e*e+t*t);return n=Math.atan2(t,e)-n,[r*Math.cos(n),r*Math.sin(n)]}function l(e,t,n,r){var o="w"==e?"left":"right",i="n"==t?"top":"bottom",a=t+e;return""==e&&""==t?null:{tag:"div",style:"position:absolute;"+o+":"+(""==e?"50%":"0px")+";"+i+":"+(""==t?"50%":"0px"),children:[{tag:"div",style:s[r](a,i,o,n),className:"r_resizeH",dataset:{x:e,y:t}}]}}!function(e){e[e.SquareHandles=0]="SquareHandles",e[e.CircularHandlesCorner=1]="CircularHandlesCorner"}(r||(r={})),t.Resizer={onDragStart:function(e){var t=e.editInfo;return(0,o.__assign)({},t)},onDragging:function(e,t,n,r,i){var l,s=e.x,u=e.y,d=e.editInfo,c=e.options,f=n.widthPx>0&&n.heightPx>0?1*n.widthPx/n.heightPx:0;if(r=(l=(0,o.__read)(a(r,i,d.angleRad),2))[0],i=l[1],void 0!==c.minWidth&&void 0!==c.minHeight){var p=""==s,v=""==u,h=!(p||v)&&(c.preserveRatio||t.shiftKey),g=p?n.widthPx:Math.max(n.widthPx+r*("w"==s?-1:1),c.minWidth),m=v?n.heightPx:Math.max(n.heightPx+i*("n"==u?-1:1),c.minHeight);return h&&f>0&&(f>1?(g=m*f)<c.minWidth&&(m=(g=c.minWidth)/f):(m=g/f)<c.minHeight&&(g=(m=c.minHeight)*f)),d.widthPx=g,d.heightPx=m,!0}return!1}},t.rotateCoordinate=a,t.doubleCheckResize=function(e,t,n,r){var o=e.widthPx,i=e.heightPx,a=i>0?o/i:0;n=Math.floor(n),r=Math.floor(r),o=Math.floor(o),i=Math.floor(i),e.widthPx=n,e.heightPx=r,t&&a>0&&(o!==n||i!==r)&&(n<o?e.heightPx=n/a:e.widthPx=r*a)},t.getCornerResizeHTML=function(e,t){var n=e.borderColor,r=[];return i.Xs.forEach((function(e){return i.Ys.forEach((function(o){var i=""==e==(""==o)?l(e,o,n,1):null;t&&i&&t(i,e,o),i&&r.push(i)}))})),r},t.getSideResizeHTML=function(e,t){var n=e.borderColor,r=[];return i.Xs.forEach((function(e){return i.Ys.forEach((function(o){var i=""==e!=(""==o)?l(e,o,n,1):null;t&&i&&t(i,e,o),i&&r.push(i)}))})),r},t.getResizeBordersHTML=function(e){return{tag:"div",style:"position:absolute;left:0;right:0;top:0;bottom:0;border:solid 2px "+e.borderColor+";pointer-events:none;"}};var s={0:function(e,t,n,r){return"position:relative;width:"+i.RESIZE_HANDLE_SIZE+"px;height:"+i.RESIZE_HANDLE_SIZE+"px;background-color: "+r+";cursor:"+e+"-resize;"+n+":-"+i.RESIZE_HANDLE_MARGIN+"px;"+t+":-"+i.RESIZE_HANDLE_MARGIN+"px;"},1:function(e,t,n){return"position:relative;width:"+i.RESIZE_HANDLE_SIZE+"px;height:"+i.RESIZE_HANDLE_SIZE+"px;background-color: #FFFFFF;cursor:"+e+"-resize;"+n+":-"+i.RESIZE_HANDLE_MARGIN+"px;"+t+":-"+i.RESIZE_HANDLE_MARGIN+"px;border-radius:100%;border: 2px solid #bfbfbf;box-shadow: 0px 0.36316px 1.36185px rgba(100, 100, 100, 0.25);"}}},330:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRotateHTML=t.updateRotateHandleState=t.Rotator=void 0;var r=n(7582),o=n(2110);function i(e){var t;return{tag:"svg",namespace:"http://www.w3.org/2000/svg",style:"width:16px;height:16px;margin: "+o.ROTATE_ICON_MARGIN+"px "+o.ROTATE_ICON_MARGIN+"px",children:[{tag:"path",namespace:"http://www.w3.org/2000/svg",attributes:(t={d:"M 10.5,10.0 A 3.8,3.8 0 1 1 6.7,6.3",transform:"matrix(1.1 1.1 -1.1 1.1 11.6 -10.8)"},t["fill-opacity"]="0",t.stroke=e,t)},{tag:"path",namespace:"http://www.w3.org/2000/svg",attributes:{d:"M12.0 3.648l.884-.884.53 2.298-2.298-.53z",stroke:e}}]}}t.Rotator={onDragStart:function(e){var t=e.editInfo;return(0,r.__assign)({},t)},onDragging:function(e,t,n,r,i){var a=e.editInfo,l=e.options,s=a.heightPx/2+o.DEFAULT_ROTATE_HANDLE_HEIGHT,u=s*Math.sin(n.angleRad)+r,d=s*Math.cos(n.angleRad)-i,c=Math.atan2(u,d);if(!t.altKey&&l&&void 0!==l.minRotateDeg){var f=c*o.DEG_PER_RAD;c=Math.round(f/l.minRotateDeg)*l.minRotateDeg/o.DEG_PER_RAD}return a.angleRad!=c&&(a.angleRad=c,!0)}},t.updateRotateHandleState=function(e,t,n,r,i,a){if(a)return r.style.display="none",void(i.style.display="none");r.style.display="",i.style.display="";var l=r.getBoundingClientRect(),s=n.getBoundingClientRect(),u=o.ROTATE_SIZE+o.ROTATE_GAP+o.RESIZE_HANDLE_MARGIN;if(l&&s){var d=Number.MAX_SAFE_INTEGER,c=t*o.DEG_PER_RAD;if(c<45&&c>-45&&s.top-e.top<u)d=l.top-e.top;else if(c<=-80&&c>=-100&&s.left-e.left<u)d=l.left-e.left;else if(c>=80&&c<=100&&e.right-s.right<u){var f=l.right-e.right;d=Math.min(e.right-s.right,f)}else if((c<=-160||c>=160)&&e.bottom-s.bottom<u){var p=l.bottom-e.bottom;d=Math.min(e.bottom-s.bottom,p)}var v=Math.max(Math.min(o.ROTATE_GAP,d),0),h=Math.max(Math.min(o.ROTATE_SIZE,d-v),0);r.style.top=-v-o.RESIZE_HANDLE_MARGIN+"px",r.style.height=v+"px",i.style.top=-h+"px"}},t.getRotateHTML=function(e){var t=e.borderColor,n=e.rotateHandleBackColor,r=o.ROTATE_SIZE/2;return[{tag:"div",className:"r_rotateC",style:"position:absolute;left:50%;width:1px;background-color:"+t+";top:"+-o.ROTATE_HANDLE_TOP+"px;height:"+o.ROTATE_GAP+"px;margin-left:"+-o.ROTATE_WIDTH+"px;",children:[{tag:"div",className:"r_rotateH",style:"position:absolute;background-color:"+n+";border:solid 1px "+t+";border-radius:50%;width:"+o.ROTATE_SIZE+"px;height:"+o.ROTATE_SIZE+"px;left:-"+(r+o.ROTATE_WIDTH)+"px;cursor:move;top:"+-o.ROTATE_SIZE+"px;line-height: 0px;",children:[i(t)]}]}]}},872:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetImage=t.isResizedTo=t.resizeByPercentage=t.canRegenerateImage=t.ImageEdit=void 0;var r=n(9770);Object.defineProperty(t,"ImageEdit",{enumerable:!0,get:function(){return r.default}});var o=n(971);Object.defineProperty(t,"canRegenerateImage",{enumerable:!0,get:function(){return o.default}});var i=n(470);Object.defineProperty(t,"resizeByPercentage",{enumerable:!0,get:function(){return i.default}});var a=n(8318);Object.defineProperty(t,"isResizedTo",{enumerable:!0,get:function(){return a.default}});var l=n(5801);Object.defineProperty(t,"resetImage",{enumerable:!0,get:function(){return l.default}})},8099:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7582),o=function(e){function t(t,n,r,o,i){return void 0===t&&(t=10),void 0===n&&(n=10),void 0===r&&(r="#DB626C"),void 0===o&&(o=!1),void 0===i&&(i="img"),e.call(this,{minHeight:n,minWidth:t,borderColor:r,preserveRatio:o,imageSelector:i})||this}return(0,r.__extends)(t,e),t.prototype.showResizeHandle=function(e){this.setEditingImage(e,3)},t.prototype.hideResizeHandle=function(e){this.setEditingImage(null,e)},t}(n(9770).default);t.default=o},9835:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImageResize=void 0;var r=n(8099);Object.defineProperty(t,"ImageResize",{enumerable:!0,get:function(){return r.default}})},3835:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7401),o=n(9474),i=n(8373),a=n(1820),l=n(2621),s=n(8149),u=n(5155),d=n(9053),c=n(5323),f=n(6344),p=function(){function e(e,t){void 0===e&&(e="SPAN"),void 0===t&&(t=!1),this.unknownTagReplacement=e,this.convertSingleImageBody=t,this.editor=null}return e.prototype.getName=function(){return"Paste"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){if(this.editor&&10==e.eventType){var t=e.fragment,n=e.sanitizingOption,p=this.editor.getTrustedHTMLHandler();switch((0,f.getPasteSource)(e,this.convertSingleImageBody)){case 0:(0,s.default)(e);break;case 1:case 2:0!==e.pasteType&&2!==e.pasteType||(0,i.default)(e,p);break;case 3:(0,l.default)(e,p);break;case 5:(0,a.default)(t,n);break;case 4:n.additionalTagReplacements["google-sheets-html-origin"]="*";break;case 7:(0,r.default)(e,p);break;case 6:(0,o.default)(t),(0,u.default)(t)}(0,c.default)(n),(0,d.default)(n),function(e){(0,f.chainSanitizerCallback)(e.cssStyleCallbacks,"display",(function(e){return"flex"!=e}))}(n),n.unknownTagReplacement=this.unknownTagReplacement}},e}();t.default=p},9474:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6344);function o(e){if(e&&!e.nextSibling&&["OL","UL","MENU"].indexOf((0,r.getTagOfNode)(e))<0){var t=!1;if((0,r.toArray)(e.childNodes).every((function(e){var n;return!(!(0,r.safeInstanceOf)(e,"Text")||(null===(n=e.nodeValue)||void 0===n?void 0:n.trim()))||"LI"==(0,r.getTagOfNode)(e)&&(t=!0,!0)}))&&t)return!0}return!1}t.default=function(e){o(e)?(0,r.wrap)((0,r.toArray)(e.childNodes),"UL"):(0,r.safeInstanceOf)(e.firstChild,"HTMLElement")&&o(e.firstChild)&&(0,r.changeElementTag)(e.firstChild,"UL")}},8373:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.excelHandler=void 0;var r=n(6344),o=/<\/\s*td\s*>((?!<\/\s*tr\s*>)[\s\S])*$/i,i=/<\/\s*tr\s*>((?!<\/\s*table\s*>)[\s\S])*$/i,a=/<tr[^>]*>[^<]*/i,l=/<table[^>]*>[^<]*/i;function s(e,t){if(e.match(o)){var n=t.match(a);e=(n?n[0]:"<TR>")+e+"</TR>"}if(e.match(i)){var r=t.match(l);e=(r?r[0]:"<TABLE>")+e+"</TABLE>"}return e}t.default=function(e,t){var n=e.fragment,o=e.sanitizingOption,i=e.htmlBefore,a=e.clipboardData,l=a.html?s(a.html,i):void 0;if(l&&a.html!=l){var u=(new DOMParser).parseFromString(t(l),"text/html");(0,r.moveChildNodes)(n,null==u?void 0:u.body)}var d=n.firstChild;d&&d.childNodes.length>0&&"DIV"==(0,r.getTagOfNode)(d)&&Array.from(d.childNodes).every((function(e){return"META"==(0,r.getTagOfNode)(e)||"TABLE"==(0,r.getTagOfNode)(e)&&e==d.lastChild}))&&d.lastChild&&e.fragment.replaceChildren(d.lastChild),(0,r.chainSanitizerCallback)(o.elementCallbacks,"TD",(function(e){return"none"==e.style.borderStyle&&(e.style.border="solid 1px #d4d4d4"),!0}))},t.excelHandler=s},7401:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6344);t.default=function(e,t){var n=e.fragment,o=e.clipboardData,i=o.html,a=o.image;if(i&&a){var l=(new DOMParser).parseFromString(t(i),"text/html");(0,r.moveChildNodes)(n,null==l?void 0:l.body)}}},2184:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Paste=void 0;var r=n(3835);Object.defineProperty(t,"Paste",{enumerable:!0,get:function(){return r.default}})},5155:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6344);function o(e){var t,n,o,i=e.start,a=e.end;if(i==a&&"DIV"==(0,r.getTagOfNode)(i)){var l=(0,r.changeElementTag)(i,"SPAN");e.start=l,e.end=l,l&&l.lastChild&&"BR"==(0,r.getTagOfNode)(l.lastChild)&&l.removeChild(l.lastChild)}else"BR"==(0,r.getTagOfNode)(a)&&(l=null===(t=a.ownerDocument)||void 0===t?void 0:t.createTextNode(""))&&(null===(n=a.parentNode)||void 0===n||n.insertBefore(l,a),e.end=l,null===(o=a.parentNode)||void 0===o||o.removeChild(a))}function i(e,t,n,o){var i,a,l,s,u=(0,r.getBlockElementAtNode)(e,t.start),d=n?(0,r.getNextLeafSibling)(e,t.end):(0,r.getPreviousLeafSibling)(e,t.start);if(d)if(null==u?void 0:u.contains(d))(c=null===(i=t.start.ownerDocument)||void 0===i?void 0:i.createElement("br"))&&(null===(a=(n?t.end:t.start).parentNode)||void 0===a||a.insertBefore(c,n?t.end.nextSibling:t.start));else if(o&&o.end==o.start&&"SPAN"==(0,r.getTagOfNode)(o.end)){var c,f=(0,r.getPreviousLeafSibling)(e,t.start);o.end.contains(f)&&!(0,r.findClosestElementAncestor)(t.start,e,"li")&&(c=null===(l=t.start.ownerDocument)||void 0===l?void 0:l.createElement("br"))&&(null===(s=t.start.parentNode)||void 0===s||s.insertBefore(c,t.start))}}t.default=function(e){for(var t=r.ContentTraverser.createBodyTraverser(e),n=[],a=null==t?void 0:t.currentBlockElement;a;a=t.getNextBlockElement())n.push({start:a.getStartNode(),end:a.getEndNode()});if(n.length>0){var l=n.length-1;o(n[0]),o(n[l]),i(e,n[0],!0),i(e,n[l],!1,n[0])}}},6728:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createListItemBlock=void 0,t.createListItemBlock=function(e){return void 0===e&&(e=null),{startElement:e,endElement:e,insertPositionNode:null,listItemContainers:e?[e]:[]}}},1820:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6344),o=n(8979),i=["TableInsertRowGapBlank","TableColumnResizeHandle","TableCellTopBorderHandle","TableCellLeftBorderHandle","TableHoverColumnHandle","TableHoverRowHandle"].map((function(e){return"."+e})).join(",");t.default=function(e,t){e.querySelectorAll('ul[class^="BulletListStyle"]>.OutlineElement,ol[class^="NumberListStyle"]>.OutlineElement,span.WACImageContainer').forEach((function(e){var t=e;t.style.removeProperty("display"),t.style.removeProperty("margin")})),(0,o.isWordOnlineWithList)(e)&&(0,o.default)(e),(0,r.chainSanitizerCallback)(t.cssStyleCallbacks,"border",(function(e,t){return"IMG"!=t.tagName||"none"!=e})),e.querySelectorAll(i).forEach((function(e){var t;return null===(t=e.parentElement)||void 0===t?void 0:t.removeChild(e)}))}},8979:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWordOnlineWithList=void 0;var r=n(6728),o=n(6344),i='div.ListContainerWrapper>ul[class^="BulletListStyle"],div.ListContainerWrapper>ol[class^="NumberListStyle"],span.WACImageContainer > img',a="ListContainerWrapper",l=["111","9643","9830"];function s(e,t,n){var r,o=t.createElement(n),i=null===(r=e.firstElementChild)||void 0===r?void 0:r.getAttribute("start");return i&&o.setAttribute("start",i),o}function u(e,t,n){var r;if(e){var o,i=n.insertPositionNode;i?(o=i.parentNode)&&o.insertBefore(e,i):(o=null===(r=n.startElement)||void 0===r?void 0:r.parentNode)?o.appendChild(e):t.appendChild(e)}}t.isWordOnlineWithList=function(e){return!(!e||!e.querySelector(i))},t.default=function(e){!function(e){(0,o.toArray)(e.querySelectorAll(i)).forEach((function(e){var t=new RegExp("\\b"+a+"\\b","g");if(e.previousSibling){var n=(0,o.splitParentNode)(e,!0);n.className=n.className.replace(t,"")}if(e.nextSibling){var r=(0,o.splitParentNode)(e,!1);r.className=r.className.replace(t,"")}}))}(e),function(e){for(var t=e.querySelectorAll("."+a),n=[],i=null,l=0;l<t.length;l++){var s=t[l];if(i){var u=i.listItemContainers,d=u[u.length-1];s==d.nextSibling||d.parentNode&&(0,o.getFirstLeafNode)(s)==(0,o.getNextLeafSibling)(d.parentNode,d)?(u.push(s),i.endElement=s):(i.endElement=d,n.push(i),i=(0,r.createListItemBlock)(s))}else i=(0,r.createListItemBlock)(s)}return i&&i.listItemContainers.length>0&&n.push(i),n}(e).forEach((function(t){var n,r,i;!function(e,t){t.startElement&&t.endElement&&(0,o.collapseNodes)(e,t.startElement,t.endElement,!0).forEach((function(e){"DIV"==(0,o.getTagOfNode)(e.firstChild)&&(0,o.unwrap)(e)}))}(e,t),t.insertPositionNode=null!==(r=null===(n=t.endElement)||void 0===n?void 0:n.nextSibling)&&void 0!==r?r:null;var a=void 0,d=e.ownerDocument;t.listItemContainers.forEach((function(n){var r=function(e){var t=(0,o.getTagOfNode)(e.firstChild);return"UL"==t||"OL"==t?t:null}(n);r&&(a||(a=s(n,d,r)),(0,o.toArray)(n.querySelectorAll("li")).forEach((function(i){var c,f=parseInt(null!==(c=i.getAttribute("data-aria-level"))&&void 0!==c?c:"");a&&(0,o.getTagOfNode)(a)!=r&&1==f&&r&&(u(a,e,t),a=s(n,d,r)),a&&r&&function(e,t,n,r){var i;if(n){var a=parseInt(null!==(i=t.getAttribute("data-aria-level"))&&void 0!==i?i:""),s=t.getAttribute("data-leveltext");"UL"==n&&s&&l.indexOf(s.charCodeAt(0).toString())>-1&&(t.style.listStyleType='"'+s+'  "');for(var u=e;a>1;){if(u.firstChild){var d=u.lastElementChild,c=(0,o.getTagOfNode)(d);!d||"UL"!=c&&"OL"!=c?(u.appendChild(r.createElement(n)),u.lastElementChild&&(u=u.lastElementChild)):u=d}else u.appendChild(r.createElement(n)),u.firstElementChild&&(u=u.firstElementChild);a--}u.appendChild(t)}}(a,i,r,d)})))})),a&&u(a,e,t);var c=null===(i=t.startElement)||void 0===i?void 0:i.parentNode;c&&t.listItemContainers.forEach((function(e){c.removeChild(e)}))})),function(e){return e.querySelectorAll(".WACImageContainer")}(e).forEach((function(e){(0,o.safeInstanceOf)(e,"HTMLSpanElement")&&e.childNodes.forEach((function(e){var t;"IMG"!=(0,o.getTagOfNode)(e)&&(null===(t=e.parentElement)||void 0===t||t.removeChild(e))}))}))}},2621:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6344);t.default=function(e,t){var n=e.fragment,o=e.clipboardData;if(o.html&&!o.text&&o.image){var i=(new DOMParser).parseFromString(t(o.html),"text/html");(0,r.moveChildNodes)(n,null==i?void 0:i.body)}}},4726:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeprecatedColorList=void 0,t.DeprecatedColorList=["activeborder","activecaption","appworkspace","background","buttonhighlight","buttonshadow","captiontext","inactiveborder","inactivecaption","inactivecaptiontext","infobackground","infotext","menu","menutext","scrollbar","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedfhadow","window","windowframe","windowtext"]},9053:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6344),o=n(4726);t.default=function(e){["color","background-color"].forEach((function(t){(0,r.chainSanitizerCallback)(e.cssStyleCallbacks,t,(function(e){return o.DeprecatedColorList.indexOf(e)<0}))}))}},5323:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6344),o=["http:","https:","notes:","mailto:","onenote:"];t.default=function(e){(0,r.chainSanitizerCallback)(e.attributeCallbacks,"href",(function(e,t){return function(e,t){var n;try{n=new URL(e)}catch(e){n=void 0}return n&&o.indexOf(n.protocol)>-1?e:(t.removeAttribute("href"),"")}(e,t)}))}},3825:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createLevelLists=void 0,t.createLevelLists=function(){return{listsMetadata:{},currentUniqueListId:-1}}},6482:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createWordConverterArguments=void 0;var r=n(3825);t.createWordConverterArguments=function(e){return{nodes:e,currentIndex:0,lists:{},listItems:[],currentListIdsByLevels:[(0,r.createLevelLists)()],lastProcessedItem:null}}},9873:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getObject=t.setObject=t.createCustomData=void 0;var n="NodeId";function r(e,t){var r=t.getAttribute(n);return r||(r=e.nextNodeId.toString(),e.nextNodeId++,t.setAttribute(n,r)),r}t.createCustomData=function(){return{dict:{},nextNodeId:1}},t.setObject=function(e,t,n,o){if(1==t.nodeType){var i=r(e,t);""!=i&&(e.dict[i]||(e.dict[i]={}),e.dict[i][n]=o)}},t.getObject=function(e,t,n){if(1==t.nodeType){var o=r(e,t);if(""!=o)return e.dict[o]&&e.dict[o][n]}return null}},7921:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6344),o="mso-comment-parent",i="mso-comment-reference",a="mso-comment-date",l=/#_msocom_/,s="mso-comment-continuation",u="mso-comment-done";t.default=function(e,t){(0,r.chainSanitizerCallback)(e,"SPAN",(function(e){var t;return"comment"==(0,r.getStyles)(e)["mso-special-character"]&&(null===(t=e.parentElement)||void 0===t||t.removeChild(e)),!0})),(0,r.chainSanitizerCallback)(e,"A",(function(e){var t;return(0,r.safeInstanceOf)(e,"HTMLAnchorElement")&&l.test(e.href)&&(null===(t=e.parentElement)||void 0===t||t.removeChild(e)),!0})),(0,r.chainSanitizerCallback)(e,"DIV",(function(e){return"comment-list"==(0,r.getStyles)(e)["mso-element"]&&(0,r.moveChildNodes)(e),!0})),[i,a,o,s,u].forEach((function(e){return(0,r.chainSanitizerCallback)(t,e,(function(){return!1}))}))}},8149:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7921),o=n(6344),i=n(4704),a=n(6482),l=n(1101),s=/%/;t.default=function(e){var t=e.sanitizingOption,n=e.fragment;(0,o.chainSanitizerCallback)(t.elementCallbacks,"O:P",(function(e){return(0,o.moveChildNodes)(e),e.appendChild(e.ownerDocument.createTextNode(" ")),!0}));var u=(0,i.createWordConverter)(),d=n.querySelectorAll("p,h1,h2,h3,h4,h5,h6");d.length>0&&(u.wordConverterArgs=(0,a.createWordConverterArguments)(d),(0,l.processNodesDiscovery)(u)&&(0,l.processNodeConvert)(u)),["OL","UL"].forEach((function(e){(0,o.chainSanitizerCallback)(t.elementCallbacks,e,(function(e){return"0in"==e.style.marginBottom&&(e.style.marginBottom=""),!0}))})),(0,o.chainSanitizerCallback)(t.cssStyleCallbacks,"line-height",(function(e){var t;return!(s.test(e)&&!isNaN(t=parseInt(e))&&t<120)})),(0,r.default)(t.elementCallbacks,t.cssStyleCallbacks)}},1101:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processNodeConvert=t.processNodesDiscovery=void 0;var r=n(3825),o=n(9873),i=n(6344),a="UniqueListId",l="mso-list",s=/[\n|\r]/gi;function u(e,t,n,r){var l,s=d(t,n.level,r),u=(0,o.getObject)(e.wordCustomData,s,a);if(u&&u!=n.uniqueListId||!u&&s.firstChild){var c=t.ownerDocument.createElement(r.tagName);null===(l=s.parentNode)||void 0===l||l.insertBefore(c,s.nextSibling),s=c}return(0,o.setObject)(e.wordCustomData,s,a,n.uniqueListId),function(e,t,n){var r,l,s;if(n.tagName!=(0,i.getTagOfNode)(t)){var u=null===(r=t.ownerDocument)||void 0===r?void 0:r.createElement(n.tagName);u&&((0,o.setObject)(e.wordCustomData,u,a,(0,o.getObject)(e.wordCustomData,t,a)),(0,i.moveChildNodes)(u,t),null===(l=t.parentNode)||void 0===l||l.insertBefore(u,t),null===(s=t.parentNode)||void 0===s||s.removeChild(t),t=u)}return t}(e,s,r)}function d(e,t,n){var r,o,a=null,l=null;if(1==t?l=g(e):(a=d(e,t-1,null)).lastChild&&(l=a.lastChild),l&&1==l.nodeType){var s=(0,i.getTagOfNode)(l);if("UL"==s||"OL"==s)return l}var u=null===(r=e.ownerDocument)||void 0===r?void 0:r.createElement(n?n.tagName:"UL");return 1==t?null===(o=e.parentNode)||void 0===o||o.insertBefore(u,e):null==a||a.appendChild(u),u}function c(e,t){for(var n=[],r=e.firstChild;r;r=r.nextSibling)r&&(r&&1==r.nodeType&&t>1&&c(r,t-1),(b(r=h(r,!0))||y(r))&&n.push(r));n.forEach((function(t){return e.removeChild(t)}))}function f(e){if(1==e.nodeType){var t=E(e,l);if(t&&t.length>0)try{var n=t.split(" ");if(3==n.length)return{level:parseInt(n[1].substr(5)),wordListId:t,originalNode:e,uniqueListId:0}}catch(e){}}return null}function p(e){return["o","·","§","-"].indexOf(e)>=0}function v(e,t){for(var n,r,o="",i=e.firstChild;!o&&i;)y(i=h(i,!0))?0==(o=null!==(r=null===(n=i.textContent)||void 0===n?void 0:n.trim())&&void 0!==r?r:"").length&&(o="o"):1==i.nodeType&&t>1&&(o=v(i,t-1)),i=i.nextSibling;return o}function h(e,t){var n,r,o,i;if(8==e.nodeType){var a=e.data;if(a&&"[if !supportlists]"==a.trim().toLowerCase()){for(var l=e,s=null,u=0;u<4&&(l=m(l));u++)if(8==l.nodeType&&(a=l.data)&&"[endif]"==a.trim().toLowerCase()){s=l;break}if(s){var d=null===(n=e.ownerDocument)||void 0===n?void 0:n.createElement("span");for(null==d||d.setAttribute("style","mso-list: ignore"),l=m(e);l!=s;)(l=null==l?void 0:l.nextSibling).previousSibling&&(null==d||d.appendChild(l.previousSibling));d&&(null===(r=s.parentNode)||void 0===r||r.insertBefore(d,s)),t&&(null===(o=e.parentNode)||void 0===o||o.removeChild(e),null===(i=s.parentNode)||void 0===i||i.removeChild(s)),d&&(e=d)}}}return e}function g(e){var t=e;do{t=t.previousSibling}while(t&&C(t));return t}function m(e){var t=e;do{t=t.nextSibling}while(t&&C(t));return t}function y(e){if(1==e.nodeType){var t=E(e,l);if(t&&t.length>0&&"ignore"==t.trim().toLowerCase())return!0}return!1}function b(e){return"SPAN"==(0,i.getTagOfNode)(e)&&!e.firstChild}function E(e,t){return(0,i.getStyles)(e)[t]||null}function C(e){var t;if(!e)return!0;if(3==e.nodeType){var n=e.nodeValue;return 0==(null==(n=null!==(t=null==n?void 0:n.replace(s,""))&&void 0!==t?t:"")?void 0:n.trim().length)}var r=(0,i.getTagOfNode)(e);return!(!e.firstChild||e.firstChild!=e.lastChild||"SPAN"!=r&&"FONT"!=r)&&C(e.firstChild)}function S(e){for(var t=0;t<e.currentListIdsByLevels.length;t++){var n=e.currentListIdsByLevels[t];n&&(n.currentUniqueListId=-1)}}t.processNodesDiscovery=function(e){var t,n,o=e.wordConverterArgs;if(!o)return!1;for(;o.currentIndex<o.nodes.length;){var a=o.nodes.item(o.currentIndex),l=f(a);if(l){var s=o.currentListIdsByLevels[l.level-1]||(0,r.createLevelLists)();o.currentListIdsByLevels[l.level-1]=s,o.lastProcessedItem&&g(a)!=o.lastProcessedItem&&S(o);var u=s.listsMetadata[l.wordListId];if(u){if(!u.ignore&&1==u.numberOfItems){var d=v(a,5);u.tagName=u.firstFakeBullet==d?"UL":"OL"}}else{var c=v(a,5);u={numberOfItems:0,uniqueListId:e.nextUniqueId++,firstFakeBullet:c,ignore:!c||0==c.length,tagName:(n=c,p(n)?"UL":"OL")},s.listsMetadata[l.wordListId]=u,o.lists[u.uniqueListId.toString()]=u}l.uniqueListId=u.uniqueListId,u.ignore||"OL"==u.tagName&&u.numberOfItems>0&&s.currentUniqueListId!=l.uniqueListId?(u.ignore=!0,o.currentListIdsByLevels[0].currentUniqueListId=-1,o.currentListIdsByLevels=o.currentListIdsByLevels.slice(0,1)):(o.currentListIdsByLevels.length>l.level&&(o.currentListIdsByLevels=o.currentListIdsByLevels.slice(0,l.level)),s.currentUniqueListId=l.uniqueListId,o.listItems.push(l),u.numberOfItems++),o.lastProcessedItem=a}else{var h=o.lastProcessedItem;h&&g(a)==h&&a.tagName==h.tagName&&a.className==h.className&&(h.appendChild(h.ownerDocument.createElement("br")),h.appendChild(h.ownerDocument.createElement("br")),(0,i.moveChildNodes)(h,a,!0),null===(t=a.parentNode)||void 0===t||t.removeChild(a))}o.currentIndex++}return o.listItems.length>0},t.processNodeConvert=function(e){var t,n=e.wordConverterArgs;if(n)for(n.currentIndex=0;n.currentIndex<n.listItems.length;){var r=n.listItems[n.currentIndex],o=r.originalNode,a=n.lists[r.uniqueListId.toString()];if(!a.ignore){var l=u(e,o,r,a);if(l){c(o,5);var s=o.ownerDocument.createElement("LI");if((0,i.getTagOfNode)(o).startsWith("H")){var d=o.cloneNode(!0);d.style.textIndent="",d.style.marginLeft="",d.style.marginRight="",s.appendChild(d)}else(0,i.moveChildNodes)(s,o);l.appendChild(s),null===(t=o.parentNode)||void 0===t||t.removeChild(o),"UL"==a.tagName?e.numBulletsConverted++:e.numNumberedConverted++}}n.currentIndex++}return e.numBulletsConverted>0||e.numNumberedConverted>0}},4704:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createWordConverter=void 0;var r=n(9873);t.createWordConverter=function(){return{nextUniqueId:1,numBulletsConverted:0,numNumberedConverted:0,wordConverterArgs:null,wordCustomData:(0,r.createCustomData)()}}},6575:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4548),o=n(6344),i="Backspace",a=o.Browser.isIE?"Esc":"Escape",l=o.Browser.isIE?"Left":"ArrowLeft",s=o.Browser.isIE?"Up":"ArrowUp",u=o.Browser.isIE?"Right":"ArrowRight",d=o.Browser.isIE?"Down":"ArrowDown",c=o.Browser.isIE?"Del":"Delete",f=[0,229],p=function(){function e(e,t){this.dataProvider=e,this.pickerOptions=t,this.editor=null,this.eventHandledOnKeyDown=!1,this.blockSuggestions=!1,this.isSuggesting=!1,this.lastKnownRange=null,this.isPendingInputEventHandling=!1,this.currentInputLength=0,this.newInputLength=0}return e.prototype.getName=function(){return"Picker"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.dataProvider.onInitalize((function(e){if(t.editor){t.editor.focus();var n=t.getWord(null);n&&0!=n.length||!t.lastKnownRange||(t.editor.select(t.lastKnownRange),n=t.getWord(null)),t.editor.addUndoSnapshot((function(){var o;n&&t.editor?(0,r.replaceWithNode)(t.editor,n,e,!0):null===(o=t.editor)||void 0===o||o.insertNode(e),t.setIsSuggesting(!1)}),t.pickerOptions.changeSource,t.pickerOptions.handleAutoComplete)}}),(function(e){t.setIsSuggesting(e)}),e)},e.prototype.dispose=function(){this.editor=null,this.isSuggesting=!1,this.blockSuggestions=!1,this.eventHandledOnKeyDown=!1,this.lastKnownRange=null,this.isPendingInputEventHandling=!1,this.currentInputLength=0,this.newInputLength=0,this.dataProvider.onDispose()},e.prototype.willHandleEventExclusively=function(e){return this.isSuggesting&&(0==e.eventType||2==e.eventType||3==e.eventType)},e.prototype.onPluginEvent=function(e){var t;switch(e.eventType){case 7:if("SetContent"==e.source&&this.dataProvider.onContentChanged){this.isSuggesting&&this.setIsSuggesting(!1);var n=[];null===(t=this.editor)||void 0===t||t.queryElements("[id^='"+this.pickerOptions.elementIdPrefix+"']",(function(e){e.id&&n.push(e.id)})),this.dataProvider.onContentChanged(n)}break;case 0:this.eventHandledOnKeyDown=!1,this.isAndroidKeyboardEvent(e)?(this.currentInputLength=this.calcInputLength(e),this.isPendingInputEventHandling=!0):(this.onKeyDownEvent(e),this.isPendingInputEventHandling=!1);break;case 3:this.isPendingInputEventHandling&&this.onAndroidInputEvent(e);break;case 2:!this.eventHandledOnKeyDown&&this.shouldHandleKeyUpEvent(e)&&(this.onKeyUpDomEvent(e),this.isPendingInputEventHandling=!1);break;case 6:this.isSuggesting&&this.setIsSuggesting(!1);break;case 14:this.dataProvider.onScroll&&this.dataProvider.onScroll(e.scrollContainer)}},e.prototype.setLastKnownRange=function(e){this.lastKnownRange=e},e.prototype.setIsSuggesting=function(e){this.isSuggesting=e,e||this.setLastKnownRange(null),this.dataProvider.onIsSuggestingChanged(e),this.setAriaOwns(e),this.setAriaActiveDescendant(e?0:null)},e.prototype.cancelDefaultKeyDownEvent=function(e){this.eventHandledOnKeyDown=!0,e.rawEvent.preventDefault(),e.rawEvent.stopImmediatePropagation()},e.prototype.getIdValue=function(e){if((0,o.safeInstanceOf)(e,"HTMLElement")){var t=e.attributes.getNamedItem("id");return t?t.value:null}return null},e.prototype.getWordBeforeCursor=function(e){var t,n=null===(t=this.editor)||void 0===t?void 0:t.getContentSearcherOfCursor(e);return n?n.getWordBefore():null},e.prototype.replaceNode=function(e,t){var n,r=this;null===(n=this.editor)||void 0===n||n.addUndoSnapshot((function(){var n,o;e&&(null===(n=r.editor)||void 0===n||n.deleteNode(e)),t&&(null===(o=r.editor)||void 0===o||o.insertNode(t))}),"Keyboard")},e.prototype.getRangeUntilAt=function(e){var t,n,r,i=this,a=null===(t=this.editor)||void 0===t?void 0:t.getContentSearcherOfCursor(e),l=void 0,s=void 0;return null==a||a.forEachTextInlineElement((function(e){for(var t=!1,n=e.getTextContent(),r=n?n.length:-1;r>=0;){if(n[r]==i.pickerOptions.triggerCharacter){l=e.getStartPosition().move(r),t=!0;break}r--}return t&&(s=e.getEndPosition()),t})),l?(0,o.createRange)(l,s):null!==(r=null===(n=this.editor)||void 0===n?void 0:n.getDocument().createRange())&&void 0!==r?r:null},e.prototype.shouldHandleKeyUpEvent=function(e){return this.isAndroidKeyboardEvent(e)||(0,o.isCharacterValue)(e.rawEvent)||this.isSuggesting&&!(0,o.isModifierKey)(e.rawEvent)},e.prototype.onKeyUpDomEvent=function(e){var t,n,r,o,i;if(this.editor)if(this.isSuggesting){if(null!==(l=this.getWord(e))){var a=(s=l.substring(1)).trim();l==this.pickerOptions.triggerCharacter||a&&a.length>0&&a.split(" ").length<=4?(this.dataProvider.queryStringUpdated(a,s==a),this.setLastKnownRange(null!==(t=this.editor.getSelectionRange())&&void 0!==t?t:null)):this.setIsSuggesting(!1)}}else{var l=this.getWordBeforeCursor(e);if(this.blockSuggestions)null!=l&&l[0]!=this.pickerOptions.triggerCharacter&&(this.blockSuggestions=!1);else if(null!=l&&l.split(" ").length<=4&&(l[0]==this.pickerOptions.triggerCharacter||"("==l[0]&&l[1]==this.pickerOptions.triggerCharacter)){var s;if(this.setIsSuggesting(!0),a=(s=l.substring(1)).trim(),this.dataProvider.queryStringUpdated(a,s==a),this.setLastKnownRange(null!==(n=this.editor.getSelectionRange())&&void 0!==n?n:null),this.dataProvider.setCursorPoint){var u=this.editor.getContentSearcherOfCursor(e),d=this.editor.getDocument().createRange();if(d){var c=null!==(o=null===(r=null==u?void 0:u.getInlineElementBefore())||void 0===r?void 0:r.getContainerNode())&&void 0!==o?o:null;if(!this.setRangeStart(d,c,l)){var f=null!==(i=null==c?void 0:c.previousSibling)&&void 0!==i?i:null;this.setRangeStart(d,f,this.pickerOptions.triggerCharacter)}var p=d.getBoundingClientRect();if(0==p.left&&0==p.bottom&&0==p.top&&(p=d.getClientRects()[0]),p){d.detach();var v={x:p.left,y:(p.bottom+p.top)/2},h=(p.bottom-p.top)/2;this.dataProvider.setCursorPoint(v,h)}}}}}},e.prototype.onKeyDownEvent=function(e){var t,n=e.rawEvent;if(this.isSuggesting)n.key==a?(this.setIsSuggesting(!1),this.blockSuggestions=!0,this.cancelDefaultKeyDownEvent(e)):n.key==i?this.getWord(e)==this.pickerOptions.triggerCharacter&&this.setIsSuggesting(!1):this.dataProvider.shiftHighlight&&(this.pickerOptions.isHorizontal?n.key==l||n.key==u:n.key==s||n.key==d)?(this.dataProvider.shiftHighlight(this.pickerOptions.isHorizontal?n.key==u:n.key==d),this.dataProvider.getSelectedIndex&&this.setAriaActiveDescendant(this.dataProvider.getSelectedIndex()),this.cancelDefaultKeyDownEvent(e)):!this.dataProvider.selectOption||"Enter"!=n.key&&"Tab"!=n.key||(this.dataProvider.selectOption(),this.cancelDefaultKeyDownEvent(e));else if(n.key==i)this.tryRemoveNode(e)&&this.cancelDefaultKeyDownEvent(e);else if(n.key==c){var r=null===(t=this.editor)||void 0===t?void 0:t.getContentSearcherOfCursor(e);if(r){var o=r.getInlineElementAfter(),f=o?o.getContainerNode():null,p=(f=this.getParentNodeIfTextNode(f))?this.getIdValue(f):null;if(p&&0==p.indexOf(this.pickerOptions.elementIdPrefix)&&f){var v=this.dataProvider.onRemove(f,!1);this.replaceNode(f,v),this.cancelDefaultKeyDownEvent(e)}}}},e.prototype.getParentNodeIfTextNode=function(e){return(0,o.safeInstanceOf)(e,"Text")&&(e=e.parentNode),e},e.prototype.onAndroidInputEvent=function(e){this.newInputLength=this.calcInputLength(e),(this.newInputLength<this.currentInputLength||"deleteContentBackwards"===e.rawEvent.inputType)&&this.tryRemoveNode(e)&&(this.eventHandledOnKeyDown=!0)},e.prototype.calcInputLength=function(e){var t=this.getInlineElementBeforeCursor(e);return t?t.length:0},e.prototype.tryRemoveNode=function(e){if(!this.editor)return!1;var t=this.editor.getContentSearcherOfCursor(e);if(!t)return!1;var n=t.getInlineElementBefore(),r=n?n.getContainerNode():null,i=(r=this.getParentNodeIfTextNode(r))?this.getIdValue(r):null,a=t.getInlineElementAfter();if(r&&i&&0==i.indexOf(this.pickerOptions.elementIdPrefix)&&(null==a||!(a instanceof o.PartialInlineElement))){var l=this.dataProvider.onRemove(r,!0);return l?(this.replaceNode(r,l),this.isPendingInputEventHandling?this.editor.runAsync((function(e){e.select(l,-3)})):this.editor.select(l,-3),!0):(this.editor.select(r),!1)}return!1},e.prototype.getWord=function(e){var t,n,r=null!==(n=null===(t=this.getRangeUntilAt(e))||void 0===t?void 0:t.toString())&&void 0!==n?n:"",o=this.getWordBeforeCursor(e);return r==this.pickerOptions.triggerCharacter&&r!=o?o:r},e.prototype.setRangeStart=function(e,t,n){var r=(null==t?void 0:t.textContent)?t.textContent.lastIndexOf(n):-1;return!!(t&&r>-1)&&(e.setStart(t,r),!0)},e.prototype.setAriaOwns=function(e){var t;null===(t=this.editor)||void 0===t||t.setEditorDomAttribute("aria-owns",e&&this.pickerOptions.suggestionsLabel?this.pickerOptions.suggestionsLabel:null)},e.prototype.setAriaActiveDescendant=function(e){var t;null===(t=this.editor)||void 0===t||t.setEditorDomAttribute("aria-activedescendant",null!=e&&this.pickerOptions.suggestionLabelPrefix?this.pickerOptions.suggestionLabelPrefix+e.toString():null)},e.prototype.getInlineElementBeforeCursor=function(e){var t,n=null===(t=this.editor)||void 0===t?void 0:t.getContentSearcherOfCursor(e),r=n?n.getInlineElementBefore():null;return r?r.getTextContent():null},e.prototype.isAndroidKeyboardEvent=function(e){return"Unidentified"==e.rawEvent.key||null==e.rawEvent.key&&f.indexOf(e.rawEvent.charCode)>-1},e}();t.default=p},8833:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PickerPlugin=void 0;var r=n(6575);Object.defineProperty(t,"PickerPlugin",{enumerable:!0,get:function(){return r.default}})},9467:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7905),o=n(191),i=n(4199),a=n(6817),l=n(9905),s=n(1679),u=function(){function e(){this.editor=null,this.state={firstTable:null,lastTarget:null,firstTarget:null,preventKeyUp:!1,startedSelection:!1,tableSelection:!1,targetTable:null,vTable:null,mouseMoveDisposer:null}}return e.prototype.getName=function(){return"TableCellSelection"},e.prototype.initialize=function(e){this.editor=e,this.editor.addContentEditFeature(o.DeleteTableContents)},e.prototype.dispose=function(){(0,r.clearState)(this.state,this.editor),this.state=null,this.editor=null},e.prototype.onPluginEvent=function(e){if(this.editor&&this.state)switch(e.eventType){case 5:this.state.startedSelection||(0,l.handleMouseDownEvent)(e,this.state,this.editor);break;case 0:this.state.startedSelection?e.rawEvent.preventDefault():(0,i.handleKeyDownEvent)(e,this.state,this.editor);break;case 2:this.state.startedSelection?e.rawEvent.preventDefault():(0,a.handleKeyUpEvent)(e,this.state,this.editor);break;case 14:this.state.startedSelection&&(0,s.handleScrollEvent)(this.state,this.editor);break;case 20:this.state.firstTable=null,this.state.tableSelection=!1,this.editor.select(null)}},e}();t.default=u},4332:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TABLE_CELL_SELECTOR=void 0,t.TABLE_CELL_SELECTOR="td,th"},191:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeleteTableContents=void 0;var r=n(6344),o=n(4332);function i(e,t){if((0,r.safeInstanceOf)(e,"HTMLTableCellElement")){var n=new Range;n.selectNodeContents(e),n.deleteContents(),e.appendChild(t.getDocument().createElement("br"))}}t.DeleteTableContents={keys:[46,8],shouldHandleEvent:function(e,t){return 1==t.getSelectionRangeEx().type},handleEvent:function(e,t){var n=t.getSelectionRangeEx();1==n.type&&t.addUndoSnapshot((function(){n.isWholeTableSelected?n.table.querySelectorAll(o.TABLE_CELL_SELECTOR).forEach((function(e){return i(e,t)})):t.getSelectedRegions().forEach((function(e){return i(e.rootNode,t)}))}))}}},7311:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableCellSelection=void 0;var r=n(9467);Object.defineProperty(t,"TableCellSelection",{enumerable:!0,get:function(){return r.default}})},4199:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleKeyDownEvent=void 0;var r=n(4192),o=n(8098),i=n(4846),a=n(8533),l=n(4550),s=n(7463),u=n(4332),d=n(1648),c=n(6344);t.handleKeyDownEvent=function(e,t,n){var f=e.rawEvent,p=f.shiftKey,v=f.ctrlKey,h=f.metaKey,g=f.which,m=f.defaultPrevented;if(p&&(v||h)||16==g||m)t.preventKeyUp=m;else{var y=n.getSelectionRangeEx();if(p){if(!t.firstTarget){var b=n.getFocusedPosition(),E=b&&(0,r.getCellAtCursor)(n,b.node);t.firstTarget=E}if(!(0,c.safeInstanceOf)(t.firstTarget,"HTMLTableCellElement"))return;n.runAsync((function(n){var f=n.getFocusedPosition(),p=t.tableSelection?t.lastTarget:null==f?void 0:f.node;if(p&&(0,s.setData)(p,t,n),t.firstTable==t.targetTable){if(!function(e,t){if(!e.firstTable||!t)return!1;var n=t.getSelectedRegions();if(1==n.length)return!1;var r=!0;return n.forEach((function(t){(0,c.contains)(e.firstTable,t.rootNode)||(r=!1)})),r}(t,n)&&!t.tableSelection)return;!function(e,t,n){var s,f;t.firstTarget=(0,r.getCellAtCursor)(n,t.firstTarget),t.lastTarget=(0,r.getCellAtCursor)(n,t.lastTarget),(0,d.updateSelection)(n,t.firstTarget,0),t.vTable=t.vTable||new c.VTable(t.firstTable);var p=(0,o.getCellCoordinates)(t.vTable,t.firstTarget),v=function(e,t,n){var r;if(n.lastTarget=n.lastTarget&&t.getElementAtCursor(u.TABLE_CELL_SELECTOR,n.lastTarget),(0,c.safeInstanceOf)(n.lastTarget,"HTMLTableCellElement")&&(null===(r=n.vTable)||void 0===r?void 0:r.cells)){var i=(0,o.getCellCoordinates)(n.vTable,n.lastTarget);if(n.tableSelection&&i)switch(e.rawEvent.which){case 39:i.x+=n.lastTarget.colSpan,null==n.vTable.cells[i.y][i.x]&&(i.x=n.vTable.cells[i.y].length-1,i.y++);break;case 37:0==i.x?i.y--:i.x--;break;case 38:i.y--;break;case 40:i.y++}return i&&i.y>=0&&i.x>=0&&(n.lastTarget=n.vTable.getTd(i.y,i.x)),i}}(e,n,t);if(p&&v){t.vTable.selection={firstCell:p,lastCell:v};var h=t.vTable.selection;if(!h.lastCell||t.vTable.cells&&h.lastCell.y>t.vTable.cells.length-1||-1==h.lastCell.y)if(t.lastTarget=n.getElementAtCursor(u.TABLE_CELL_SELECTOR+",div",null!==(s=t.firstTable)&&void 0!==s?s:void 0),(0,c.safeInstanceOf)(t.lastTarget,"HTMLTableCellElement"))(0,a.prepareSelection)(t,n);else{var g=t.targetTable&&new c.Position(t.targetTable,null==h.lastCell.y||-1==h.lastCell.y?-2:-3),m=null===(f=n.getDocument().defaultView)||void 0===f?void 0:f.getSelection(),y=m||{},b=y.anchorNode,E=y.anchorOffset;if(m&&b&&null!=E&&null!=E&&g)return n.select(m.getRangeAt(0)),m.setBaseAndExtent(b,E,g.node,g.offset),t.lastTarget=g.node,void e.rawEvent.preventDefault()}(0,l.selectTable)(n,t);var C=(0,i.isAfter)(t.firstTarget,t.lastTarget);if(t.lastTarget){var S=new c.Position(t.lastTarget,C?0:-1);(0,d.updateSelection)(n,S.node,S.offset)}t.tableSelection=!0,e.rawEvent.preventDefault()}}(e,t,n)}else t.tableSelection&&(t.firstTable&&n.select(t.firstTable,null),t.tableSelection=!1)}))}else if(1==(null==y?void 0:y.type)&&(!(0,c.isCtrlOrMetaPressed)(e.rawEvent)||36==g||35==g)){var C=y.ranges[0],S=C.startContainer.childNodes[C.startOffset].childNodes,T=(0,c.createRange)(S[0],S[S.length-1]);n.select(T)}}}},6817:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleKeyUpEvent=void 0;var r=n(7905),o=n(6344),i=[16,18,91,17,44];t.handleKeyUpEvent=function(e,t,n){var a=e.rawEvent,l=a.shiftKey,s=a.which,u=a.ctrlKey;l||u||!t.firstTarget||t.preventKeyUp||-1!=i.indexOf(s)||((0,o.isCharacterValue)(e.rawEvent)&&n.addUndoSnapshot(),(0,r.clearState)(t,n)),t.preventKeyUp=!1}},9905:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectionInsideTableMouseMove=t.handleMouseDownEvent=void 0;var r=n(8616),o=n(7905),i=n(6344),a=n(4192),l=n(8098),s=n(9878),u=n(8533),d=n(9991),c=n(4550),f=n(7463),p=n(4332),v=n(1648);function h(e,t,n){var r;if(t.firstTarget&&t.firstTable&&t.lastTarget!=t.firstTarget&&t.lastTarget){if((0,v.updateSelection)(n,t.firstTarget,0),t.firstTable!=t.targetTable&&(null===(r=t.targetTable)||void 0===r?void 0:r.contains(t.firstTable))&&(t.firstTarget=n.getElementAtCursor(p.TABLE_CELL_SELECTOR,t.lastTarget)),t.firstTable&&t.firstTarget){t.tableSelection=!0,t.vTable=t.vTable||new i.VTable(t.firstTable);var o=(0,l.getCellCoordinates)(t.vTable,t.firstTarget),a=(0,l.getCellCoordinates)(t.vTable,t.lastTarget);if(!o||!a)return;t.vTable.selection={firstCell:o,lastCell:a},(0,c.selectTable)(n,t)}e.preventDefault()}else if(t.lastTarget==t.firstTarget&&t.tableSelection&&t.firstTable&&t.firstTarget){t.vTable=new i.VTable(t.firstTable);var s=(0,l.getCellCoordinates)(t.vTable,t.firstTarget);s&&(t.vTable.selection={firstCell:s,lastCell:s}),(0,c.selectTable)(n,t)}}t.handleMouseDownEvent=function(e,t,n){var g,m=e.rawEvent,y=m.which,b=m.shiftKey,E=m.target,C=m.detail,S=n.getElementAtCursor("table",E,e),T=C>=3;if(!S||S.isContentEditable){var P=n.getElementAtCursor(p.TABLE_CELL_SELECTOR);if(3==y&&t.tableSelection&&t.vTable&&P){var _=(0,l.getCellCoordinates)(t.vTable,P);if(_){var w=(0,r.default)(t.vTable)||{},O=w.firstCell,M=w.lastCell;if(O&&M&&_.y>=O.y&&_.y<=M.y&&_.x>=O.x&&_.x<=M.x){if(t.firstTarget=t.vTable.getCell(O.y,O.x).td,t.lastTarget=t.vTable.getCell(M.y,M.x).td,t.firstTarget&&t.lastTarget){var D=null===(g=n.getDocument().defaultView)||void 0===g?void 0:g.getSelection();null==D||D.setBaseAndExtent(t.firstTarget,0,t.lastTarget,0),(0,c.selectTable)(n,t)}return}}}if(1==y){if(!b&&!T&&((0,o.clearState)(t,n),(0,s.getTableAtCursor)(n,e.rawEvent.target))){var A=n.getDocument()||document,L=function(e){return function(){!function(e){var t;e.startedSelection&&(e.startedSelection=!1,null===(t=e.mouseMoveDisposer)||void 0===t||t.call(e))}(e)}}(t),R=function(e,t){return function(n){if(t.contains(n.target)){if(e.tableSelection&&e.firstTarget&&(0,i.contains)(e.lastTarget,n.target,!0))return(0,v.updateSelection)(t,e.firstTarget,0),void n.preventDefault();if("TABLE"!=(0,i.getTagOfNode)(n.target)){if((0,f.setData)(n.target,e,t),!e.firstTarget||e.firstTable)if(!e.lastTarget||(e.lastTarget.lastChild!=e.lastTarget.firstChild||"TABLE"!=(0,i.getTagOfNode)(e.lastTarget.lastChild)||"DIV"!=(0,i.getTagOfNode)(e.lastTarget))&&t.contains(e.lastTarget)){(0,u.prepareSelection)(e,t);var r=!!(0,i.safeInstanceOf)(e.lastTarget,"HTMLTableCellElement")&&(0,i.contains)(e.lastTarget,e.firstTable);e.firstTable&&e.firstTable==e.targetTable||r?h(n,e,t):e.tableSelection&&(0,d.restoreSelection)(e,t),e.tableSelection&&e.firstTarget&&((0,v.updateSelection)(t,e.firstTarget,0),n.preventDefault())}else n.preventDefault()}else n.preventDefault()}}}(t,n);A.addEventListener("mouseup",L,!0),A.addEventListener("mousemove",R,!0),t.mouseMoveDisposer=function(){A.removeEventListener("mouseup",L,!0),A.removeEventListener("mousemove",R,!0)},t.startedSelection=!0}(b||T)&&n.runAsync((function(e){var n,r=null===(n=e.getDocument().defaultView)||void 0===n?void 0:n.getSelection(),o=(0,a.getCellAtCursor)(e,null==r?void 0:r.anchorNode),u=T?o:(0,a.getCellAtCursor)(e,null==r?void 0:r.focusNode),d=(0,s.getTableAtCursor)(e,o);if(d&&(0,i.safeInstanceOf)(o,"HTMLTableCellElement")&&(0,i.safeInstanceOf)(u,"HTMLTableCellElement")){t.vTable=new i.VTable(o);var f=(0,l.getCellCoordinates)(t.vTable,o),p=(0,l.getCellCoordinates)(t.vTable,u);if(!f||!p)return;t.vTable.selection={firstCell:f,lastCell:p},t.firstTarget=o,t.lastTarget=u,(0,c.selectTable)(e,t),t.tableSelection=!0,t.firstTable=d,t.targetTable=d,(0,v.updateSelection)(e,o,0)}}))}}},t.selectionInsideTableMouseMove=h},1679:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleScrollEvent=void 0;var r=n(8098),o=n(9991),i=n(4550),a=n(7463),l=n(1648);t.handleScrollEvent=function(e,t){var n,s=t.getElementAtCursor();if(s)if((0,a.setData)(s,e,t),e.firstTable==e.targetTable&&e.firstTarget&&(null===(n=e.vTable)||void 0===n?void 0:n.selection)&&e.lastTarget&&e.tableSelection){var u=(0,r.getCellCoordinates)(e.vTable,e.lastTarget);u&&(e.vTable.selection.lastCell=u,(0,i.selectTable)(t,e),(0,l.updateSelection)(t,e.firstTarget,0))}else e.tableSelection&&(0,o.restoreSelection)(e,t)}},7905:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearState=void 0,t.clearState=function(e,t){var n;null==t||t.select(null),e&&(e.vTable=null,e.firstTarget=null,e.lastTarget=null,e.tableSelection=!1,e.firstTable=null,e.targetTable=null,null===(n=e.mouseMoveDisposer)||void 0===n||n.call(e),e.mouseMoveDisposer=null)}},4192:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCellAtCursor=void 0;var r=n(4332);t.getCellAtCursor=function(e,t){return e&&e.getElementAtCursor(r.TABLE_CELL_SELECTOR,null!=t?t:void 0)||t}},8098:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCellCoordinates=void 0,t.getCellCoordinates=function(e,t){var n;if(null==e?void 0:e.cells)for(var r=0;r<e.cells.length;r++)for(var o=0;o<e.cells[r].length;o++)t==e.cells[r][o].td&&(n={x:o,y:r});return n}},9878:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTableAtCursor=void 0,t.getTableAtCursor=function(e,t){return e?e.getElementAtCursor("table",t):null}},4846:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAfter=void 0;var r=n(6344);t.isAfter=function(e,t){var n,o,i,a;if(e&&t){if(t.contains(e)){var l=null===(o=(n=e).getBoundingClientRect)||void 0===o?void 0:o.call(n),s=null===(a=(i=t).getBoundingClientRect)||void 0===a?void 0:a.call(i);if(l&&s)return l.top>s.top&&l.bottom<s.bottom}return new r.Position(e,-1).isAfter(new r.Position(t,-1))}return!1}},8616:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=(null==e?void 0:e.selection)||{},n=t.firstCell,r=t.lastCell;if(!((null==e?void 0:e.cells)&&e.selection&&n&&r))return null;var o=e.cells,i={x:Math.min(n.x,r.x),y:Math.min(n.y,r.y)},a={x:Math.max(n.x,r.x),y:Math.max(n.y,r.y)},l=function(e){e.x<0&&(e.x=0),e.y<0&&(e.y=0),e.y>=o.length&&(e.y=o.length-1);var t=o[e.y].length;e.x>=t&&(e.x=t-1)};return l(i),l(a),{firstCell:i,lastCell:a}}},8533:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prepareSelection=void 0;var r=n(6344),o=n(9878),i=n(4332);t.prepareSelection=function(e,t){var n,a,l,s;if(e.firstTable&&e.targetTable){var u=e.lastTarget!=e.firstTarget&&(null===(n=e.firstTable)||void 0===n?void 0:n.contains((0,r.findClosestElementAncestor)(e.targetTable,e.firstTable,i.TABLE_CELL_SELECTOR)));if(u&&e.tableSelection)for(;u;)e.lastTarget=(0,r.findClosestElementAncestor)(e.targetTable,e.firstTable,i.TABLE_CELL_SELECTOR),e.targetTable=(0,o.getTableAtCursor)(t,e.lastTarget),u=e.lastTarget!=e.firstTarget&&(null===(a=e.firstTable)||void 0===a?void 0:a.contains((0,r.findClosestElementAncestor)(e.targetTable,e.firstTable,i.TABLE_CELL_SELECTOR)));var d=e.lastTarget!=e.firstTarget&&(null===(l=e.targetTable)||void 0===l?void 0:l.contains((0,r.findClosestElementAncestor)(e.firstTable,e.targetTable,i.TABLE_CELL_SELECTOR)));if(d&&e.tableSelection&&e.targetTable)for(;d;){if(e.firstTarget=(0,r.findClosestElementAncestor)(e.firstTable,e.targetTable,i.TABLE_CELL_SELECTOR),!e.firstTarget)return;e.firstTable=(0,o.getTableAtCursor)(t,e.firstTarget),d=e.lastTarget!=e.firstTarget&&(null===(s=e.targetTable)||void 0===s?void 0:s.contains((0,r.findClosestElementAncestor)(e.firstTable,e.targetTable,i.TABLE_CELL_SELECTOR)))}}}},9991:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.restoreSelection=void 0;var r=n(4846),o=n(6344),i=n(1648);t.restoreSelection=function(e,t){if(e.lastTarget&&e.firstTarget){e.firstTable&&t.select(e.firstTable,null),e.tableSelection=!1;var n=(0,r.isAfter)(e.firstTarget,e.lastTarget),a=new o.Position(e.lastTarget,n?-1:0),l=new Range;e.firstTarget&&l.selectNodeContents(e.firstTarget),(0,i.updateSelection)(t,e.firstTarget,n?o.Position.getEnd(l).offset:o.Position.getStart(l).offset,a.element,a.offset)}}},4550:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectTable=void 0;var r=n(8616);t.selectTable=function(e,t){e&&t.vTable&&(null==e||e.select(t.vTable.table,(0,r.default)(t.vTable)))}},7463:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setData=void 0;var r=n(4192),o=n(9878),i=n(4332);t.setData=function(e,t,n){var a=n.getFocusedPosition();a&&(t.firstTarget=t.firstTarget||(0,r.getCellAtCursor)(n,a.node),t.firstTarget.nodeType==Node.TEXT_NODE&&(t.firstTarget=n.getElementAtCursor(i.TABLE_CELL_SELECTOR,t.firstTarget)),!n.contains(t.firstTarget)&&t.lastTarget&&(t.firstTarget=t.lastTarget)),t.firstTable=(0,o.getTableAtCursor)(n,t.firstTarget),t.lastTarget=(0,r.getCellAtCursor)(n,e),t.targetTable=(0,o.getTableAtCursor)(n,t.lastTarget)}},1648:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateSelection=void 0,t.updateSelection=function(e,t,n,r,o){var i,a=null===(i=e.getDocument().defaultView)||void 0===i?void 0:i.getSelection();a&&(r=r||t,o=o||n,a.setBaseAndExtent(t,n,r,o))}},12:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3087),o=n(6344),i=function(){function e(e,t){var n=this;this.onShowHelperElement=e,this.anchorContainerSelector=t,this.editor=null,this.onMouseMoveDisposer=null,this.tableRectMap=null,this.tableEditor=null,this.onMouseOut=function(e){var t=e.relatedTarget,r=e.currentTarget;(0,o.safeInstanceOf)(t,"HTMLElement")&&(0,o.safeInstanceOf)(r,"HTMLElement")&&n.tableEditor&&!n.tableEditor.isOwnedElement(t)&&!(0,o.contains)(r,t)&&n.setTableEditor(null)},this.onMouseMove=function(e){var t,r=e;if(!(r.buttons>0)&&n.editor){n.ensureTableRects();var o=n.editor.getDocument().defaultView||window,i=r.pageX-o.scrollX,a=r.pageY-o.scrollY,l=null;if(n.tableRectMap)for(var s=n.tableRectMap.length-1;s>=0;s--){var u=n.tableRectMap[s],d=u.table,c=u.rect;if(i>=c.left-12&&i<=c.right+12&&a>=c.top-12&&a<=c.bottom+12){l=d;break}}n.setTableEditor(l,r),null===(t=n.tableEditor)||void 0===t||t.onMouseMove(i,a)}},this.invalidateTableRects=function(){n.tableRectMap=null}}return e.prototype.getName=function(){return"TableResize"},e.prototype.initialize=function(e){this.editor=e,this.onMouseMoveDisposer=this.editor.addDomEventHandler({mousemove:this.onMouseMove}),this.editor.getScrollContainer().addEventListener("mouseout",this.onMouseOut)},e.prototype.dispose=function(){var e,t,n=null===(e=this.editor)||void 0===e?void 0:e.getScrollContainer();null==n||n.removeEventListener("mouseout",this.onMouseOut),null===(t=this.onMouseMoveDisposer)||void 0===t||t.call(this),this.invalidateTableRects(),this.disposeTableEditor(),this.editor=null,this.onMouseMoveDisposer=null},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 3:case 7:case 14:case 21:this.setTableEditor(null),this.invalidateTableRects()}},e.prototype.setTableEditor=function(e,t){if(this.tableEditor&&!this.tableEditor.isEditing()&&e!=this.tableEditor.table&&this.disposeTableEditor(),!this.tableEditor&&e&&this.editor&&e.rows.length>0){var n=this.anchorContainerSelector?this.editor.getDocument().querySelector(this.anchorContainerSelector):void 0;this.tableEditor=new r.default(this.editor,e,this.invalidateTableRects,this.onShowHelperElement,(0,o.safeInstanceOf)(n,"HTMLElement")?n:void 0,null==t?void 0:t.currentTarget)}},e.prototype.disposeTableEditor=function(){var e;null===(e=this.tableEditor)||void 0===e||e.dispose(),this.tableEditor=null},e.prototype.ensureTableRects=function(){var e=this;!this.tableRectMap&&this.editor&&(this.tableRectMap=[],this.editor.queryElements("table",(function(t){if(t.isContentEditable){var n=(0,o.normalizeRect)(t.getBoundingClientRect());n&&e.tableRectMap&&e.tableRectMap.push({table:t,rect:n})}})))},e}();t.default=i},1565:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4296),o=n(6344);function i(e,t){var n=e.td,r=e.isRTL,i=e.zoomScale,a=e.onStart,l=new o.VTable(n,!0,i),s=(0,o.normalizeRect)(n.getBoundingClientRect());if(s){a();var u=l.getCellsWithBorder(r?s.left:s.right,!r),d=l.getCellsWithBorder(r?s.left:s.right,r);return{vTable:l,currentCells:u,nextCells:d,initialX:t.pageX}}return{vTable:l,currentCells:[],nextCells:[],initialX:0}}function a(e,t,n,r,o){var i=e.td,a=e.zoomScale,l=n.vTable;return l.table.removeAttribute("height"),l.table.style.setProperty("height",null),l.forEachCellOfCurrentRow((function(e){var t;e.td&&e.td.style.setProperty("height",e.td==i?(null!==(t=e.height)&&void 0!==t?t:0)/a+o+"px":null)})),l.writeBack(!0),!0}function l(e,t,n,r){var i=e.isRTL,a=e.zoomScale,l=n.vTable,u=n.nextCells,d=n.currentCells,c=n.initialX;if(!function(e,t,n,r,i){for(var a=0;a<t.length;a++){var l=t[a];if((u=(0,o.normalizeRect)(l.getBoundingClientRect()))&&(d=s(u,e,!r)/i)<30)return!1}for(a=0;a<n.length;a++){l=n[a];var u,d=Number.MAX_SAFE_INTEGER;if(l&&(u=(0,o.normalizeRect)(l.getBoundingClientRect()))&&(d=s(u,e,r)/i),d<30)return!1}return!0}(t.pageX,d,u,i,a))return!1;var f=0==u.length,p=t.shiftKey;(f||p)&&l.table.style.setProperty("width",null);var v=new Map;return d.forEach((function(e){var n=(0,o.normalizeRect)(e.getBoundingClientRect());if(n){e.style.wordBreak="break-word",e.style.whiteSpace="normal",e.style.boxSizing="border-box";var r=s(n,t.pageX,!i)/a;v.set(e,r)}})),v.forEach((function(e,t){t.style.width=e+"px"})),p||u.forEach((function(e){var t=e.rowSpan>1?0:e.getBoundingClientRect().right-c;e.style.wordBreak="break-word",e.style.whiteSpace="normal",e.style.boxSizing="border-box",e.style.width=e.rowSpan>1?"":t/a-r+"px"})),l.writeBack(!0),!0}function s(e,t,n){return n?t-e.left:e.right-t}function u(e,t){var n=e.td,r=(0,o.normalizeRect)(n.getBoundingClientRect());r&&(t.style.top=r.bottom-4+"px",t.style.left=r.left+"px",t.style.width=r.right-r.left+"px",t.style.height="4px")}function d(e,t){var n=e.td,r=e.isRTL,i=(0,o.normalizeRect)(n.getBoundingClientRect());i&&(t.style.top=i.top+"px",t.style.left=(r?i.left:i.right)-4+1+"px",t.style.width="4px",t.style.height=i.bottom-i.top+"px")}t.default=function(e,t,n,s,c,f,p,v){var h=e.ownerDocument,g={tag:"div",style:"position: fixed; cursor: "+(s?"row":"col")+"-resize; user-select: none"};null==p||p(g,"CellResizer",e);var m=(0,o.createElement)(g,h);(v||h.body).appendChild(m);var y={td:e,isRTL:n,zoomScale:t,onStart:c},b=s?u:d;b(y,m);var E={onDragStart:i,onDragging:s?a:l,onDragEnd:f};return{node:e,div:m,featureHandler:new r.default(m,y,b,E,t)}}},3087:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(1565),i=n(669),a=n(255),l=n(6034),s=n(6080),u=n(6344);!function(e){e[e.top=0]="top",e[e.side=1]="side"}(r||(r={}));var d=function(){function e(e,t,n,r,o,i){var a=this;this.editor=e,this.table=t,this.onChanged=n,this.onShowHelperElement=r,this.anchorContainer=o,this.contentDiv=i,this.horizontalInserter=null,this.verticalInserter=null,this.horizontalResizer=null,this.verticalResizer=null,this.tableResizer=null,this.tableSelector=null,this.start=null,this.end=null,this.onFinishEditing=function(){return a.editor.focus(),a.start&&a.end&&a.editor.select(a.start,a.end),a.editor.addUndoSnapshot((function(){}),"Format"),a.onChanged(),a.isCurrentlyEditing=!1,!1},this.onStartTableResize=function(){a.isCurrentlyEditing=!0,a.onStartResize()},this.onStartCellResize=function(){a.isCurrentlyEditing=!0,a.disposeTableResizer(),a.onStartResize()},this.onInserted=function(e){a.editor.transformToDarkColor(e),a.disposeTableResizer(),a.onFinishEditing()},this.onSelect=function(e){if(a.editor.focus(),e){var t=new u.VTable(e);if(t.cells){var n=t.cells.length-1,r=0;t.cells[n].forEach((function(e,t){r=t}));var o={firstCell:{x:0,y:0},lastCell:{y:n,x:r}};a.editor.select(e,o)}}},this.getOnMouseOut=function(e){return function(t){e&&t.relatedTarget!=e&&(0,u.safeInstanceOf)(a.contentDiv,"HTMLElement")&&(0,u.safeInstanceOf)(t.relatedTarget,"HTMLElement")&&!(0,u.contains)(a.contentDiv,t.relatedTarget,!0)&&a.dispose()}},this.isRTL="rtl"==(0,u.getComputedStyle)(t,"direction"),this.setEditorFeatures(),this.isCurrentlyEditing=!1}return e.prototype.dispose=function(){this.disposeTableResizer(),this.disposeCellResizers(),this.disposeTableInserter(),this.disposeTableSelector()},e.prototype.isEditing=function(){return this.isCurrentlyEditing},e.prototype.isOwnedElement=function(e){return[this.tableResizer,this.tableSelector,this.horizontalInserter,this.verticalInserter,this.horizontalResizer,this.verticalResizer].filter((function(e){return!!(null==e?void 0:e.div)})).some((function(t){return(0,u.contains)(null==t?void 0:t.div,e,!0)}))},e.prototype.onMouseMove=function(e,t){var n,r=(0,u.normalizeRect)(this.table.getBoundingClientRect());if(r){for(var o=t<=r.top+6?0:this.isRTL?e>=r.right-6?1:void 0:e<=r.left+6?1:void 0,i=o?1:0,a=0;a<this.table.rows.length;a++){for(var l=this.table.rows[a],s=0;s<l.cells.length;s++){var d=l.cells[s],c=(0,u.normalizeRect)(d.getBoundingClientRect());if(c&&r){var f=t<=c.bottom,p=this.isRTL?e<=c.right+6*i:e<=c.right,v=this.isRTL?e>=c.left:e>=c.left-6*i;if(f&&p&&v){if(0===a&&0==o){var h=(c.left+c.right)/2,g=this.isRTL?e<h:e>h;this.setInserterTd(g?d:l.cells[s-1],!1)}else if(0===s&&1==o){var m=null===(n=this.table.rows[a-1])||void 0===n?void 0:n.cells[0],y=m?(0,u.normalizeRect)(m.getBoundingClientRect()):null,b=y?this.isRTL?y.right===c.right:y.left===c.left:null;this.setInserterTd(t<(c.top+c.bottom)/2&&b?m:d,!0)}else this.setInserterTd(null);this.setResizingTd(d);break}}}if(s<l.cells.length)break}this.setEditorFeatures()}},e.prototype.setEditorFeatures=function(){this.tableSelector||(this.tableSelector=(0,l.default)(this.table,this.editor,this.onSelect,this.getOnMouseOut,this.onShowHelperElement,this.contentDiv,this.anchorContainer)),this.tableResizer||(this.tableResizer=(0,a.default)(this.table,this.editor,this.onStartTableResize,this.onFinishEditing,this.onShowHelperElement,this.contentDiv,this.anchorContainer))},e.prototype.setResizingTd=function(e){if(this.horizontalResizer&&this.horizontalResizer.node!=e&&this.disposeCellResizers(),!this.horizontalResizer&&e){var t=this.editor.getZoomScale();this.horizontalResizer=(0,o.default)(e,t,this.isRTL,!0,this.onStartCellResize,this.onFinishEditing,this.onShowHelperElement,this.anchorContainer),this.verticalResizer=(0,o.default)(e,t,this.isRTL,!1,this.onStartCellResize,this.onFinishEditing,this.onShowHelperElement,this.anchorContainer)}},e.prototype.setInserterTd=function(e,t){var n=t?this.horizontalInserter:this.verticalInserter;if((null===e||n&&n.node!=e)&&this.disposeTableInserter(),!this.horizontalInserter&&!this.verticalInserter&&e){var r=(0,i.default)(this.editor,e,this.isRTL,!!t,this.onInserted,this.getOnMouseOut,this.onShowHelperElement,this.anchorContainer);t?this.horizontalInserter=r:this.verticalInserter=r}},e.prototype.disposeTableResizer=function(){this.tableResizer&&((0,s.disposeTableEditFeature)(this.tableResizer),this.tableResizer=null)},e.prototype.disposeTableInserter=function(){this.horizontalInserter&&((0,s.disposeTableEditFeature)(this.horizontalInserter),this.horizontalInserter=null),this.verticalInserter&&((0,s.disposeTableEditFeature)(this.verticalInserter),this.verticalInserter=null)},e.prototype.disposeCellResizers=function(){this.horizontalResizer&&((0,s.disposeTableEditFeature)(this.horizontalResizer),this.horizontalResizer=null),this.verticalResizer&&((0,s.disposeTableEditFeature)(this.verticalResizer),this.verticalResizer=null)},e.prototype.disposeTableSelector=function(){this.tableSelector&&((0,s.disposeTableEditFeature)(this.tableSelector),this.tableSelector=null)},e.prototype.onStartResize=function(){this.isCurrentlyEditing=!0;var e=this.editor.getSelectionRange();e&&(this.start=u.Position.getStart(e),this.end=u.Position.getEnd(e)),this.editor.addUndoSnapshot()},e}();t.default=d},6080:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.disposeTableEditFeature=void 0,t.disposeTableEditFeature=function(e){var t,n,r;e&&(null===(n=null===(t=e.div)||void 0===t?void 0:t.parentNode)||void 0===n||n.removeChild(e.div),e.div=null,null===(r=e.featureHandler)||void 0===r||r.dispose(),e.featureHandler=null)}},669:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6344);t.default=function(e,t,n,i,a,l,s,u){var d=e.getElementAtCursor("table",t),c=(0,r.normalizeRect)(t.getBoundingClientRect()),f=e.getVisibleViewport(),p=d&&f?(0,r.getIntersectedRect)([d],[f]):null;if(c&&p){var v=t.ownerDocument,h=function(e,t,n,r){var o=t?"white":"#4A4A4A";return{tag:"div",style:"position: fixed; width: 12px; height: 12px; font-size: 16px; color: black; line-height: 8px; vertical-align: middle; text-align: center; cursor: pointer; border: solid 1px "+o+"; border-radius: 50%; background-color: "+r,children:[{tag:"div",style:"position: absolute; box-sizing: border-box; background-color: "+r+";"+(e?(n?"right":"left")+": 12px; top: 5px; height: 3px; border-top: 1px solid "+o+"; border-bottom: 1px solid "+o+"; border-right: 1px solid "+o+"; border-left: 0px;":"left: 5px; top: 12px; width: 3px; border-left: 1px solid "+o+"; border-right: 1px solid "+o+"; border-bottom: 1px solid "+o+"; border-top: 0px;")},"+"]}}(i,e.isDarkMode(),n,e.getDefaultFormat().backgroundColor||"white");null==s||s(h,"TableInserter",t);var g=(0,r.createElement)(h,v);return i?(g.style.left=(n?p.right:p.left-13)+"px",g.style.top=c.bottom-8+"px",g.firstChild.style.width=p.right-p.left+"px"):(g.style.left=(n?c.left-8:c.right-8)+"px",g.style.top=p.top-13+"px",g.firstChild.style.height=p.bottom-p.top+"px"),(u||v.body).appendChild(g),{div:g,featureHandler:new o(g,t,i,e,a,l),node:t}}return null};var o=function(){function e(e,t,n,o,i,a){var l=this;this.div=e,this.td=t,this.isHorizontal=n,this.editor=o,this.onInsert=i,this.insertTd=function(){var e=new r.VTable(l.td);if(l.isHorizontal||(e.normalizeTableCellSize(l.editor.getZoomScale()),e.table.removeAttribute("width"),e.table.style.setProperty("width",null)),e.edit(l.isHorizontal?1:3),e.writeBack(),l.onInsert(e.table),null!=e.row&&null!=e.col&&e.cells){var t=l.isHorizontal?{firstCell:{x:0,y:e.row+1},lastCell:{x:e.cells[e.row].length-1,y:e.row+1}}:{firstCell:{x:e.col+1,y:0},lastCell:{x:e.col+1,y:e.cells.length-1}};l.editor.select(e.table,t)}},this.div.addEventListener("click",this.insertTd),this.onMouseOutEvent=a(e),this.div.addEventListener("mouseout",this.onMouseOutEvent)}return e.prototype.dispose=function(){this.div.removeEventListener("click",this.insertTd),this.onMouseOutEvent&&this.div.removeEventListener("mouseout",this.onMouseOutEvent),this.onMouseOutEvent=null},e}()},255:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4296),o=n(6344),i=12;function a(e){return e.onStart(),{originalRect:e.table.getBoundingClientRect(),vTable:new o.VTable(e.table,!0,e.zoomScale)}}function l(e,t,n,r,o){var i,a,l=e.isRTL,s=e.zoomScale,u=n.originalRect,d=n.vTable,c=1+r/u.width*s*(l?-1:1),f=1+o/u.height*s,p=Math.abs(c-1)>.001,v=Math.abs(f-1)>.001;if(d.cells&&(p||v)){for(var h=0;h<d.cells.length;h++)for(var g=0;g<d.cells[h].length;g++){var m=d.cells[h][g];if(m.td){if(p){d.table.style.setProperty("width",null);var y=(null!==(i=m.width)&&void 0!==i?i:0)*c/s;m.td.style.boxSizing="border-box",y>=30&&(m.td.style.wordBreak="break-word",m.td.style.whiteSpace="normal",m.td.style.width=y+"px")}if(v)if(d.table.style.setProperty("height",null),0==g){var b=(null!==(a=m.height)&&void 0!==a?a:0)*f/s;b>=20&&(m.td.style.height=b+"px")}else m.td.style.setProperty("height",null)}}return d.writeBack(!0),!0}return!1}function s(e,t,n){return c(e.editor,(0,o.normalizeRect)(e.table.getBoundingClientRect()),e.contentDiv)&&(e.div.style.visibility="visible",u(e,e.div)),e.onEnd(),!1}function u(e,t){var n=e.table,r=e.isRTL,a=(0,o.normalizeRect)(n.getBoundingClientRect());a&&(t.style.top=a.bottom+"px",t.style.left=r?a.left-i-2+"px":a.right+"px")}function d(e,t){t.style.visibility="hidden"}function c(e,t,n){var r=e.getVisibleViewport();if(n&&(0,o.safeInstanceOf)(n,"HTMLElement")&&r&&t){var i=(0,o.normalizeRect)(n.getBoundingClientRect());return!!i&&i.bottom>=t.bottom&&r.bottom>=t.bottom}return!0}t.default=function(e,t,n,f,p,v,h){if(!c(t,(0,o.normalizeRect)(e.getBoundingClientRect()),v))return null;var g=e.ownerDocument,m="rtl"==(0,o.getComputedStyle)(e,"direction"),y=t.getZoomScale(),b={tag:"div",style:"position: fixed; cursor: "+(m?"ne":"nw")+"-resize; user-select: none; border: 1px solid #808080"};null==p||p(b,"TableResizer",e);var E=(0,o.createElement)(b,g);E.style.width=i+"px",E.style.height=i+"px",(h||g.body).appendChild(E);var C={isRTL:m,table:e,zoomScale:y,onStart:n,onEnd:f,div:E,editor:t,contentDiv:v};return u(C,E),{node:e,div:E,featureHandler:new r.default(E,C,d,{onDragStart:a,onDragging:l,onDragEnd:s},y)}}},6034:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7582),o=n(4296),i=n(6344);t.default=function(e,t,n,r,o,s,u){var d=(0,i.normalizeRect)(e.getBoundingClientRect());if(!function(e,t,n){var r=e.getVisibleViewport();if(n&&(0,i.safeInstanceOf)(n,"HTMLElement")&&r&&t){var o=(0,i.normalizeRect)(n.getBoundingClientRect());return!!o&&o.top<=t.top&&r.top<=t.top}return!0}(t,d,s))return null;var c=t.getZoomScale(),f=e.ownerDocument,p={tag:"div",style:"position: fixed; cursor: all-scroll; user-select: none; border: 1px solid #808080"};null==o||o(p,"TableSelector",e);var v=(0,i.createElement)(p,f);v.id="_Table_Selector",v.style.width="12px",v.style.height="12px",(u||f.body).appendChild(v);var h={table:e,zoomScale:c,rect:d,isRTL:"rtl"==(0,i.getComputedStyle)(e,"direction")};l(h,v);var g=new a(v,h,l,{onDragEnd:function(e,t){return t.target==v&&n(e.table),!1}},h.zoomScale,r);return{div:v,featureHandler:g,node:e}};var a=function(e){function t(t,n,r,o,i,a,l,s){var u=e.call(this,t,n,r,o,i,l)||this;return u.div=t,u.onMouseOut=a(t),t.addEventListener("mouseout",u.onMouseOut),u}return(0,r.__extends)(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this.onMouseOut&&this.div.removeEventListener("mouseout",this.onMouseOut),this.onMouseOut=null},t}(o.default);function l(e,t){var n=e.rect;n&&(t.style.top=n.top-12+"px",t.style.left=n.left-12-2+"px")}},9963:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableResize=void 0;var r=n(12);Object.defineProperty(t,"TableResize",{enumerable:!0,get:function(){return r.default}})},909:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6344),o=n(4548),i="WATERMARK_WRAPPER",a=function(){function e(e,t,n){var a=this;this.watermark=e,this.customClass=n,this.editor=null,this.disposer=null,this.showHideWatermark=function(){if(a.editor){var e=a.editor.hasFocus(),t=a.editor.queryElements((0,r.getEntitySelector)(i)),n=t.length>0;if(e&&n)t.forEach(a.removeWatermark),a.editor.focus();else if(!e&&!n&&a.editor.isEmpty()){var l=(0,o.insertEntity)(a.editor,i,a.editor.getDocument().createTextNode(a.watermark),!1,!1,0);a.customClass&&l.wrapper.classList.add(a.customClass)}}},this.removeWatermark=function(e){var t,n=e.parentNode;null==n||n.removeChild(e),n&&(null===(t=a.editor)||void 0===t?void 0:t.contains(n))&&"DIV"==(0,r.getTagOfNode)(n)&&!n.firstChild&&n.appendChild(a.editor.getDocument().createElement("BR"))},this.format=t||{fontSize:"14px",textColors:{lightModeColor:"#AAAAAA",darkModeColor:"#6B6B6B"}}}return e.prototype.getName=function(){return"Watermark"},e.prototype.initialize=function(e){this.editor=e,this.disposer=this.editor.addDomEventHandler({focus:this.showHideWatermark,blur:this.showHideWatermark})},e.prototype.dispose=function(){var e;null===(e=this.disposer)||void 0===e||e.call(this),this.disposer=null,this.editor=null},e.prototype.onPluginEvent=function(e){var t;if(11==e.eventType||7==e.eventType&&(null===(t=e.data)||void 0===t?void 0:t.type)!=i)this.showHideWatermark();else if(15==e.eventType&&e.entity.type==i&&this.editor){var n=e.operation,o=e.entity.wrapper;8==n?this.removeWatermark(o):0==e.operation&&((0,r.applyFormat)(o,this.format,this.editor.isDarkMode(),this.editor.getDarkColorHandler()),o.spellcheck=!1)}},e}();t.default=a},2939:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Watermark=void 0;var r=n(909);Object.defineProperty(t,"Watermark",{enumerable:!0,get:function(){return r.default}})},1286:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(0,n(7582).__exportStar)(n(7246),t)},2091:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5160:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleAlignment=void 0,(n=t.CompatibleAlignment||(t.CompatibleAlignment={}))[n.Left=0]="Left",n[n.Center=1]="Center",n[n.Right=2]="Right"},8411:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleBulletListType=void 0,(n=t.CompatibleBulletListType||(t.CompatibleBulletListType={}))[n.Min=1]="Min",n[n.Disc=1]="Disc",n[n.Dash=2]="Dash",n[n.Square=3]="Square",n[n.ShortArrow=4]="ShortArrow",n[n.LongArrow=5]="LongArrow",n[n.UnfilledArrow=6]="UnfilledArrow",n[n.Hyphen=7]="Hyphen",n[n.DoubleLongArrow=8]="DoubleLongArrow",n[n.Circle=9]="Circle",n[n.Max=9]="Max"},5412:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleCapitalization=void 0,(n=t.CompatibleCapitalization||(t.CompatibleCapitalization={})).Sentence="sentence",n.Lowercase="lowercase",n.Uppercase="uppercase",n.CapitalizeEachWord="capitalize"},5588:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleChangeSource=void 0,(n=t.CompatibleChangeSource||(t.CompatibleChangeSource={})).AutoLink="AutoLink",n.CreateLink="CreateLink",n.Format="Format",n.ImageResize="ImageResize",n.Paste="Paste",n.SetContent="SetContent",n.Cut="Cut",n.Drop="Drop",n.InsertEntity="InsertEntity",n.SwitchToDarkMode="SwitchToDarkMode",n.SwitchToLightMode="SwitchToLightMode",n.ListChain="ListChain",n.Keyboard="Keyboard"},6627:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleClearFormatMode=void 0,(n=t.CompatibleClearFormatMode||(t.CompatibleClearFormatMode={}))[n.Inline=0]="Inline",n[n.Block=1]="Block",n[n.AutoDetect=2]="AutoDetect"},2874:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleColorTransformDirection=void 0,(n=t.CompatibleColorTransformDirection||(t.CompatibleColorTransformDirection={}))[n.LightToDark=0]="LightToDark",n[n.DarkToLight=1]="DarkToLight"},1109:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleContentPosition=void 0,(n=t.CompatibleContentPosition||(t.CompatibleContentPosition={}))[n.Begin=0]="Begin",n[n.End=1]="End",n[n.DomEnd=2]="DomEnd",n[n.SelectionStart=3]="SelectionStart",n[n.Outside=4]="Outside",n[n.Range=5]="Range"},695:(e,t)=>{"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleContentType=t.CompatibleContentTypePrefix=void 0,(r=t.CompatibleContentTypePrefix||(t.CompatibleContentTypePrefix={})).Text="text/",r.Image="image/",(n=t.CompatibleContentType||(t.CompatibleContentType={})).PlainText="text/plain",n.HTML="text/html"},7838:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleDarkModeDatasetNames=void 0,(n=t.CompatibleDarkModeDatasetNames||(t.CompatibleDarkModeDatasetNames={})).OriginalStyleColor="ogsc",n.OriginalStyleBackgroundColor="ogsb",n.OriginalAttributeColor="ogac",n.OriginalAttributeBackgroundColor="ogab"},35:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleDefinitionType=void 0,(n=t.CompatibleDefinitionType||(t.CompatibleDefinitionType={}))[n.Boolean=0]="Boolean",n[n.Number=1]="Number",n[n.String=2]="String",n[n.Array=3]="Array",n[n.Object=4]="Object",n[n.Customize=5]="Customize"},7028:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleDelimiterClasses=void 0,(n=t.CompatibleDelimiterClasses||(t.CompatibleDelimiterClasses={})).DELIMITER_BEFORE="entityDelimiterBefore",n.DELIMITER_AFTER="entityDelimiterAfter"},6234:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleDirection=void 0,(n=t.CompatibleDirection||(t.CompatibleDirection={}))[n.LeftToRight=0]="LeftToRight",n[n.RightToLeft=1]="RightToLeft"},2805:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleDocumentCommand=void 0,(n=t.CompatibleDocumentCommand||(t.CompatibleDocumentCommand={})).AutoUrlDetect="AutoUrlDetect",n.BackColor="backColor",n.Bold="bold",n.ClearAuthenticationCache="ClearAuthenticationCache",n.ContentReadOnly="contentReadOnly",n.Copy="copy",n.CreateLink="createLink",n.Cut="cut",n.DecreaseFontSize="decreaseFontSize",n.DefaultParagraphSeparator="defaultParagraphSeparator",n.Delete="delete",n.EnableInlineTableEditing="enableInlineTableEditing",n.EnableObjectResizing="enableObjectResizing",n.FontName="fontName",n.FontSize="fontSize",n.ForeColor="foreColor",n.FormatBlock="formatBlock",n.ForwardDelete="forwardDelete",n.Heading="heading",n.HiliteColor="hiliteColor",n.IncreaseFontSize="increaseFontSize",n.Indent="indent",n.InsertBrOnReturn="insertBrOnReturn",n.InsertHorizontalRule="insertHorizontalRule",n.InsertHTML="insertHTML",n.InsertImage="insertImage",n.InsertOrderedList="insertOrderedList",n.InsertUnorderedList="insertUnorderedList",n.InsertParagraph="insertParagraph",n.InsertText="insertText",n.Italic="italic",n.JustifyCenter="justifyCenter",n.JustifyFull="justifyFull",n.JustifyLeft="justifyLeft",n.JustifyRight="justifyRight",n.Outdent="outdent",n.Paste="paste",n.Redo="redo",n.RemoveFormat="removeFormat",n.SelectAll="selectAll",n.StrikeThrough="strikeThrough",n.Subscript="subscript",n.Superscript="superscript",n.Underline="underline",n.Undo="undo",n.Unlink="unlink",n.StyleWithCSS="styleWithCSS"},6550:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleDocumentPosition=void 0,(n=t.CompatibleDocumentPosition||(t.CompatibleDocumentPosition={}))[n.Same=0]="Same",n[n.Disconnected=1]="Disconnected",n[n.Preceding=2]="Preceding",n[n.Following=4]="Following",n[n.Contains=8]="Contains",n[n.ContainedBy=16]="ContainedBy"},3779:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleEntityClasses=void 0,(n=t.CompatibleEntityClasses||(t.CompatibleEntityClasses={})).ENTITY_INFO_NAME="_Entity",n.ENTITY_TYPE_PREFIX="_EType_",n.ENTITY_ID_PREFIX="_EId_",n.ENTITY_READONLY_PREFIX="_EReadonly_"},8206:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleEntityOperation=void 0,(n=t.CompatibleEntityOperation||(t.CompatibleEntityOperation={}))[n.NewEntity=0]="NewEntity",n[n.Click=1]="Click",n[n.ContextMenu=2]="ContextMenu",n[n.Escape=3]="Escape",n[n.RemoveFromStart=4]="RemoveFromStart",n[n.RemoveFromEnd=5]="RemoveFromEnd",n[n.Overwrite=6]="Overwrite",n[n.PartialOverwrite=7]="PartialOverwrite",n[n.ReplaceTemporaryContent=8]="ReplaceTemporaryContent",n[n.AddShadowRoot=9]="AddShadowRoot",n[n.RemoveShadowRoot=10]="RemoveShadowRoot",n[n.UpdateEntityState=11]="UpdateEntityState"},2322:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleExperimentalFeatures=void 0,(n=t.CompatibleExperimentalFeatures||(t.CompatibleExperimentalFeatures={})).NewIndentation="NewIndentation",n.NewBullet="NewBullet",n.NewNumbering="NewNumbering",n.ListChain="ListChain",n.MergePastedLine="MergePastedLine",n.SingleDirectionResize="SingleDirectionResize",n.PasteWithLinkPreview="PasteWithLinkPreview",n.ImageRotate="ImageRotate",n.ImageCrop="ImageCrop",n.AlwaysApplyDefaultFormat="AlwaysApplyDefaultFormat",n.ConvertSingleImageBody="ConvertSingleImageBody",n.TableAlignment="TableAlignment",n.AdaptiveHandlesResizer="AdaptiveHandlesResizer",n.AutoHyphen="AutoHyphen",n.PendingStyleBasedFormat="PendingStyleBasedFormat",n.NormalizeList="NormalizeList",n.ImageSelection="ImageSelection",n.VariableBasedDarkColor="VariableBasedDarkColor",n.ListItemAlignment="ListItemAlignment",n.DefaultFormatInSpan="DefaultFormatInSpan",n.DefaultFormatOnContainer="DefaultFormatOnContainer",n.ReusableContentModel="ReusableContentModel",n.EditWithContentModel="EditWithContentModel",n.AutoFormatList="AutoFormatList",n.InlineEntityReadOnlyDelimiters="InlineEntityReadOnlyDelimiters",n.ContentModelPaste="ContentModelPaste",n.TabKeyTextFeatures="TabKeyTextFeatures",n.ReuseAllAncestorListElements="ReuseAllAncestorListElements",n.DeleteTableWithBackspace="DeleteTableWithBackspace",n.DisableListChain="DisableListChain"},3271:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleFontSizeChange=void 0,(n=t.CompatibleFontSizeChange||(t.CompatibleFontSizeChange={}))[n.Increase=0]="Increase",n[n.Decrease=1]="Decrease"},2776:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleGetContentMode=void 0,(n=t.CompatibleGetContentMode||(t.CompatibleGetContentMode={}))[n.CleanHTML=0]="CleanHTML",n[n.RawHTMLOnly=1]="RawHTMLOnly",n[n.RawHTMLWithSelection=2]="RawHTMLWithSelection",n[n.PlainText=3]="PlainText",n[n.PlainTextFast=4]="PlainTextFast"},7705:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleImageEditOperation=void 0,(n=t.CompatibleImageEditOperation||(t.CompatibleImageEditOperation={}))[n.None=0]="None",n[n.CornerResize=1]="CornerResize",n[n.SideResize=2]="SideResize",n[n.Resize=3]="Resize",n[n.Rotate=4]="Rotate",n[n.ResizeAndRotate=7]="ResizeAndRotate",n[n.Crop=8]="Crop",n[n.All=15]="All"},6020:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleIndentation=void 0,(n=t.CompatibleIndentation||(t.CompatibleIndentation={}))[n.Increase=0]="Increase",n[n.Decrease=1]="Decrease"},2693:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleKeys=void 0,(n=t.CompatibleKeys||(t.CompatibleKeys={}))[n.NULL=0]="NULL",n[n.BACKSPACE=8]="BACKSPACE",n[n.TAB=9]="TAB",n[n.ENTER=13]="ENTER",n[n.SHIFT=16]="SHIFT",n[n.CTRL_LEFT=17]="CTRL_LEFT",n[n.ALT=18]="ALT",n[n.ESCAPE=27]="ESCAPE",n[n.SPACE=32]="SPACE",n[n.PAGEUP=33]="PAGEUP",n[n.END=35]="END",n[n.HOME=36]="HOME",n[n.LEFT=37]="LEFT",n[n.UP=38]="UP",n[n.RIGHT=39]="RIGHT",n[n.DOWN=40]="DOWN",n[n.PRINT_SCREEN=44]="PRINT_SCREEN",n[n.DELETE=46]="DELETE",n[n.EIGHT_ASTIRISK=56]="EIGHT_ASTIRISK",n[n.EIGHT_ASTERISK=56]="EIGHT_ASTERISK",n[n.B=66]="B",n[n.I=73]="I",n[n.U=85]="U",n[n.Y=89]="Y",n[n.Z=90]="Z",n[n.META_LEFT=91]="META_LEFT",n[n.COMMA=188]="COMMA",n[n.DASH_UNDERSCORE=189]="DASH_UNDERSCORE",n[n.PERIOD=190]="PERIOD",n[n.FORWARDSLASH=191]="FORWARDSLASH",n[n.FORWARD_SLASH=191]="FORWARD_SLASH",n[n.GRAVE_TILDE=192]="GRAVE_TILDE",n[n.CONTENTCHANGED=257]="CONTENTCHANGED",n[n.RANGE=258]="RANGE",n[n.Ctrl=4096]="Ctrl",n[n.Meta=8192]="Meta",n[n.Shift=16384]="Shift"},1911:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleKnownAnnounceStrings=void 0,(n=t.CompatibleKnownAnnounceStrings||(t.CompatibleKnownAnnounceStrings={}))[n.AnnounceListItemNumbering=1]="AnnounceListItemNumbering",n[n.AnnounceListItemBullet=2]="AnnounceListItemBullet",n[n.AnnounceOnFocusLastCell=3]="AnnounceOnFocusLastCell"},4845:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleKnownCreateElementDataIndex=void 0,(n=t.CompatibleKnownCreateElementDataIndex||(t.CompatibleKnownCreateElementDataIndex={}))[n.None=0]="None",n[n.EmptyLine=1]="EmptyLine",n[n.BlockquoteWrapper=2]="BlockquoteWrapper",n[n.CopyPasteTempDiv=3]="CopyPasteTempDiv",n[n.BlockListItem=4]="BlockListItem",n[n.ContextMenuWrapper=5]="ContextMenuWrapper",n[n.ImageEditWrapper=6]="ImageEditWrapper",n[n.TableHorizontalResizer=7]="TableHorizontalResizer",n[n.TableVerticalResizer=8]="TableVerticalResizer",n[n.TableResizerLTR=9]="TableResizerLTR",n[n.TableResizerRTL=10]="TableResizerRTL",n[n.TableSelector=11]="TableSelector",n[n.EmptyLineFormatInSpan=12]="EmptyLineFormatInSpan"},9603:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleKnownPasteSourceType=void 0,(n=t.CompatibleKnownPasteSourceType||(t.CompatibleKnownPasteSourceType={}))[n.WordDesktop=0]="WordDesktop",n[n.ExcelDesktop=1]="ExcelDesktop",n[n.ExcelOnline=2]="ExcelOnline",n[n.PowerPointDesktop=3]="PowerPointDesktop",n[n.GoogleSheets=4]="GoogleSheets",n[n.WacComponents=5]="WacComponents",n[n.Default=6]="Default",n[n.SingleImage=7]="SingleImage"},3115:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleListType=void 0,(n=t.CompatibleListType||(t.CompatibleListType={}))[n.None=0]="None",n[n.Ordered=1]="Ordered",n[n.Unordered=2]="Unordered"},6993:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleNodeType=void 0,(n=t.CompatibleNodeType||(t.CompatibleNodeType={}))[n.Element=1]="Element",n[n.Attribute=2]="Attribute",n[n.Text=3]="Text",n[n.ProcessingInstruction=7]="ProcessingInstruction",n[n.Comment=8]="Comment",n[n.Document=9]="Document",n[n.DocumentType=10]="DocumentType",n[n.DocumentFragment=11]="DocumentFragment"},1040:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleNumberingListType=void 0,(n=t.CompatibleNumberingListType||(t.CompatibleNumberingListType={}))[n.Min=1]="Min",n[n.Decimal=1]="Decimal",n[n.DecimalDash=2]="DecimalDash",n[n.DecimalParenthesis=3]="DecimalParenthesis",n[n.DecimalDoubleParenthesis=4]="DecimalDoubleParenthesis",n[n.LowerAlpha=5]="LowerAlpha",n[n.LowerAlphaParenthesis=6]="LowerAlphaParenthesis",n[n.LowerAlphaDoubleParenthesis=7]="LowerAlphaDoubleParenthesis",n[n.LowerAlphaDash=8]="LowerAlphaDash",n[n.UpperAlpha=9]="UpperAlpha",n[n.UpperAlphaParenthesis=10]="UpperAlphaParenthesis",n[n.UpperAlphaDoubleParenthesis=11]="UpperAlphaDoubleParenthesis",n[n.UpperAlphaDash=12]="UpperAlphaDash",n[n.LowerRoman=13]="LowerRoman",n[n.LowerRomanParenthesis=14]="LowerRomanParenthesis",n[n.LowerRomanDoubleParenthesis=15]="LowerRomanDoubleParenthesis",n[n.LowerRomanDash=16]="LowerRomanDash",n[n.UpperRoman=17]="UpperRoman",n[n.UpperRomanParenthesis=18]="UpperRomanParenthesis",n[n.UpperRomanDoubleParenthesis=19]="UpperRomanDoubleParenthesis",n[n.UpperRomanDash=20]="UpperRomanDash",n[n.Max=20]="Max"},610:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatiblePasteType=void 0,(n=t.CompatiblePasteType||(t.CompatiblePasteType={}))[n.Normal=0]="Normal",n[n.AsPlainText=1]="AsPlainText",n[n.MergeFormat=2]="MergeFormat",n[n.AsImage=3]="AsImage"},5912:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatiblePluginEventType=void 0,(n=t.CompatiblePluginEventType||(t.CompatiblePluginEventType={}))[n.KeyDown=0]="KeyDown",n[n.KeyPress=1]="KeyPress",n[n.KeyUp=2]="KeyUp",n[n.Input=3]="Input",n[n.CompositionEnd=4]="CompositionEnd",n[n.MouseDown=5]="MouseDown",n[n.MouseUp=6]="MouseUp",n[n.ContentChanged=7]="ContentChanged",n[n.ExtractContentWithDom=8]="ExtractContentWithDom",n[n.BeforeCutCopy=9]="BeforeCutCopy",n[n.BeforePaste=10]="BeforePaste",n[n.EditorReady=11]="EditorReady",n[n.BeforeDispose=12]="BeforeDispose",n[n.PendingFormatStateChanged=13]="PendingFormatStateChanged",n[n.Scroll=14]="Scroll",n[n.EntityOperation=15]="EntityOperation",n[n.ContextMenu=16]="ContextMenu",n[n.EnteredShadowEdit=17]="EnteredShadowEdit",n[n.LeavingShadowEdit=18]="LeavingShadowEdit",n[n.EditImage=19]="EditImage",n[n.BeforeSetContent=20]="BeforeSetContent",n[n.ZoomChanged=21]="ZoomChanged",n[n.SelectionChanged=22]="SelectionChanged",n[n.BeforeKeyboardEditing=23]="BeforeKeyboardEditing"},685:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatiblePositionType=void 0,(n=t.CompatiblePositionType||(t.CompatiblePositionType={}))[n.Begin=0]="Begin",n[n.End=-1]="End",n[n.Before=-2]="Before",n[n.After=-3]="After"},8465:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleQueryScope=void 0,(n=t.CompatibleQueryScope||(t.CompatibleQueryScope={}))[n.Body=0]="Body",n[n.OnSelection=1]="OnSelection",n[n.InSelection=2]="InSelection"},2906:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleRegionType=void 0,(n=t.CompatibleRegionType||(t.CompatibleRegionType={}))[n.Table=0]="Table"},895:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleSelectionRangeTypes=void 0,(n=t.CompatibleSelectionRangeTypes||(t.CompatibleSelectionRangeTypes={}))[n.Normal=0]="Normal",n[n.TableSelection=1]="TableSelection",n[n.ImageSelection=2]="ImageSelection"},3088:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleTableBorderFormat=void 0,(n=t.CompatibleTableBorderFormat||(t.CompatibleTableBorderFormat={}))[n.DEFAULT=0]="DEFAULT",n[n.LIST_WITH_SIDE_BORDERS=1]="LIST_WITH_SIDE_BORDERS",n[n.NO_HEADER_BORDERS=2]="NO_HEADER_BORDERS",n[n.NO_SIDE_BORDERS=3]="NO_SIDE_BORDERS",n[n.FIRST_COLUMN_HEADER_EXTERNAL=4]="FIRST_COLUMN_HEADER_EXTERNAL",n[n.ESPECIAL_TYPE_1=5]="ESPECIAL_TYPE_1",n[n.ESPECIAL_TYPE_2=6]="ESPECIAL_TYPE_2",n[n.ESPECIAL_TYPE_3=7]="ESPECIAL_TYPE_3",n[n.CLEAR=8]="CLEAR"},6011:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleTableOperation=void 0,(n=t.CompatibleTableOperation||(t.CompatibleTableOperation={}))[n.InsertAbove=0]="InsertAbove",n[n.InsertBelow=1]="InsertBelow",n[n.InsertLeft=2]="InsertLeft",n[n.InsertRight=3]="InsertRight",n[n.DeleteTable=4]="DeleteTable",n[n.DeleteColumn=5]="DeleteColumn",n[n.DeleteRow=6]="DeleteRow",n[n.MergeAbove=7]="MergeAbove",n[n.MergeBelow=8]="MergeBelow",n[n.MergeLeft=9]="MergeLeft",n[n.MergeRight=10]="MergeRight",n[n.MergeCells=11]="MergeCells",n[n.SplitHorizontally=12]="SplitHorizontally",n[n.SplitVertically=13]="SplitVertically",n[n.AlignCenter=14]="AlignCenter",n[n.AlignLeft=15]="AlignLeft",n[n.AlignRight=16]="AlignRight",n[n.AlignCellLeft=17]="AlignCellLeft",n[n.AlignCellCenter=18]="AlignCellCenter",n[n.AlignCellRight=19]="AlignCellRight",n[n.AlignCellTop=20]="AlignCellTop",n[n.AlignCellMiddle=21]="AlignCellMiddle",n[n.AlignCellBottom=22]="AlignCellBottom"},5414:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompatibleTableOperation=t.CompatibleTableBorderFormat=t.CompatibleSelectionRangeTypes=t.CompatibleRegionType=t.CompatibleQueryScope=t.CompatiblePositionType=t.CompatiblePluginEventType=t.CompatiblePasteType=t.CompatibleNumberingListType=t.CompatibleNodeType=t.CompatibleListType=t.CompatibleKnownPasteSourceType=t.CompatibleKnownCreateElementDataIndex=t.CompatibleKnownAnnounceStrings=t.CompatibleKeys=t.CompatibleIndentation=t.CompatibleImageEditOperation=t.CompatibleGetContentMode=t.CompatibleFontSizeChange=t.CompatibleExperimentalFeatures=t.CompatibleEntityOperation=t.CompatibleEntityClasses=t.CompatibleDocumentPosition=t.CompatibleDocumentCommand=t.CompatibleDirection=t.CompatibleDelimiterClasses=t.CompatibleDefinitionType=t.CompatibleDarkModeDatasetNames=t.CompatibleContentType=t.CompatibleContentTypePrefix=t.CompatibleContentPosition=t.CompatibleColorTransformDirection=t.CompatibleClearFormatMode=t.CompatibleChangeSource=t.CompatibleCapitalization=t.CompatibleBulletListType=t.CompatibleAlignment=void 0;var r=n(5160);Object.defineProperty(t,"CompatibleAlignment",{enumerable:!0,get:function(){return r.CompatibleAlignment}});var o=n(8411);Object.defineProperty(t,"CompatibleBulletListType",{enumerable:!0,get:function(){return o.CompatibleBulletListType}});var i=n(5412);Object.defineProperty(t,"CompatibleCapitalization",{enumerable:!0,get:function(){return i.CompatibleCapitalization}});var a=n(5588);Object.defineProperty(t,"CompatibleChangeSource",{enumerable:!0,get:function(){return a.CompatibleChangeSource}});var l=n(6627);Object.defineProperty(t,"CompatibleClearFormatMode",{enumerable:!0,get:function(){return l.CompatibleClearFormatMode}});var s=n(2874);Object.defineProperty(t,"CompatibleColorTransformDirection",{enumerable:!0,get:function(){return s.CompatibleColorTransformDirection}});var u=n(1109);Object.defineProperty(t,"CompatibleContentPosition",{enumerable:!0,get:function(){return u.CompatibleContentPosition}});var d=n(695);Object.defineProperty(t,"CompatibleContentTypePrefix",{enumerable:!0,get:function(){return d.CompatibleContentTypePrefix}}),Object.defineProperty(t,"CompatibleContentType",{enumerable:!0,get:function(){return d.CompatibleContentType}});var c=n(7838);Object.defineProperty(t,"CompatibleDarkModeDatasetNames",{enumerable:!0,get:function(){return c.CompatibleDarkModeDatasetNames}});var f=n(35);Object.defineProperty(t,"CompatibleDefinitionType",{enumerable:!0,get:function(){return f.CompatibleDefinitionType}});var p=n(7028);Object.defineProperty(t,"CompatibleDelimiterClasses",{enumerable:!0,get:function(){return p.CompatibleDelimiterClasses}});var v=n(6234);Object.defineProperty(t,"CompatibleDirection",{enumerable:!0,get:function(){return v.CompatibleDirection}});var h=n(2805);Object.defineProperty(t,"CompatibleDocumentCommand",{enumerable:!0,get:function(){return h.CompatibleDocumentCommand}});var g=n(6550);Object.defineProperty(t,"CompatibleDocumentPosition",{enumerable:!0,get:function(){return g.CompatibleDocumentPosition}});var m=n(3779);Object.defineProperty(t,"CompatibleEntityClasses",{enumerable:!0,get:function(){return m.CompatibleEntityClasses}});var y=n(8206);Object.defineProperty(t,"CompatibleEntityOperation",{enumerable:!0,get:function(){return y.CompatibleEntityOperation}});var b=n(2322);Object.defineProperty(t,"CompatibleExperimentalFeatures",{enumerable:!0,get:function(){return b.CompatibleExperimentalFeatures}});var E=n(3271);Object.defineProperty(t,"CompatibleFontSizeChange",{enumerable:!0,get:function(){return E.CompatibleFontSizeChange}});var C=n(2776);Object.defineProperty(t,"CompatibleGetContentMode",{enumerable:!0,get:function(){return C.CompatibleGetContentMode}});var S=n(7705);Object.defineProperty(t,"CompatibleImageEditOperation",{enumerable:!0,get:function(){return S.CompatibleImageEditOperation}});var T=n(6020);Object.defineProperty(t,"CompatibleIndentation",{enumerable:!0,get:function(){return T.CompatibleIndentation}});var P=n(2693);Object.defineProperty(t,"CompatibleKeys",{enumerable:!0,get:function(){return P.CompatibleKeys}});var _=n(1911);Object.defineProperty(t,"CompatibleKnownAnnounceStrings",{enumerable:!0,get:function(){return _.CompatibleKnownAnnounceStrings}});var w=n(4845);Object.defineProperty(t,"CompatibleKnownCreateElementDataIndex",{enumerable:!0,get:function(){return w.CompatibleKnownCreateElementDataIndex}});var O=n(9603);Object.defineProperty(t,"CompatibleKnownPasteSourceType",{enumerable:!0,get:function(){return O.CompatibleKnownPasteSourceType}});var M=n(3115);Object.defineProperty(t,"CompatibleListType",{enumerable:!0,get:function(){return M.CompatibleListType}});var D=n(6993);Object.defineProperty(t,"CompatibleNodeType",{enumerable:!0,get:function(){return D.CompatibleNodeType}});var A=n(1040);Object.defineProperty(t,"CompatibleNumberingListType",{enumerable:!0,get:function(){return A.CompatibleNumberingListType}});var L=n(610);Object.defineProperty(t,"CompatiblePasteType",{enumerable:!0,get:function(){return L.CompatiblePasteType}});var R=n(5912);Object.defineProperty(t,"CompatiblePluginEventType",{enumerable:!0,get:function(){return R.CompatiblePluginEventType}});var I=n(685);Object.defineProperty(t,"CompatiblePositionType",{enumerable:!0,get:function(){return I.CompatiblePositionType}});var N=n(8465);Object.defineProperty(t,"CompatibleQueryScope",{enumerable:!0,get:function(){return N.CompatibleQueryScope}});var x=n(2906);Object.defineProperty(t,"CompatibleRegionType",{enumerable:!0,get:function(){return x.CompatibleRegionType}});var k=n(895);Object.defineProperty(t,"CompatibleSelectionRangeTypes",{enumerable:!0,get:function(){return k.CompatibleSelectionRangeTypes}});var j=n(3088);Object.defineProperty(t,"CompatibleTableBorderFormat",{enumerable:!0,get:function(){return j.CompatibleTableBorderFormat}});var B=n(6011);Object.defineProperty(t,"CompatibleTableOperation",{enumerable:!0,get:function(){return B.CompatibleTableOperation}})},7246:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7582);(0,r.__exportStar)(n(2091),t),(0,r.__exportStar)(n(3424),t),(0,r.__exportStar)(n(5414),t),(0,r.__exportStar)(n(796),t),(0,r.__exportStar)(n(7882),t),(0,r.__exportStar)(n(8568),t)},3424:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4625:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Alignment=void 0,(n=t.Alignment||(t.Alignment={}))[n.Left=0]="Left",n[n.Center=1]="Center",n[n.Right=2]="Right"},8982:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.BulletListType=void 0,(n=t.BulletListType||(t.BulletListType={}))[n.Min=1]="Min",n[n.Disc=1]="Disc",n[n.Dash=2]="Dash",n[n.Square=3]="Square",n[n.ShortArrow=4]="ShortArrow",n[n.LongArrow=5]="LongArrow",n[n.UnfilledArrow=6]="UnfilledArrow",n[n.Hyphen=7]="Hyphen",n[n.DoubleLongArrow=8]="DoubleLongArrow",n[n.Circle=9]="Circle",n[n.Max=9]="Max"},9003:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Capitalization=void 0,(n=t.Capitalization||(t.Capitalization={})).Sentence="sentence",n.Lowercase="lowercase",n.Uppercase="uppercase",n.CapitalizeEachWord="capitalize"},8591:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeSource=void 0,(n=t.ChangeSource||(t.ChangeSource={})).AutoLink="AutoLink",n.CreateLink="CreateLink",n.Format="Format",n.ImageResize="ImageResize",n.Paste="Paste",n.SetContent="SetContent",n.Cut="Cut",n.Drop="Drop",n.InsertEntity="InsertEntity",n.SwitchToDarkMode="SwitchToDarkMode",n.SwitchToLightMode="SwitchToLightMode",n.ListChain="ListChain",n.Keyboard="Keyboard"},2101:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ClearFormatMode=void 0,(n=t.ClearFormatMode||(t.ClearFormatMode={}))[n.Inline=0]="Inline",n[n.Block=1]="Block",n[n.AutoDetect=2]="AutoDetect"},4471:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ColorTransformDirection=void 0,(n=t.ColorTransformDirection||(t.ColorTransformDirection={}))[n.LightToDark=0]="LightToDark",n[n.DarkToLight=1]="DarkToLight"},8983:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ContentPosition=void 0,(n=t.ContentPosition||(t.ContentPosition={}))[n.Begin=0]="Begin",n[n.End=1]="End",n[n.DomEnd=2]="DomEnd",n[n.SelectionStart=3]="SelectionStart",n[n.Outside=4]="Outside",n[n.Range=5]="Range"},7157:(e,t)=>{"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.ContentType=t.ContentTypePrefix=void 0,(r=t.ContentTypePrefix||(t.ContentTypePrefix={})).Text="text/",r.Image="image/",(n=t.ContentType||(t.ContentType={})).PlainText="text/plain",n.HTML="text/html"},4490:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.DarkModeDatasetNames=void 0,(n=t.DarkModeDatasetNames||(t.DarkModeDatasetNames={})).OriginalStyleColor="ogsc",n.OriginalStyleBackgroundColor="ogsb",n.OriginalAttributeColor="ogac",n.OriginalAttributeBackgroundColor="ogab"},9097:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.DefinitionType=void 0,(n=t.DefinitionType||(t.DefinitionType={}))[n.Boolean=0]="Boolean",n[n.Number=1]="Number",n[n.String=2]="String",n[n.Array=3]="Array",n[n.Object=4]="Object",n[n.Customize=5]="Customize"},2910:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.DelimiterClasses=void 0,(n=t.DelimiterClasses||(t.DelimiterClasses={})).DELIMITER_BEFORE="entityDelimiterBefore",n.DELIMITER_AFTER="entityDelimiterAfter"},265:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Direction=void 0,(n=t.Direction||(t.Direction={}))[n.LeftToRight=0]="LeftToRight",n[n.RightToLeft=1]="RightToLeft"},6386:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentCommand=void 0,(n=t.DocumentCommand||(t.DocumentCommand={})).AutoUrlDetect="AutoUrlDetect",n.BackColor="backColor",n.Bold="bold",n.ClearAuthenticationCache="ClearAuthenticationCache",n.ContentReadOnly="contentReadOnly",n.Copy="copy",n.CreateLink="createLink",n.Cut="cut",n.DecreaseFontSize="decreaseFontSize",n.DefaultParagraphSeparator="defaultParagraphSeparator",n.Delete="delete",n.EnableInlineTableEditing="enableInlineTableEditing",n.EnableObjectResizing="enableObjectResizing",n.FontName="fontName",n.FontSize="fontSize",n.ForeColor="foreColor",n.FormatBlock="formatBlock",n.ForwardDelete="forwardDelete",n.Heading="heading",n.HiliteColor="hiliteColor",n.IncreaseFontSize="increaseFontSize",n.Indent="indent",n.InsertBrOnReturn="insertBrOnReturn",n.InsertHorizontalRule="insertHorizontalRule",n.InsertHTML="insertHTML",n.InsertImage="insertImage",n.InsertOrderedList="insertOrderedList",n.InsertUnorderedList="insertUnorderedList",n.InsertParagraph="insertParagraph",n.InsertText="insertText",n.Italic="italic",n.JustifyCenter="justifyCenter",n.JustifyFull="justifyFull",n.JustifyLeft="justifyLeft",n.JustifyRight="justifyRight",n.Outdent="outdent",n.Paste="paste",n.Redo="redo",n.RemoveFormat="removeFormat",n.SelectAll="selectAll",n.StrikeThrough="strikeThrough",n.Subscript="subscript",n.Superscript="superscript",n.Underline="underline",n.Undo="undo",n.Unlink="unlink",n.StyleWithCSS="styleWithCSS"},565:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentPosition=void 0,(n=t.DocumentPosition||(t.DocumentPosition={}))[n.Same=0]="Same",n[n.Disconnected=1]="Disconnected",n[n.Preceding=2]="Preceding",n[n.Following=4]="Following",n[n.Contains=8]="Contains",n[n.ContainedBy=16]="ContainedBy"},2372:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.EntityClasses=void 0,(n=t.EntityClasses||(t.EntityClasses={})).ENTITY_INFO_NAME="_Entity",n.ENTITY_TYPE_PREFIX="_EType_",n.ENTITY_ID_PREFIX="_EId_",n.ENTITY_READONLY_PREFIX="_EReadonly_"},9468:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.EntityOperation=void 0,(n=t.EntityOperation||(t.EntityOperation={}))[n.NewEntity=0]="NewEntity",n[n.Click=1]="Click",n[n.ContextMenu=2]="ContextMenu",n[n.Escape=3]="Escape",n[n.RemoveFromStart=4]="RemoveFromStart",n[n.RemoveFromEnd=5]="RemoveFromEnd",n[n.Overwrite=6]="Overwrite",n[n.PartialOverwrite=7]="PartialOverwrite",n[n.ReplaceTemporaryContent=8]="ReplaceTemporaryContent",n[n.AddShadowRoot=9]="AddShadowRoot",n[n.RemoveShadowRoot=10]="RemoveShadowRoot",n[n.UpdateEntityState=11]="UpdateEntityState"},9084:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ExperimentalFeatures=void 0,(n=t.ExperimentalFeatures||(t.ExperimentalFeatures={})).NewIndentation="NewIndentation",n.NewBullet="NewBullet",n.NewNumbering="NewNumbering",n.ListChain="ListChain",n.MergePastedLine="MergePastedLine",n.SingleDirectionResize="SingleDirectionResize",n.PasteWithLinkPreview="PasteWithLinkPreview",n.ImageRotate="ImageRotate",n.ImageCrop="ImageCrop",n.AlwaysApplyDefaultFormat="AlwaysApplyDefaultFormat",n.ConvertSingleImageBody="ConvertSingleImageBody",n.TableAlignment="TableAlignment",n.AdaptiveHandlesResizer="AdaptiveHandlesResizer",n.AutoHyphen="AutoHyphen",n.PendingStyleBasedFormat="PendingStyleBasedFormat",n.NormalizeList="NormalizeList",n.ImageSelection="ImageSelection",n.VariableBasedDarkColor="VariableBasedDarkColor",n.ListItemAlignment="ListItemAlignment",n.DefaultFormatInSpan="DefaultFormatInSpan",n.DefaultFormatOnContainer="DefaultFormatOnContainer",n.ReusableContentModel="ReusableContentModel",n.EditWithContentModel="EditWithContentModel",n.AutoFormatList="AutoFormatList",n.InlineEntityReadOnlyDelimiters="InlineEntityReadOnlyDelimiters",n.ContentModelPaste="ContentModelPaste",n.TabKeyTextFeatures="TabKeyTextFeatures",n.ReuseAllAncestorListElements="ReuseAllAncestorListElements",n.DeleteTableWithBackspace="DeleteTableWithBackspace",n.DisableListChain="DisableListChain"},5397:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.FontSizeChange=void 0,(n=t.FontSizeChange||(t.FontSizeChange={}))[n.Increase=0]="Increase",n[n.Decrease=1]="Decrease"},4051:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.GetContentMode=void 0,(n=t.GetContentMode||(t.GetContentMode={}))[n.CleanHTML=0]="CleanHTML",n[n.RawHTMLOnly=1]="RawHTMLOnly",n[n.RawHTMLWithSelection=2]="RawHTMLWithSelection",n[n.PlainText=3]="PlainText",n[n.PlainTextFast=4]="PlainTextFast"},2681:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ImageEditOperation=void 0,(n=t.ImageEditOperation||(t.ImageEditOperation={}))[n.None=0]="None",n[n.CornerResize=1]="CornerResize",n[n.SideResize=2]="SideResize",n[n.Resize=3]="Resize",n[n.Rotate=4]="Rotate",n[n.ResizeAndRotate=7]="ResizeAndRotate",n[n.Crop=8]="Crop",n[n.All=15]="All"},6039:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Indentation=void 0,(n=t.Indentation||(t.Indentation={}))[n.Increase=0]="Increase",n[n.Decrease=1]="Decrease"},3692:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Keys=void 0,(n=t.Keys||(t.Keys={}))[n.NULL=0]="NULL",n[n.BACKSPACE=8]="BACKSPACE",n[n.TAB=9]="TAB",n[n.ENTER=13]="ENTER",n[n.SHIFT=16]="SHIFT",n[n.CTRL_LEFT=17]="CTRL_LEFT",n[n.ALT=18]="ALT",n[n.ESCAPE=27]="ESCAPE",n[n.SPACE=32]="SPACE",n[n.PAGEUP=33]="PAGEUP",n[n.END=35]="END",n[n.HOME=36]="HOME",n[n.LEFT=37]="LEFT",n[n.UP=38]="UP",n[n.RIGHT=39]="RIGHT",n[n.DOWN=40]="DOWN",n[n.PRINT_SCREEN=44]="PRINT_SCREEN",n[n.DELETE=46]="DELETE",n[n.EIGHT_ASTIRISK=56]="EIGHT_ASTIRISK",n[n.EIGHT_ASTERISK=56]="EIGHT_ASTERISK",n[n.B=66]="B",n[n.I=73]="I",n[n.U=85]="U",n[n.Y=89]="Y",n[n.Z=90]="Z",n[n.META_LEFT=91]="META_LEFT",n[n.COMMA=188]="COMMA",n[n.DASH_UNDERSCORE=189]="DASH_UNDERSCORE",n[n.PERIOD=190]="PERIOD",n[n.FORWARDSLASH=191]="FORWARDSLASH",n[n.FORWARD_SLASH=191]="FORWARD_SLASH",n[n.GRAVE_TILDE=192]="GRAVE_TILDE",n[n.CONTENTCHANGED=257]="CONTENTCHANGED",n[n.RANGE=258]="RANGE",n[n.Ctrl=4096]="Ctrl",n[n.Meta=8192]="Meta",n[n.Shift=16384]="Shift"},3119:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.KnownAnnounceStrings=void 0,(n=t.KnownAnnounceStrings||(t.KnownAnnounceStrings={}))[n.AnnounceListItemNumbering=1]="AnnounceListItemNumbering",n[n.AnnounceListItemBullet=2]="AnnounceListItemBullet",n[n.AnnounceOnFocusLastCell=3]="AnnounceOnFocusLastCell"},9278:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.KnownCreateElementDataIndex=void 0,(n=t.KnownCreateElementDataIndex||(t.KnownCreateElementDataIndex={}))[n.None=0]="None",n[n.EmptyLine=1]="EmptyLine",n[n.BlockquoteWrapper=2]="BlockquoteWrapper",n[n.CopyPasteTempDiv=3]="CopyPasteTempDiv",n[n.BlockListItem=4]="BlockListItem",n[n.ContextMenuWrapper=5]="ContextMenuWrapper",n[n.ImageEditWrapper=6]="ImageEditWrapper",n[n.TableHorizontalResizer=7]="TableHorizontalResizer",n[n.TableVerticalResizer=8]="TableVerticalResizer",n[n.TableResizerLTR=9]="TableResizerLTR",n[n.TableResizerRTL=10]="TableResizerRTL",n[n.TableSelector=11]="TableSelector",n[n.EmptyLineFormatInSpan=12]="EmptyLineFormatInSpan"},2342:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.KnownPasteSourceType=void 0,(n=t.KnownPasteSourceType||(t.KnownPasteSourceType={}))[n.WordDesktop=0]="WordDesktop",n[n.ExcelDesktop=1]="ExcelDesktop",n[n.ExcelOnline=2]="ExcelOnline",n[n.PowerPointDesktop=3]="PowerPointDesktop",n[n.GoogleSheets=4]="GoogleSheets",n[n.WacComponents=5]="WacComponents",n[n.Default=6]="Default",n[n.SingleImage=7]="SingleImage"},8185:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ListType=void 0,(n=t.ListType||(t.ListType={}))[n.None=0]="None",n[n.Ordered=1]="Ordered",n[n.Unordered=2]="Unordered"},9883:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.NodeType=void 0,(n=t.NodeType||(t.NodeType={}))[n.Element=1]="Element",n[n.Attribute=2]="Attribute",n[n.Text=3]="Text",n[n.ProcessingInstruction=7]="ProcessingInstruction",n[n.Comment=8]="Comment",n[n.Document=9]="Document",n[n.DocumentType=10]="DocumentType",n[n.DocumentFragment=11]="DocumentFragment"},7821:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.NumberingListType=void 0,(n=t.NumberingListType||(t.NumberingListType={}))[n.Min=1]="Min",n[n.Decimal=1]="Decimal",n[n.DecimalDash=2]="DecimalDash",n[n.DecimalParenthesis=3]="DecimalParenthesis",n[n.DecimalDoubleParenthesis=4]="DecimalDoubleParenthesis",n[n.LowerAlpha=5]="LowerAlpha",n[n.LowerAlphaParenthesis=6]="LowerAlphaParenthesis",n[n.LowerAlphaDoubleParenthesis=7]="LowerAlphaDoubleParenthesis",n[n.LowerAlphaDash=8]="LowerAlphaDash",n[n.UpperAlpha=9]="UpperAlpha",n[n.UpperAlphaParenthesis=10]="UpperAlphaParenthesis",n[n.UpperAlphaDoubleParenthesis=11]="UpperAlphaDoubleParenthesis",n[n.UpperAlphaDash=12]="UpperAlphaDash",n[n.LowerRoman=13]="LowerRoman",n[n.LowerRomanParenthesis=14]="LowerRomanParenthesis",n[n.LowerRomanDoubleParenthesis=15]="LowerRomanDoubleParenthesis",n[n.LowerRomanDash=16]="LowerRomanDash",n[n.UpperRoman=17]="UpperRoman",n[n.UpperRomanParenthesis=18]="UpperRomanParenthesis",n[n.UpperRomanDoubleParenthesis=19]="UpperRomanDoubleParenthesis",n[n.UpperRomanDash=20]="UpperRomanDash",n[n.Max=20]="Max"},2368:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.PasteType=void 0,(n=t.PasteType||(t.PasteType={}))[n.Normal=0]="Normal",n[n.AsPlainText=1]="AsPlainText",n[n.MergeFormat=2]="MergeFormat",n[n.AsImage=3]="AsImage"},2688:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.PluginEventType=void 0,(n=t.PluginEventType||(t.PluginEventType={}))[n.KeyDown=0]="KeyDown",n[n.KeyPress=1]="KeyPress",n[n.KeyUp=2]="KeyUp",n[n.Input=3]="Input",n[n.CompositionEnd=4]="CompositionEnd",n[n.MouseDown=5]="MouseDown",n[n.MouseUp=6]="MouseUp",n[n.ContentChanged=7]="ContentChanged",n[n.ExtractContentWithDom=8]="ExtractContentWithDom",n[n.BeforeCutCopy=9]="BeforeCutCopy",n[n.BeforePaste=10]="BeforePaste",n[n.EditorReady=11]="EditorReady",n[n.BeforeDispose=12]="BeforeDispose",n[n.PendingFormatStateChanged=13]="PendingFormatStateChanged",n[n.Scroll=14]="Scroll",n[n.EntityOperation=15]="EntityOperation",n[n.ContextMenu=16]="ContextMenu",n[n.EnteredShadowEdit=17]="EnteredShadowEdit",n[n.LeavingShadowEdit=18]="LeavingShadowEdit",n[n.EditImage=19]="EditImage",n[n.BeforeSetContent=20]="BeforeSetContent",n[n.ZoomChanged=21]="ZoomChanged",n[n.SelectionChanged=22]="SelectionChanged",n[n.BeforeKeyboardEditing=23]="BeforeKeyboardEditing"},758:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.PositionType=void 0,(n=t.PositionType||(t.PositionType={}))[n.Begin=0]="Begin",n[n.End=-1]="End",n[n.Before=-2]="Before",n[n.After=-3]="After"},8827:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.QueryScope=void 0,(n=t.QueryScope||(t.QueryScope={}))[n.Body=0]="Body",n[n.OnSelection=1]="OnSelection",n[n.InSelection=2]="InSelection"},2025:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.RegionType=void 0,(n=t.RegionType||(t.RegionType={}))[n.Table=0]="Table"},3852:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionRangeTypes=void 0,(n=t.SelectionRangeTypes||(t.SelectionRangeTypes={}))[n.Normal=0]="Normal",n[n.TableSelection=1]="TableSelection",n[n.ImageSelection=2]="ImageSelection"},372:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.TableBorderFormat=void 0,(n=t.TableBorderFormat||(t.TableBorderFormat={}))[n.DEFAULT=0]="DEFAULT",n[n.LIST_WITH_SIDE_BORDERS=1]="LIST_WITH_SIDE_BORDERS",n[n.NO_HEADER_BORDERS=2]="NO_HEADER_BORDERS",n[n.NO_SIDE_BORDERS=3]="NO_SIDE_BORDERS",n[n.FIRST_COLUMN_HEADER_EXTERNAL=4]="FIRST_COLUMN_HEADER_EXTERNAL",n[n.ESPECIAL_TYPE_1=5]="ESPECIAL_TYPE_1",n[n.ESPECIAL_TYPE_2=6]="ESPECIAL_TYPE_2",n[n.ESPECIAL_TYPE_3=7]="ESPECIAL_TYPE_3",n[n.CLEAR=8]="CLEAR"},6841:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.TableOperation=void 0,(n=t.TableOperation||(t.TableOperation={}))[n.InsertAbove=0]="InsertAbove",n[n.InsertBelow=1]="InsertBelow",n[n.InsertLeft=2]="InsertLeft",n[n.InsertRight=3]="InsertRight",n[n.DeleteTable=4]="DeleteTable",n[n.DeleteColumn=5]="DeleteColumn",n[n.DeleteRow=6]="DeleteRow",n[n.MergeAbove=7]="MergeAbove",n[n.MergeBelow=8]="MergeBelow",n[n.MergeLeft=9]="MergeLeft",n[n.MergeRight=10]="MergeRight",n[n.MergeCells=11]="MergeCells",n[n.SplitHorizontally=12]="SplitHorizontally",n[n.SplitVertically=13]="SplitVertically",n[n.AlignCenter=14]="AlignCenter",n[n.AlignLeft=15]="AlignLeft",n[n.AlignRight=16]="AlignRight",n[n.AlignCellLeft=17]="AlignCellLeft",n[n.AlignCellCenter=18]="AlignCellCenter",n[n.AlignCellRight=19]="AlignCellRight",n[n.AlignCellTop=20]="AlignCellTop",n[n.AlignCellMiddle=21]="AlignCellMiddle",n[n.AlignCellBottom=22]="AlignCellBottom"},6395:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PasteType=t.DefinitionType=t.BulletListType=t.NumberingListType=t.SelectionRangeTypes=t.PluginEventType=t.TableBorderFormat=t.KnownPasteSourceType=t.KnownCreateElementDataIndex=t.ClearFormatMode=t.ImageEditOperation=t.TableOperation=t.RegionType=t.QueryScope=t.PositionType=t.ListType=t.Capitalization=t.Indentation=t.GetContentMode=t.FontSizeChange=t.ExperimentalFeatures=t.EntityOperation=t.EntityClasses=t.Direction=t.DelimiterClasses=t.DarkModeDatasetNames=t.ContentPosition=t.ColorTransformDirection=t.ChangeSource=t.Alignment=t.ContentType=t.ContentTypePrefix=t.NodeType=t.Keys=t.DocumentPosition=t.DocumentCommand=t.KnownAnnounceStrings=void 0;var r=n(3119);Object.defineProperty(t,"KnownAnnounceStrings",{enumerable:!0,get:function(){return r.KnownAnnounceStrings}});var o=n(6386);Object.defineProperty(t,"DocumentCommand",{enumerable:!0,get:function(){return o.DocumentCommand}});var i=n(565);Object.defineProperty(t,"DocumentPosition",{enumerable:!0,get:function(){return i.DocumentPosition}});var a=n(3692);Object.defineProperty(t,"Keys",{enumerable:!0,get:function(){return a.Keys}});var l=n(9883);Object.defineProperty(t,"NodeType",{enumerable:!0,get:function(){return l.NodeType}});var s=n(7157);Object.defineProperty(t,"ContentTypePrefix",{enumerable:!0,get:function(){return s.ContentTypePrefix}}),Object.defineProperty(t,"ContentType",{enumerable:!0,get:function(){return s.ContentType}});var u=n(4625);Object.defineProperty(t,"Alignment",{enumerable:!0,get:function(){return u.Alignment}});var d=n(8591);Object.defineProperty(t,"ChangeSource",{enumerable:!0,get:function(){return d.ChangeSource}});var c=n(4471);Object.defineProperty(t,"ColorTransformDirection",{enumerable:!0,get:function(){return c.ColorTransformDirection}});var f=n(8983);Object.defineProperty(t,"ContentPosition",{enumerable:!0,get:function(){return f.ContentPosition}});var p=n(4490);Object.defineProperty(t,"DarkModeDatasetNames",{enumerable:!0,get:function(){return p.DarkModeDatasetNames}});var v=n(2910);Object.defineProperty(t,"DelimiterClasses",{enumerable:!0,get:function(){return v.DelimiterClasses}});var h=n(265);Object.defineProperty(t,"Direction",{enumerable:!0,get:function(){return h.Direction}});var g=n(2372);Object.defineProperty(t,"EntityClasses",{enumerable:!0,get:function(){return g.EntityClasses}});var m=n(9468);Object.defineProperty(t,"EntityOperation",{enumerable:!0,get:function(){return m.EntityOperation}});var y=n(9084);Object.defineProperty(t,"ExperimentalFeatures",{enumerable:!0,get:function(){return y.ExperimentalFeatures}});var b=n(5397);Object.defineProperty(t,"FontSizeChange",{enumerable:!0,get:function(){return b.FontSizeChange}});var E=n(4051);Object.defineProperty(t,"GetContentMode",{enumerable:!0,get:function(){return E.GetContentMode}});var C=n(6039);Object.defineProperty(t,"Indentation",{enumerable:!0,get:function(){return C.Indentation}});var S=n(9003);Object.defineProperty(t,"Capitalization",{enumerable:!0,get:function(){return S.Capitalization}});var T=n(8185);Object.defineProperty(t,"ListType",{enumerable:!0,get:function(){return T.ListType}});var P=n(758);Object.defineProperty(t,"PositionType",{enumerable:!0,get:function(){return P.PositionType}});var _=n(8827);Object.defineProperty(t,"QueryScope",{enumerable:!0,get:function(){return _.QueryScope}});var w=n(2025);Object.defineProperty(t,"RegionType",{enumerable:!0,get:function(){return w.RegionType}});var O=n(6841);Object.defineProperty(t,"TableOperation",{enumerable:!0,get:function(){return O.TableOperation}});var M=n(2681);Object.defineProperty(t,"ImageEditOperation",{enumerable:!0,get:function(){return M.ImageEditOperation}});var D=n(2101);Object.defineProperty(t,"ClearFormatMode",{enumerable:!0,get:function(){return D.ClearFormatMode}});var A=n(9278);Object.defineProperty(t,"KnownCreateElementDataIndex",{enumerable:!0,get:function(){return A.KnownCreateElementDataIndex}});var L=n(2342);Object.defineProperty(t,"KnownPasteSourceType",{enumerable:!0,get:function(){return L.KnownPasteSourceType}});var R=n(372);Object.defineProperty(t,"TableBorderFormat",{enumerable:!0,get:function(){return R.TableBorderFormat}});var I=n(2688);Object.defineProperty(t,"PluginEventType",{enumerable:!0,get:function(){return I.PluginEventType}});var N=n(3852);Object.defineProperty(t,"SelectionRangeTypes",{enumerable:!0,get:function(){return N.SelectionRangeTypes}});var x=n(7821);Object.defineProperty(t,"NumberingListType",{enumerable:!0,get:function(){return x.NumberingListType}});var k=n(8982);Object.defineProperty(t,"BulletListType",{enumerable:!0,get:function(){return k.BulletListType}});var j=n(9097);Object.defineProperty(t,"DefinitionType",{enumerable:!0,get:function(){return j.DefinitionType}});var B=n(2368);Object.defineProperty(t,"PasteType",{enumerable:!0,get:function(){return B.PasteType}})},796:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8075:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7582);(0,r.__exportStar)(n(2091),t),(0,r.__exportStar)(n(3424),t),(0,r.__exportStar)(n(6395),t),(0,r.__exportStar)(n(796),t),(0,r.__exportStar)(n(7882),t),(0,r.__exportStar)(n(8568),t)},7882:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8568:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5115:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4739),o=n(6630),i=n(1660);t.default=function(e,t,n){var a=[new r.HyperLink,new r.Paste,new r.ContentEdit];t&&(a=a.concat(t));var l={plugins:a,initialContent:n,getDarkColor:i.getDarkColor,defaultFormat:{fontFamily:"Calibri,Arial,Helvetica,sans-serif",fontSize:"11pt",textColor:"#000000"}};return new o.Editor(e,l)}},8608:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEditor=void 0;var r=n(7582),o=n(5115);Object.defineProperty(t,"createEditor",{enumerable:!0,get:function(){return o.default}}),(0,r.__exportStar)(n(8075),t),(0,r.__exportStar)(n(1286),t),(0,r.__exportStar)(n(6344),t),(0,r.__exportStar)(n(6630),t),(0,r.__exportStar)(n(4548),t),(0,r.__exportStar)(n(4739),t),(0,r.__exportStar)(n(1660),t)},7582:(e,t,n)=>{"use strict";n.r(t),n.d(t,{__assign:()=>i,__asyncDelegator:()=>_,__asyncGenerator:()=>P,__asyncValues:()=>w,__await:()=>T,__awaiter:()=>v,__classPrivateFieldGet:()=>L,__classPrivateFieldIn:()=>I,__classPrivateFieldSet:()=>R,__createBinding:()=>g,__decorate:()=>l,__esDecorate:()=>u,__exportStar:()=>m,__extends:()=>o,__generator:()=>h,__importDefault:()=>A,__importStar:()=>D,__makeTemplateObject:()=>O,__metadata:()=>p,__param:()=>s,__propKey:()=>c,__read:()=>b,__rest:()=>a,__runInitializers:()=>d,__setFunctionName:()=>f,__spread:()=>E,__spreadArray:()=>S,__spreadArrays:()=>C,__values:()=>y,default:()=>N});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function l(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}function s(e,t){return function(n,r){t(n,r,e)}}function u(e,t,n,r,o,i){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var l,s=r.kind,u="getter"===s?"get":"setter"===s?"set":"value",d=!t&&e?r.static?e:e.prototype:null,c=t||(d?Object.getOwnPropertyDescriptor(d,r.name):{}),f=!1,p=n.length-1;p>=0;p--){var v={};for(var h in r)v[h]="access"===h?{}:r[h];for(var h in r.access)v.access[h]=r.access[h];v.addInitializer=function(e){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(e||null))};var g=(0,n[p])("accessor"===s?{get:c.get,set:c.set}:c[u],v);if("accessor"===s){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(l=a(g.get))&&(c.get=l),(l=a(g.set))&&(c.set=l),(l=a(g.init))&&o.unshift(l)}else(l=a(g))&&("field"===s?o.unshift(l):c[u]=l)}d&&Object.defineProperty(d,r.name,c),f=!0}function d(e,t,n){for(var r=arguments.length>2,o=0;o<t.length;o++)n=r?t[o].call(e,n):t[o].call(e);return r?n:void 0}function c(e){return"symbol"==typeof e?e:"".concat(e)}function f(e,t,n){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function v(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))}function h(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&l[0]?r.return:l[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,l[1])).done)return o;switch(r=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,r=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){a=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){a.label=l[1];break}if(6===l[0]&&a.label<o[1]){a.label=o[1],o=l;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(l);break}o[2]&&a.ops.pop(),a.trys.pop();continue}l=t.call(e,a)}catch(e){l=[6,e],r=0}finally{n=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}}var g=Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]};function m(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||g(t,e,n)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function E(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(b(arguments[t]));return e}function C(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,l=i.length;a<l;a++,o++)r[o]=i[a];return r}function S(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}function T(e){return this instanceof T?(this.v=e,this):new T(e)}function P(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),i=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){o[e]&&(r[e]=function(t){return new Promise((function(n,r){i.push([e,t,n,r])>1||l(e,t)}))})}function l(e,t){try{(n=o[e](t)).value instanceof T?Promise.resolve(n.value.v).then(s,u):d(i[0][2],n)}catch(e){d(i[0][3],e)}var n}function s(e){l("next",e)}function u(e){l("throw",e)}function d(e,t){e(t),i.shift(),i.length&&l(i[0][0],i[0][1])}}function _(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,o){t[r]=e[r]?function(t){return(n=!n)?{value:T(e[r](t)),done:!1}:o?o(t):t}:o}}function w(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=y(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,o){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,o,(t=e[n](t)).done,t.value)}))}}}function O(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var M=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function D(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&g(t,e,n);return M(t,e),t}function A(e){return e&&e.__esModule?e:{default:e}}function L(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function R(e,t,n,r,o){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?o.call(e,n):o?o.value=n:t.set(e,n),n}function I(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}const N={__extends:o,__assign:i,__rest:a,__decorate:l,__param:s,__metadata:p,__awaiter:v,__generator:h,__createBinding:g,__exportStar:m,__values:y,__read:b,__spread:E,__spreadArrays:C,__spreadArray:S,__await:T,__asyncGenerator:P,__asyncDelegator:_,__asyncValues:w,__makeTemplateObject:O,__importStar:D,__importDefault:A,__classPrivateFieldGet:L,__classPrivateFieldSet:R,__classPrivateFieldIn:I}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r=n(8608);roosterjs=r})();
//# sourceMappingURL=rooster-min.js.map